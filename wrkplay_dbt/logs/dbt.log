

============================== 2022-07-08 09:53:26.835672 | 1ad2e30b-6041-41e5-808b-fb1e7e48e072 ==============================
09:53:26.835721 [info ] [MainThread]: Running with dbt=1.1.1
09:53:26.836167 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:53:26.836269 [debug] [MainThread]: Tracking: tracking
09:53:26.854662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100aea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100aeb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100aebb0>]}
09:53:26.861342 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
09:53:26.861502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ad2e30b-6041-41e5-808b-fb1e7e48e072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100b0400>]}
09:53:26.869312 [debug] [MainThread]: Parsing macros/catalog.sql
09:53:26.871706 [debug] [MainThread]: Parsing macros/relations.sql
09:53:26.872420 [debug] [MainThread]: Parsing macros/adapters.sql
09:53:26.883484 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
09:53:26.884360 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
09:53:26.886238 [debug] [MainThread]: Parsing macros/materializations/configs.sql
09:53:26.887379 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
09:53:26.888153 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
09:53:26.896442 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
09:53:26.902999 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
09:53:26.908480 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
09:53:26.910557 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
09:53:26.911366 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
09:53:26.912167 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
09:53:26.914175 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
09:53:26.922512 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
09:53:26.923197 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
09:53:26.928001 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
09:53:26.935611 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
09:53:26.939333 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
09:53:26.940617 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
09:53:26.944421 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
09:53:26.945011 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
09:53:26.946245 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
09:53:26.947255 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
09:53:26.950097 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
09:53:26.958225 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
09:53:26.958901 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
09:53:26.960011 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
09:53:26.960705 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
09:53:26.961115 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
09:53:26.961464 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
09:53:26.961761 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
09:53:26.962367 [debug] [MainThread]: Parsing macros/etc/statement.sql
09:53:26.964387 [debug] [MainThread]: Parsing macros/etc/datetime.sql
09:53:26.968364 [debug] [MainThread]: Parsing macros/adapters/schema.sql
09:53:26.969315 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
09:53:26.970511 [debug] [MainThread]: Parsing macros/adapters/relation.sql
09:53:26.974940 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
09:53:26.976237 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
09:53:26.978222 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
09:53:26.981586 [debug] [MainThread]: Parsing macros/adapters/columns.sql
09:53:26.986111 [debug] [MainThread]: Parsing tests/generic/builtin.sql
09:53:27.067708 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
09:53:27.073203 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
09:53:27.115113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ad2e30b-6041-41e5-808b-fb1e7e48e072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110244520>]}
09:53:27.117311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ad2e30b-6041-41e5-808b-fb1e7e48e072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101a1820>]}
09:53:27.117450 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:53:27.117567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ad2e30b-6041-41e5-808b-fb1e7e48e072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102609d0>]}
09:53:27.118079 [info ] [MainThread]: 
09:53:27.118275 [debug] [MainThread]: Acquiring new postgres connection "master"
09:53:27.118622 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
09:53:27.123078 [debug] [ThreadPool]: Using postgres connection "list_postgres"
09:53:27.123155 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
09:53:27.123211 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:53:27.809316 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "db.worshmnogctpuqtpvnss.supabase.co" (13.40.162.131), port 5432 failed: FATAL:  password authentication failed for user "postgres"
connection to server at "db.worshmnogctpuqtpvnss.supabase.co" (13.40.162.131), port 5432 failed: FATAL:  password authentication failed for user "postgres"
'
09:53:27.810386 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
09:53:27.810723 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
09:53:27.811205 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
09:53:27.811523 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
09:53:27.811905 [debug] [ThreadPool]: On list_postgres: No close available on handle
09:53:27.813826 [debug] [MainThread]: Connection 'master' was properly closed.
09:53:27.814274 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
09:53:27.814922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102440d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eed2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055399d0>]}


============================== 2022-07-08 09:55:52.615289 | 05c6a72c-0a96-403b-a282-f2f5b0f18e0a ==============================
09:55:52.615304 [info ] [MainThread]: Running with dbt=1.1.1
09:55:52.615996 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:55:52.616086 [debug] [MainThread]: Tracking: tracking
09:55:52.632234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ddac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ddbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ddc10>]}
09:55:52.642102 [info ] [MainThread]: Unable to do partial parsing because profile has changed
09:55:52.642275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05c6a72c-0a96-403b-a282-f2f5b0f18e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f8490>]}
09:55:52.650864 [debug] [MainThread]: Parsing macros/catalog.sql
09:55:52.652584 [debug] [MainThread]: Parsing macros/relations.sql
09:55:52.653271 [debug] [MainThread]: Parsing macros/adapters.sql
09:55:52.664540 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
09:55:52.665480 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
09:55:52.667345 [debug] [MainThread]: Parsing macros/materializations/configs.sql
09:55:52.668507 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
09:55:52.669343 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
09:55:52.677529 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
09:55:52.684087 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
09:55:52.689549 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
09:55:52.691622 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
09:55:52.692433 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
09:55:52.693244 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
09:55:52.695251 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
09:55:52.703458 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
09:55:52.704131 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
09:55:52.708981 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
09:55:52.716564 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
09:55:52.720276 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
09:55:52.721570 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
09:55:52.725133 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
09:55:52.725701 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
09:55:52.726936 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
09:55:52.727946 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
09:55:52.730768 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
09:55:52.738819 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
09:55:52.739478 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
09:55:52.740595 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
09:55:52.741302 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
09:55:52.741707 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
09:55:52.742084 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
09:55:52.742383 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
09:55:52.742999 [debug] [MainThread]: Parsing macros/etc/statement.sql
09:55:52.745006 [debug] [MainThread]: Parsing macros/etc/datetime.sql
09:55:52.749006 [debug] [MainThread]: Parsing macros/adapters/schema.sql
09:55:52.749955 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
09:55:52.751155 [debug] [MainThread]: Parsing macros/adapters/relation.sql
09:55:52.755578 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
09:55:52.756871 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
09:55:52.758872 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
09:55:52.762232 [debug] [MainThread]: Parsing macros/adapters/columns.sql
09:55:52.766754 [debug] [MainThread]: Parsing tests/generic/builtin.sql
09:55:52.850703 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
09:55:52.856358 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
09:55:52.903108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05c6a72c-0a96-403b-a282-f2f5b0f18e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dc2e0>]}
09:55:52.905606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05c6a72c-0a96-403b-a282-f2f5b0f18e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a4430>]}
09:55:52.905731 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
09:55:52.905849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05c6a72c-0a96-403b-a282-f2f5b0f18e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106002190>]}
09:55:52.906373 [info ] [MainThread]: 
09:55:52.906563 [debug] [MainThread]: Acquiring new postgres connection "master"
09:55:52.906890 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
09:55:52.911176 [debug] [ThreadPool]: Using postgres connection "list_postgres"
09:55:52.911255 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
09:55:52.911310 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:55:53.410837 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.5 seconds
09:55:53.414400 [debug] [ThreadPool]: On list_postgres: Close
09:55:53.415588 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
09:55:53.418745 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
09:55:53.418850 [debug] [ThreadPool]: On list_postgres_public: BEGIN
09:55:53.418910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:55:53.758647 [debug] [ThreadPool]: SQL status: BEGIN in 0.34 seconds
09:55:53.759552 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
09:55:53.759761 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
09:55:53.785826 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.03 seconds
09:55:53.789915 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
09:55:53.833972 [debug] [ThreadPool]: On list_postgres_public: Close
09:55:53.837874 [debug] [MainThread]: Using postgres connection "master"
09:55:53.838027 [debug] [MainThread]: On master: BEGIN
09:55:53.838091 [debug] [MainThread]: Opening a new connection, currently in state init
09:55:54.191274 [debug] [MainThread]: SQL status: BEGIN in 0.35 seconds
09:55:54.194462 [debug] [MainThread]: Using postgres connection "master"
09:55:54.194881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
09:55:54.353893 [debug] [MainThread]: SQL status: SELECT 0 in 0.16 seconds
09:55:54.358157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05c6a72c-0a96-403b-a282-f2f5b0f18e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b73df0>]}
09:55:54.358536 [debug] [MainThread]: On master: ROLLBACK
09:55:54.403621 [debug] [MainThread]: Using postgres connection "master"
09:55:54.404069 [debug] [MainThread]: On master: BEGIN
09:55:54.438375 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
09:55:54.438992 [debug] [MainThread]: On master: COMMIT
09:55:54.439336 [debug] [MainThread]: Using postgres connection "master"
09:55:54.439662 [debug] [MainThread]: On master: COMMIT
09:55:54.458755 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
09:55:54.459283 [debug] [MainThread]: On master: Close
09:55:54.460407 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
09:55:54.461078 [info ] [MainThread]: 
09:55:54.465649 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.my_first_dbt_model
09:55:54.465855 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model ............................. [RUN]
09:55:54.466091 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_first_dbt_model"
09:55:54.466162 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.my_first_dbt_model
09:55:54.466227 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.my_first_dbt_model
09:55:54.467418 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.my_first_dbt_model"
09:55:54.467809 [debug] [Thread-1  ]: finished collecting timing info
09:55:54.467881 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.my_first_dbt_model
09:55:54.480680 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_first_dbt_model"
09:55:54.481070 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
09:55:54.481134 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: BEGIN
09:55:54.481188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:55:54.791988 [debug] [Thread-1  ]: SQL status: BEGIN in 0.31 seconds
09:55:54.793354 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
09:55:54.793782 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
09:55:54.840742 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.05 seconds
09:55:54.851114 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
09:55:54.851299 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
09:55:54.872673 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
09:55:54.885111 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
09:55:54.885237 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
09:55:54.885297 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
09:55:54.903946 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
09:55:54.909745 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
09:55:54.909853 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
09:55:54.947749 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
09:55:54.951502 [debug] [Thread-1  ]: finished collecting timing info
09:55:54.951814 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: Close
09:55:54.952309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05c6a72c-0a96-403b-a282-f2f5b0f18e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3bf10>]}
09:55:54.952564 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.49s]
09:55:54.952833 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.my_first_dbt_model
09:55:54.953222 [debug] [Thread-3  ]: Began running node model.wrkplay_dbt.my_second_dbt_model
09:55:54.953507 [info ] [Thread-3  ]: 2 of 2 START view model public.my_second_dbt_model ............................. [RUN]
09:55:54.953761 [debug] [Thread-3  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_second_dbt_model"
09:55:54.953833 [debug] [Thread-3  ]: Began compiling node model.wrkplay_dbt.my_second_dbt_model
09:55:54.953909 [debug] [Thread-3  ]: Compiling model.wrkplay_dbt.my_second_dbt_model
09:55:54.955280 [debug] [Thread-3  ]: Writing injected SQL for node "model.wrkplay_dbt.my_second_dbt_model"
09:55:54.955881 [debug] [Thread-3  ]: finished collecting timing info
09:55:54.955955 [debug] [Thread-3  ]: Began executing node model.wrkplay_dbt.my_second_dbt_model
09:55:54.963762 [debug] [Thread-3  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_second_dbt_model"
09:55:54.963986 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
09:55:54.964050 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: BEGIN
09:55:54.964103 [debug] [Thread-3  ]: Opening a new connection, currently in state init
09:55:55.398484 [debug] [Thread-3  ]: SQL status: BEGIN in 0.43 seconds
09:55:55.399826 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
09:55:55.400206 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
09:55:55.424095 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.02 seconds
09:55:55.431421 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
09:55:55.431614 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
09:55:55.451779 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.02 seconds
09:55:55.457053 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
09:55:55.457497 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
09:55:55.457684 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
09:55:55.478324 [debug] [Thread-3  ]: SQL status: COMMIT in 0.02 seconds
09:55:55.483012 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
09:55:55.483115 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
09:55:55.511355 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.03 seconds
09:55:55.514301 [debug] [Thread-3  ]: finished collecting timing info
09:55:55.514711 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: Close
09:55:55.515528 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05c6a72c-0a96-403b-a282-f2f5b0f18e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb4f40>]}
09:55:55.515780 [info ] [Thread-3  ]: 2 of 2 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.56s]
09:55:55.516032 [debug] [Thread-3  ]: Finished running node model.wrkplay_dbt.my_second_dbt_model
09:55:55.517003 [debug] [MainThread]: Acquiring new postgres connection "master"
09:55:55.517105 [debug] [MainThread]: Using postgres connection "master"
09:55:55.517164 [debug] [MainThread]: On master: BEGIN
09:55:55.517215 [debug] [MainThread]: Opening a new connection, currently in state closed
09:55:55.819962 [debug] [MainThread]: SQL status: BEGIN in 0.3 seconds
09:55:55.821053 [debug] [MainThread]: On master: COMMIT
09:55:55.821471 [debug] [MainThread]: Using postgres connection "master"
09:55:55.821830 [debug] [MainThread]: On master: COMMIT
09:55:55.870419 [debug] [MainThread]: SQL status: COMMIT in 0.05 seconds
09:55:55.870939 [debug] [MainThread]: On master: Close
09:55:55.871894 [info ] [MainThread]: 
09:55:55.872267 [info ] [MainThread]: Finished running 1 table model, 1 view model in 2.97s.
09:55:55.872550 [debug] [MainThread]: Connection 'master' was properly closed.
09:55:55.872694 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_first_dbt_model' was properly closed.
09:55:55.872836 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_second_dbt_model' was properly closed.
09:55:55.876184 [info ] [MainThread]: 
09:55:55.876343 [info ] [MainThread]: [32mCompleted successfully[0m
09:55:55.876459 [info ] [MainThread]: 
09:55:55.876549 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
09:55:55.876687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0ec40>]}


============================== 2022-07-08 10:05:47.521631 | e30a08f4-5a1f-42f2-badf-08cd5c59afcf ==============================
10:05:47.521654 [info ] [MainThread]: Running with dbt=1.1.1
10:05:47.522367 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
10:05:47.522456 [debug] [MainThread]: Tracking: tracking
10:05:47.542267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633ebe0>]}
10:05:47.559809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:05:47.559920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:05:47.563052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e30a08f4-5a1f-42f2-badf-08cd5c59afcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106507af0>]}
10:05:47.566100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e30a08f4-5a1f-42f2-badf-08cd5c59afcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645f3a0>]}
10:05:47.566236 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
10:05:47.566357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e30a08f4-5a1f-42f2-badf-08cd5c59afcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645f430>]}
10:05:47.566983 [info ] [MainThread]: 
10:05:47.567172 [debug] [MainThread]: Acquiring new postgres connection "master"
10:05:47.567573 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
10:05:47.572348 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
10:05:47.572487 [debug] [ThreadPool]: On list_postgres_public: BEGIN
10:05:47.572555 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:05:47.852624 [debug] [ThreadPool]: SQL status: BEGIN in 0.28 seconds
10:05:47.854271 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
10:05:47.854657 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
10:05:47.885503 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.03 seconds
10:05:47.888778 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
10:05:47.909733 [debug] [ThreadPool]: On list_postgres_public: Close
10:05:47.917286 [debug] [MainThread]: Using postgres connection "master"
10:05:47.917434 [debug] [MainThread]: On master: BEGIN
10:05:47.917496 [debug] [MainThread]: Opening a new connection, currently in state init
10:05:48.140255 [debug] [MainThread]: SQL status: BEGIN in 0.22 seconds
10:05:48.141094 [debug] [MainThread]: Using postgres connection "master"
10:05:48.141443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
10:05:48.305642 [debug] [MainThread]: SQL status: SELECT 1 in 0.16 seconds
10:05:48.309413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e30a08f4-5a1f-42f2-badf-08cd5c59afcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d8e50>]}
10:05:48.310534 [debug] [MainThread]: On master: ROLLBACK
10:05:48.334733 [debug] [MainThread]: Using postgres connection "master"
10:05:48.335223 [debug] [MainThread]: On master: BEGIN
10:05:48.406326 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
10:05:48.406872 [debug] [MainThread]: On master: COMMIT
10:05:48.407083 [debug] [MainThread]: Using postgres connection "master"
10:05:48.407271 [debug] [MainThread]: On master: COMMIT
10:05:48.426801 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
10:05:48.427287 [debug] [MainThread]: On master: Close
10:05:48.428089 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
10:05:48.428508 [info ] [MainThread]: 
10:05:48.433344 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
10:05:48.433504 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
10:05:48.433734 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
10:05:48.433809 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
10:05:48.433896 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
10:05:48.439178 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
10:05:48.440448 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
10:05:48.440526 [debug] [Thread-3  ]: Began running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
10:05:48.440642 [info ] [Thread-2  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
10:05:48.440701 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
10:05:48.440855 [info ] [Thread-3  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
10:05:48.441078 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
10:05:48.441197 [info ] [Thread-4  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
10:05:48.441389 [debug] [Thread-3  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
10:05:48.441463 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
10:05:48.441627 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
10:05:48.441716 [debug] [Thread-3  ]: Began compiling node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
10:05:48.441810 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
10:05:48.441877 [debug] [Thread-1  ]: finished collecting timing info
10:05:48.441942 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
10:05:48.441998 [debug] [Thread-3  ]: Compiling test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
10:05:48.443598 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
10:05:48.443695 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
10:05:48.443759 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
10:05:48.446482 [debug] [Thread-3  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
10:05:48.453352 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
10:05:48.454969 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
10:05:48.455116 [debug] [Thread-2  ]: finished collecting timing info
10:05:48.455340 [debug] [Thread-3  ]: finished collecting timing info
10:05:48.455433 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
10:05:48.455514 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
10:05:48.455618 [debug] [Thread-3  ]: Began executing node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
10:05:48.455670 [debug] [Thread-4  ]: finished collecting timing info
10:05:48.456944 [debug] [Thread-2  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
10:05:48.457031 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
10:05:48.457752 [debug] [Thread-3  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
10:05:48.457830 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
10:05:48.457933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:05:48.458683 [debug] [Thread-4  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
10:05:48.458769 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
10:05:48.458927 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
10:05:48.459015 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
10:05:48.459098 [debug] [Thread-3  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
10:05:48.459160 [debug] [Thread-2  ]: Opening a new connection, currently in state init
10:05:48.459217 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
10:05:48.459272 [debug] [Thread-3  ]: Opening a new connection, currently in state init
10:05:48.459376 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
10:05:48.459475 [debug] [Thread-4  ]: Opening a new connection, currently in state init
10:05:48.662071 [debug] [Thread-4  ]: SQL status: BEGIN in 0.2 seconds
10:05:48.662575 [debug] [Thread-1  ]: SQL status: BEGIN in 0.2 seconds
10:05:48.662882 [debug] [Thread-3  ]: SQL status: BEGIN in 0.2 seconds
10:05:48.663158 [debug] [Thread-2  ]: SQL status: BEGIN in 0.2 seconds
10:05:48.663614 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
10:05:48.663969 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
10:05:48.664300 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
10:05:48.664751 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
10:05:48.665091 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
10:05:48.665417 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
10:05:48.665788 [debug] [Thread-3  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
10:05:48.666149 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
10:05:48.687794 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.02 seconds
10:05:48.692600 [debug] [Thread-4  ]: finished collecting timing info
10:05:48.692845 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.03 seconds
10:05:48.692954 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.03 seconds
10:05:48.693000 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
10:05:48.693147 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
10:05:48.693834 [debug] [Thread-2  ]: finished collecting timing info
10:05:48.694350 [debug] [Thread-3  ]: finished collecting timing info
10:05:48.694872 [debug] [Thread-1  ]: finished collecting timing info
10:05:48.694990 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
10:05:48.695073 [debug] [Thread-3  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
10:05:48.695140 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
10:05:48.716666 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
10:05:48.717174 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
10:05:48.717456 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
10:05:48.717701 [debug] [Thread-3  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: Close
10:05:48.719380 [info ] [Thread-4  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.28s]
10:05:48.719855 [info ] [Thread-2  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.28s]
10:05:48.720366 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.29s]
10:05:48.720909 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
10:05:48.721096 [info ] [Thread-3  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.28s]
10:05:48.721293 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
10:05:48.721459 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
10:05:48.721660 [debug] [Thread-3  ]: Finished running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
10:05:48.722690 [debug] [MainThread]: Acquiring new postgres connection "master"
10:05:48.722793 [debug] [MainThread]: Using postgres connection "master"
10:05:48.722852 [debug] [MainThread]: On master: BEGIN
10:05:48.722904 [debug] [MainThread]: Opening a new connection, currently in state closed
10:05:48.917347 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
10:05:48.924982 [debug] [MainThread]: On master: COMMIT
10:05:48.925596 [debug] [MainThread]: Using postgres connection "master"
10:05:48.925944 [debug] [MainThread]: On master: COMMIT
10:05:48.944193 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
10:05:48.945094 [debug] [MainThread]: On master: Close
10:05:48.947039 [info ] [MainThread]: 
10:05:48.947715 [info ] [MainThread]: Finished running 4 tests in 1.38s.
10:05:48.948150 [debug] [MainThread]: Connection 'master' was properly closed.
10:05:48.948398 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
10:05:48.948700 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
10:05:48.948792 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
10:05:48.948843 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
10:05:48.954737 [info ] [MainThread]: 
10:05:48.954859 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
10:05:48.954966 [info ] [MainThread]: 
10:05:48.955053 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
10:05:48.955142 [error] [MainThread]:   Got 1 result, configured to fail if != 0
10:05:48.955223 [info ] [MainThread]: 
10:05:48.955308 [info ] [MainThread]:   compiled SQL at target/compiled/wrkplay_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
10:05:48.955395 [info ] [MainThread]: 
10:05:48.955479 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
10:05:48.955634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ab610>]}


============================== 2022-07-08 10:16:42.177568 | 1c575006-2303-4061-a8e0-faf352209c3d ==============================
10:16:42.177586 [info ] [MainThread]: Running with dbt=1.1.1
10:16:42.178303 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:16:42.178384 [debug] [MainThread]: Tracking: tracking
10:16:42.200663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104919a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104919b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104919b80>]}
10:16:42.218746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
10:16:42.218976 [debug] [MainThread]: Partial parsing: updated file: wrkplay_dbt://models/example/my_first_dbt_model.sql
10:16:42.225177 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
10:16:42.248706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c575006-2303-4061-a8e0-faf352209c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4f0d0>]}
10:16:42.252197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c575006-2303-4061-a8e0-faf352209c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5bfa0>]}
10:16:42.252388 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
10:16:42.252529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c575006-2303-4061-a8e0-faf352209c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa85e0>]}
10:16:42.253369 [info ] [MainThread]: 
10:16:42.253591 [debug] [MainThread]: Acquiring new postgres connection "master"
10:16:42.254011 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
10:16:42.259000 [debug] [ThreadPool]: Using postgres connection "list_postgres"
10:16:42.259125 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
10:16:42.259189 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:16:42.511837 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.25 seconds
10:16:42.515028 [debug] [ThreadPool]: On list_postgres: Close
10:16:42.517836 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
10:16:42.522124 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
10:16:42.522311 [debug] [ThreadPool]: On list_postgres_public: BEGIN
10:16:42.522370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:16:42.725374 [debug] [ThreadPool]: SQL status: BEGIN in 0.2 seconds
10:16:42.726015 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
10:16:42.726272 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
10:16:42.750496 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.02 seconds
10:16:42.756056 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
10:16:42.780984 [debug] [ThreadPool]: On list_postgres_public: Close
10:16:42.790266 [debug] [MainThread]: Using postgres connection "master"
10:16:42.790450 [debug] [MainThread]: On master: BEGIN
10:16:42.790514 [debug] [MainThread]: Opening a new connection, currently in state init
10:16:42.985861 [debug] [MainThread]: SQL status: BEGIN in 0.2 seconds
10:16:42.986763 [debug] [MainThread]: Using postgres connection "master"
10:16:42.987133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
10:16:43.153680 [debug] [MainThread]: SQL status: SELECT 1 in 0.17 seconds
10:16:43.156946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c575006-2303-4061-a8e0-faf352209c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd1fd0>]}
10:16:43.157479 [debug] [MainThread]: On master: ROLLBACK
10:16:43.173987 [debug] [MainThread]: Using postgres connection "master"
10:16:43.174474 [debug] [MainThread]: On master: BEGIN
10:16:43.212401 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
10:16:43.213240 [debug] [MainThread]: On master: COMMIT
10:16:43.213736 [debug] [MainThread]: Using postgres connection "master"
10:16:43.214190 [debug] [MainThread]: On master: COMMIT
10:16:43.231089 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
10:16:43.231802 [debug] [MainThread]: On master: Close
10:16:43.233474 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
10:16:43.234195 [info ] [MainThread]: 
10:16:43.241159 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.my_first_dbt_model
10:16:43.241469 [info ] [Thread-1  ]: 1 of 2 START view model public.my_first_dbt_model .............................. [RUN]
10:16:43.241805 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_first_dbt_model"
10:16:43.241891 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.my_first_dbt_model
10:16:43.241992 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.my_first_dbt_model
10:16:43.243793 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.my_first_dbt_model"
10:16:43.244472 [debug] [Thread-1  ]: finished collecting timing info
10:16:43.244577 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.my_first_dbt_model
10:16:43.255187 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_first_dbt_model"
10:16:43.255454 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
10:16:43.255516 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: BEGIN
10:16:43.255567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:16:43.456363 [debug] [Thread-1  ]: SQL status: BEGIN in 0.2 seconds
10:16:43.457845 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
10:16:43.458242 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */

  create view "postgres"."public"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
10:16:43.481245 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
10:16:43.488984 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
10:16:43.489190 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
10:16:43.508626 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
10:16:43.509608 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
10:16:43.509669 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
10:16:43.529102 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
10:16:43.531971 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
10:16:43.532047 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
10:16:43.532099 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
10:16:43.551668 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
10:16:43.558520 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
10:16:43.558612 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
10:16:43.587896 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
10:16:43.591229 [debug] [Thread-1  ]: finished collecting timing info
10:16:43.591419 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: Close
10:16:43.592010 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c575006-2303-4061-a8e0-faf352209c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e10670>]}
10:16:43.592322 [info ] [Thread-1  ]: 1 of 2 OK created view model public.my_first_dbt_model ......................... [[32mCREATE VIEW[0m in 0.35s]
10:16:43.592667 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.my_first_dbt_model
10:16:43.593164 [debug] [Thread-3  ]: Began running node model.wrkplay_dbt.my_second_dbt_model
10:16:43.593298 [info ] [Thread-3  ]: 2 of 2 START view model public.my_second_dbt_model ............................. [RUN]
10:16:43.593618 [debug] [Thread-3  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_second_dbt_model"
10:16:43.593714 [debug] [Thread-3  ]: Began compiling node model.wrkplay_dbt.my_second_dbt_model
10:16:43.593804 [debug] [Thread-3  ]: Compiling model.wrkplay_dbt.my_second_dbt_model
10:16:43.595055 [debug] [Thread-3  ]: Writing injected SQL for node "model.wrkplay_dbt.my_second_dbt_model"
10:16:43.595346 [debug] [Thread-3  ]: finished collecting timing info
10:16:43.595413 [debug] [Thread-3  ]: Began executing node model.wrkplay_dbt.my_second_dbt_model
10:16:43.596517 [debug] [Thread-3  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_second_dbt_model"
10:16:43.596705 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
10:16:43.596760 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: BEGIN
10:16:43.596811 [debug] [Thread-3  ]: Opening a new connection, currently in state init
10:16:43.788304 [debug] [Thread-3  ]: SQL status: BEGIN in 0.19 seconds
10:16:43.788903 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
10:16:43.789123 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
10:16:43.809984 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.02 seconds
10:16:43.815723 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
10:16:43.815871 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
10:16:43.835196 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.02 seconds
10:16:43.835810 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
10:16:43.835872 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
10:16:43.835923 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
10:16:43.855297 [debug] [Thread-3  ]: SQL status: COMMIT in 0.02 seconds
10:16:43.858724 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
10:16:43.859190 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
10:16:43.877305 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.02 seconds
10:16:43.914481 [debug] [Thread-3  ]: finished collecting timing info
10:16:43.914651 [debug] [Thread-3  ]: On model.wrkplay_dbt.my_second_dbt_model: Close
10:16:43.914931 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c575006-2303-4061-a8e0-faf352209c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488d670>]}
10:16:43.915088 [info ] [Thread-3  ]: 2 of 2 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.32s]
10:16:43.915264 [debug] [Thread-3  ]: Finished running node model.wrkplay_dbt.my_second_dbt_model
10:16:43.915931 [debug] [MainThread]: Acquiring new postgres connection "master"
10:16:43.916030 [debug] [MainThread]: Using postgres connection "master"
10:16:43.916097 [debug] [MainThread]: On master: BEGIN
10:16:43.916150 [debug] [MainThread]: Opening a new connection, currently in state closed
10:16:44.099792 [debug] [MainThread]: SQL status: BEGIN in 0.18 seconds
10:16:44.101279 [debug] [MainThread]: On master: COMMIT
10:16:44.101649 [debug] [MainThread]: Using postgres connection "master"
10:16:44.102009 [debug] [MainThread]: On master: COMMIT
10:16:44.119982 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
10:16:44.120863 [debug] [MainThread]: On master: Close
10:16:44.122862 [info ] [MainThread]: 
10:16:44.123594 [info ] [MainThread]: Finished running 2 view models in 1.87s.
10:16:44.124134 [debug] [MainThread]: Connection 'master' was properly closed.
10:16:44.124310 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_first_dbt_model' was properly closed.
10:16:44.124487 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_second_dbt_model' was properly closed.
10:16:44.130192 [info ] [MainThread]: 
10:16:44.130397 [info ] [MainThread]: [32mCompleted successfully[0m
10:16:44.130531 [info ] [MainThread]: 
10:16:44.130622 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
10:16:44.130764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be5e80>]}


============================== 2022-07-08 10:16:50.508733 | a4d15fa2-8bc6-47e6-9193-671cade9a329 ==============================
10:16:50.508759 [info ] [MainThread]: Running with dbt=1.1.1
10:16:50.509117 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
10:16:50.509197 [debug] [MainThread]: Tracking: tracking
10:16:50.522434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10851db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10851dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10851dca0>]}
10:16:50.536691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:16:50.536793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:16:50.539806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4d15fa2-8bc6-47e6-9193-671cade9a329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e20d0>]}
10:16:50.542202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4d15fa2-8bc6-47e6-9193-671cade9a329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108643340>]}
10:16:50.542334 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
10:16:50.542451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d15fa2-8bc6-47e6-9193-671cade9a329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086433a0>]}
10:16:50.543074 [info ] [MainThread]: 
10:16:50.543267 [debug] [MainThread]: Acquiring new postgres connection "master"
10:16:50.543661 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
10:16:50.547994 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
10:16:50.548080 [debug] [ThreadPool]: On list_postgres_public: BEGIN
10:16:50.548140 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:16:50.724026 [debug] [ThreadPool]: SQL status: BEGIN in 0.18 seconds
10:16:50.724433 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
10:16:50.724505 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
10:16:50.746183 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.02 seconds
10:16:50.747624 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
10:16:50.764770 [debug] [ThreadPool]: On list_postgres_public: Close
10:16:50.772106 [debug] [MainThread]: Using postgres connection "master"
10:16:50.772230 [debug] [MainThread]: On master: BEGIN
10:16:50.772293 [debug] [MainThread]: Opening a new connection, currently in state init
10:16:50.974201 [debug] [MainThread]: SQL status: BEGIN in 0.2 seconds
10:16:50.975141 [debug] [MainThread]: Using postgres connection "master"
10:16:50.975501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
10:16:51.140967 [debug] [MainThread]: SQL status: SELECT 1 in 0.17 seconds
10:16:51.146112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d15fa2-8bc6-47e6-9193-671cade9a329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108659d90>]}
10:16:51.146908 [debug] [MainThread]: On master: ROLLBACK
10:16:51.167050 [debug] [MainThread]: Using postgres connection "master"
10:16:51.167881 [debug] [MainThread]: On master: BEGIN
10:16:51.213375 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
10:16:51.214370 [debug] [MainThread]: On master: COMMIT
10:16:51.214806 [debug] [MainThread]: Using postgres connection "master"
10:16:51.215333 [debug] [MainThread]: On master: COMMIT
10:16:51.236382 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
10:16:51.237257 [debug] [MainThread]: On master: Close
10:16:51.239090 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
10:16:51.239562 [info ] [MainThread]: 
10:16:51.243871 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
10:16:51.244078 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
10:16:51.244181 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
10:16:51.244249 [debug] [Thread-3  ]: Began running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
10:16:51.244333 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
10:16:51.244386 [info ] [Thread-2  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
10:16:51.244689 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
10:16:51.244764 [info ] [Thread-3  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
10:16:51.244864 [info ] [Thread-4  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
10:16:51.245104 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
10:16:51.245216 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
10:16:51.245453 [debug] [Thread-3  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
10:16:51.245692 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
10:16:51.245747 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
10:16:51.245847 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
10:16:51.245904 [debug] [Thread-3  ]: Began compiling node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
10:16:51.245957 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
10:16:51.246009 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
10:16:51.252298 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
10:16:51.252411 [debug] [Thread-3  ]: Compiling test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
10:16:51.252471 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
10:16:51.254029 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
10:16:51.256757 [debug] [Thread-3  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
10:16:51.258178 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
10:16:51.258392 [debug] [Thread-1  ]: finished collecting timing info
10:16:51.258479 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
10:16:51.264956 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
10:16:51.265122 [debug] [Thread-4  ]: finished collecting timing info
10:16:51.265192 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
10:16:51.266378 [debug] [Thread-4  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
10:16:51.266451 [debug] [Thread-3  ]: finished collecting timing info
10:16:51.266512 [debug] [Thread-2  ]: finished collecting timing info
10:16:51.266614 [debug] [Thread-3  ]: Began executing node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
10:16:51.266696 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
10:16:51.266783 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
10:16:51.267532 [debug] [Thread-3  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
10:16:51.267604 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
10:16:51.267664 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
10:16:51.268342 [debug] [Thread-2  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
10:16:51.268453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:16:51.268532 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
10:16:51.268639 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
10:16:51.268783 [debug] [Thread-4  ]: Opening a new connection, currently in state init
10:16:51.268843 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
10:16:51.268901 [debug] [Thread-3  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
10:16:51.269017 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
10:16:51.269071 [debug] [Thread-3  ]: Opening a new connection, currently in state init
10:16:51.269126 [debug] [Thread-2  ]: Opening a new connection, currently in state init
10:16:51.465791 [debug] [Thread-2  ]: SQL status: BEGIN in 0.2 seconds
10:16:51.466360 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
10:16:51.466622 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
10:16:51.467179 [debug] [Thread-1  ]: SQL status: BEGIN in 0.2 seconds
10:16:51.467423 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
10:16:51.467647 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
10:16:51.468550 [debug] [Thread-4  ]: SQL status: BEGIN in 0.2 seconds
10:16:51.468920 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
10:16:51.469158 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
10:16:51.469993 [debug] [Thread-3  ]: SQL status: BEGIN in 0.2 seconds
10:16:51.470403 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
10:16:51.470745 [debug] [Thread-3  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
10:16:51.487119 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.02 seconds
10:16:51.487471 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
10:16:51.492966 [debug] [Thread-2  ]: finished collecting timing info
10:16:51.493178 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.02 seconds
10:16:51.493368 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.02 seconds
10:16:51.494886 [debug] [Thread-1  ]: finished collecting timing info
10:16:51.495060 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
10:16:51.495667 [debug] [Thread-3  ]: finished collecting timing info
10:16:51.496216 [debug] [Thread-4  ]: finished collecting timing info
10:16:51.496295 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
10:16:51.496397 [debug] [Thread-3  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
10:16:51.496471 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
10:16:51.514508 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
10:16:51.514871 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
10:16:51.516291 [info ] [Thread-2  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.27s]
10:16:51.516980 [info ] [Thread-1  ]: 1 of 4 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.27s]
10:16:51.519117 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
10:16:51.517975 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
10:16:51.519718 [debug] [Thread-3  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: Close
10:16:51.520042 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
10:16:51.521026 [info ] [Thread-3  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.28s]
10:16:51.521412 [info ] [Thread-4  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.28s]
10:16:51.522036 [debug] [Thread-3  ]: Finished running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
10:16:51.522271 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
10:16:51.523171 [debug] [MainThread]: Acquiring new postgres connection "master"
10:16:51.523266 [debug] [MainThread]: Using postgres connection "master"
10:16:51.523323 [debug] [MainThread]: On master: BEGIN
10:16:51.523377 [debug] [MainThread]: Opening a new connection, currently in state closed
10:16:51.710760 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
10:16:51.712304 [debug] [MainThread]: On master: COMMIT
10:16:51.712665 [debug] [MainThread]: Using postgres connection "master"
10:16:51.713021 [debug] [MainThread]: On master: COMMIT
10:16:51.733673 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
10:16:51.734569 [debug] [MainThread]: On master: Close
10:16:51.736377 [info ] [MainThread]: 
10:16:51.736912 [info ] [MainThread]: Finished running 4 tests in 1.19s.
10:16:51.737285 [debug] [MainThread]: Connection 'master' was properly closed.
10:16:51.737469 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
10:16:51.737650 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
10:16:51.737818 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
10:16:51.738012 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
10:16:51.744522 [info ] [MainThread]: 
10:16:51.744743 [info ] [MainThread]: [32mCompleted successfully[0m
10:16:51.744876 [info ] [MainThread]: 
10:16:51.744965 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
10:16:51.745169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908c790>]}


============================== 2022-07-08 10:31:46.474724 | 07e7e14c-50e6-4837-8939-b7e6e47a30ed ==============================
10:31:46.474729 [info ] [MainThread]: Running with dbt=1.1.1
10:31:46.475146 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
10:31:46.475212 [debug] [MainThread]: Tracking: tracking
10:31:46.493447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106084af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106084970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060849a0>]}
10:31:46.535641 [debug] [MainThread]: Executing "git --help"
10:31:46.550129 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
10:31:46.550610 [debug] [MainThread]: STDERR: "b''"
10:31:46.554164 [debug] [MainThread]: Acquiring new postgres connection "debug"
10:31:46.554597 [debug] [MainThread]: Using postgres connection "debug"
10:31:46.554664 [debug] [MainThread]: On debug: select 1 as id
10:31:46.554736 [debug] [MainThread]: Opening a new connection, currently in state init
10:31:46.862049 [debug] [MainThread]: SQL status: SELECT 1 in 0.31 seconds
10:31:46.867655 [debug] [MainThread]: On debug: Close
10:31:46.868215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ed460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ed970>]}
10:31:47.537882 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-08 14:51:14.812917 | 743020ff-c185-48ca-a311-eb594eaaf8be ==============================
14:51:14.812940 [info ] [MainThread]: Running with dbt=1.1.1
14:51:14.813482 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:51:14.813559 [debug] [MainThread]: Tracking: tracking
14:51:14.833981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5ebe0>]}
14:51:14.845420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d77340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107204ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107204940>]}


============================== 2022-07-08 14:53:54.000177 | 3730e3db-2124-418d-8bf7-57ea26603a03 ==============================
14:53:54.000202 [info ] [MainThread]: Running with dbt=1.1.1
14:53:54.001355 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:53:54.001480 [debug] [MainThread]: Tracking: tracking
14:53:54.021685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f05c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f05d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f05d90>]}
14:53:54.041092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
14:53:54.041274 [debug] [MainThread]: Partial parsing: added file: wrkplay_dbt://models/wins_losses.sql
14:53:54.041403 [debug] [MainThread]: Partial parsing: added file: wrkplay_dbt://models/schema.yml
14:53:54.047493 [debug] [MainThread]: 1699: static parser successfully parsed wins_losses.sql
14:53:54.077888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3730e3db-2124-418d-8bf7-57ea26603a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ef7c0>]}
14:53:54.081034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3730e3db-2124-418d-8bf7-57ea26603a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409bcd0>]}
14:53:54.081185 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:53:54.081330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3730e3db-2124-418d-8bf7-57ea26603a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f04760>]}
14:53:54.082073 [info ] [MainThread]: 
14:53:54.082269 [debug] [MainThread]: Acquiring new postgres connection "master"
14:53:54.082665 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
14:53:54.086988 [debug] [ThreadPool]: Using postgres connection "list_postgres"
14:53:54.087066 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
14:53:54.087127 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:53:54.625092 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.54 seconds
14:53:54.629367 [debug] [ThreadPool]: On list_postgres: Close
14:53:54.630423 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
14:53:54.633807 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
14:53:54.633894 [debug] [ThreadPool]: On list_postgres_public: BEGIN
14:53:54.633953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:53:55.048364 [debug] [ThreadPool]: SQL status: BEGIN in 0.41 seconds
14:53:55.049866 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
14:53:55.050327 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:53:55.080954 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.03 seconds
14:53:55.085670 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
14:53:55.126185 [debug] [ThreadPool]: On list_postgres_public: Close
14:53:55.133824 [debug] [MainThread]: Using postgres connection "master"
14:53:55.133964 [debug] [MainThread]: On master: BEGIN
14:53:55.134029 [debug] [MainThread]: Opening a new connection, currently in state init
14:53:55.577062 [debug] [MainThread]: SQL status: BEGIN in 0.44 seconds
14:53:55.578155 [debug] [MainThread]: Using postgres connection "master"
14:53:55.578352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:53:55.741989 [debug] [MainThread]: SQL status: SELECT 1 in 0.16 seconds
14:53:55.746773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3730e3db-2124-418d-8bf7-57ea26603a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff5ca0>]}
14:53:55.747213 [debug] [MainThread]: On master: ROLLBACK
14:53:55.765799 [debug] [MainThread]: Using postgres connection "master"
14:53:55.766615 [debug] [MainThread]: On master: BEGIN
14:53:55.818021 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
14:53:55.819101 [debug] [MainThread]: On master: COMMIT
14:53:55.819384 [debug] [MainThread]: Using postgres connection "master"
14:53:55.819703 [debug] [MainThread]: On master: COMMIT
14:53:55.839144 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
14:53:55.840009 [debug] [MainThread]: On master: Close
14:53:55.842060 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:53:55.842548 [info ] [MainThread]: 
14:53:55.848643 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.my_first_dbt_model
14:53:55.848772 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
14:53:55.848973 [info ] [Thread-1  ]: 1 of 3 START view model public.my_first_dbt_model .............................. [RUN]
14:53:55.849093 [info ] [Thread-2  ]: 2 of 3 START view model public.wins_losses ..................................... [RUN]
14:53:55.849349 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_first_dbt_model"
14:53:55.849522 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
14:53:55.849596 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.my_first_dbt_model
14:53:55.849659 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
14:53:55.849764 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.my_first_dbt_model
14:53:55.849825 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
14:53:55.851626 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.my_first_dbt_model"
14:53:55.852276 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
14:53:55.852941 [debug] [Thread-2  ]: finished collecting timing info
14:53:55.853055 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
14:53:55.863672 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
14:53:55.863764 [debug] [Thread-1  ]: finished collecting timing info
14:53:55.863867 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.my_first_dbt_model
14:53:55.864964 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_first_dbt_model"
14:53:55.865136 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:53:55.865226 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: BEGIN
14:53:55.865293 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:53:55.865353 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
14:53:55.865482 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: BEGIN
14:53:55.865535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:53:56.214600 [debug] [Thread-1  ]: SQL status: BEGIN in 0.35 seconds
14:53:56.215955 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
14:53:56.216338 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */

  create view "postgres"."public"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
14:53:56.249061 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
14:53:56.249500 [debug] [Thread-2  ]: SQL status: BEGIN in 0.38 seconds
14:53:56.259313 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
14:53:56.259403 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:53:56.259493 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:53:56.259552 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */

  create view "postgres"."public"."wins_losses__dbt_tmp" as (
    --number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
14:53:56.278438 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
14:53:56.303204 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.04 seconds
14:53:56.303767 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
14:53:56.304769 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:53:56.304850 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:53:56.304911 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
14:53:56.411620 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
14:53:56.414103 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.11 seconds
14:53:56.424057 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
14:53:56.424737 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
14:53:56.424833 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
14:53:56.424899 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:53:56.424958 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
14:53:56.425013 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
14:53:56.443822 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
14:53:56.450382 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
14:53:56.450522 [debug] [Thread-2  ]: SQL status: COMMIT in 0.03 seconds
14:53:56.450607 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
drop view if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
14:53:56.451409 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:53:56.451557 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop view if exists "postgres"."public"."wins_losses__dbt_backup" cascade
14:53:56.495968 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.04 seconds
14:53:56.496431 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.04 seconds
14:53:56.499747 [debug] [Thread-1  ]: finished collecting timing info
14:53:56.501673 [debug] [Thread-2  ]: finished collecting timing info
14:53:56.502328 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: Close
14:53:56.502559 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: Close
14:53:56.503076 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3730e3db-2124-418d-8bf7-57ea26603a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b0340>]}
14:53:56.503266 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3730e3db-2124-418d-8bf7-57ea26603a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041db850>]}
14:53:56.503507 [info ] [Thread-1  ]: 1 of 3 OK created view model public.my_first_dbt_model ......................... [[32mCREATE VIEW[0m in 0.65s]
14:53:56.503661 [info ] [Thread-2  ]: 2 of 3 OK created view model public.wins_losses ................................ [[32mCREATE VIEW[0m in 0.65s]
14:53:56.503921 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.my_first_dbt_model
14:53:56.504080 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
14:53:56.504400 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.my_second_dbt_model
14:53:56.504510 [info ] [Thread-2  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:53:56.504710 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_second_dbt_model"
14:53:56.504782 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.my_second_dbt_model
14:53:56.504863 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.my_second_dbt_model
14:53:56.506492 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.my_second_dbt_model"
14:53:56.506833 [debug] [Thread-2  ]: finished collecting timing info
14:53:56.506924 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.my_second_dbt_model
14:53:56.508107 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_second_dbt_model"
14:53:56.508309 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
14:53:56.508374 [debug] [Thread-2  ]: On model.wrkplay_dbt.my_second_dbt_model: BEGIN
14:53:56.508427 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:53:56.739241 [debug] [Thread-2  ]: SQL status: BEGIN in 0.23 seconds
14:53:56.740719 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
14:53:56.741103 [debug] [Thread-2  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
14:53:56.762489 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.02 seconds
14:53:56.768302 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
14:53:56.768510 [debug] [Thread-2  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:53:56.814770 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.05 seconds
14:53:56.818733 [debug] [Thread-2  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
14:53:56.818978 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
14:53:56.819232 [debug] [Thread-2  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
14:53:56.839798 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
14:53:56.843874 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
14:53:56.843978 [debug] [Thread-2  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
14:53:56.861618 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
14:53:56.862586 [debug] [Thread-2  ]: finished collecting timing info
14:53:56.862695 [debug] [Thread-2  ]: On model.wrkplay_dbt.my_second_dbt_model: Close
14:53:56.863138 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3730e3db-2124-418d-8bf7-57ea26603a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10415c340>]}
14:53:56.863381 [info ] [Thread-2  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.36s]
14:53:56.863639 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.my_second_dbt_model
14:53:56.864650 [debug] [MainThread]: Acquiring new postgres connection "master"
14:53:56.864808 [debug] [MainThread]: Using postgres connection "master"
14:53:56.864876 [debug] [MainThread]: On master: BEGIN
14:53:56.864935 [debug] [MainThread]: Opening a new connection, currently in state closed
14:53:57.262853 [debug] [MainThread]: SQL status: BEGIN in 0.4 seconds
14:53:57.263384 [debug] [MainThread]: On master: COMMIT
14:53:57.263562 [debug] [MainThread]: Using postgres connection "master"
14:53:57.263726 [debug] [MainThread]: On master: COMMIT
14:53:57.281912 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
14:53:57.282406 [debug] [MainThread]: On master: Close
14:53:57.283235 [info ] [MainThread]: 
14:53:57.283565 [info ] [MainThread]: Finished running 3 view models in 3.20s.
14:53:57.283828 [debug] [MainThread]: Connection 'master' was properly closed.
14:53:57.283977 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_first_dbt_model' was properly closed.
14:53:57.284119 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_second_dbt_model' was properly closed.
14:53:57.290112 [info ] [MainThread]: 
14:53:57.290280 [info ] [MainThread]: [32mCompleted successfully[0m
14:53:57.290399 [info ] [MainThread]: 
14:53:57.290486 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:53:57.290623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041881f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f045e0>]}


============================== 2022-07-08 15:21:45.635234 | d2c16bcc-ac86-46db-a9aa-1cd82dcc8a3f ==============================
15:21:45.635259 [info ] [MainThread]: Running with dbt=1.1.1
15:21:45.635902 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:21:45.635995 [debug] [MainThread]: Tracking: tracking
15:21:45.662596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c6d00>]}
15:21:45.680887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:21:45.681131 [debug] [MainThread]: Partial parsing: updated file: wrkplay_dbt://models/wins_losses.sql
15:21:45.688543 [debug] [MainThread]: 1699: static parser successfully parsed wins_losses.sql
15:21:45.717451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2c16bcc-ac86-46db-a9aa-1cd82dcc8a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044bbe80>]}
15:21:45.720806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2c16bcc-ac86-46db-a9aa-1cd82dcc8a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104437190>]}
15:21:45.720947 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:21:45.721087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2c16bcc-ac86-46db-a9aa-1cd82dcc8a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104437400>]}
15:21:45.721781 [info ] [MainThread]: 
15:21:45.721995 [debug] [MainThread]: Acquiring new postgres connection "master"
15:21:45.722375 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
15:21:45.726603 [debug] [ThreadPool]: Using postgres connection "list_postgres"
15:21:45.726706 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
15:21:45.726776 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:21:46.005364 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.28 seconds
15:21:46.010288 [debug] [ThreadPool]: On list_postgres: Close
15:21:46.011417 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
15:21:46.014928 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
15:21:46.015012 [debug] [ThreadPool]: On list_postgres_public: BEGIN
15:21:46.015073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:21:46.206908 [debug] [ThreadPool]: SQL status: BEGIN in 0.19 seconds
15:21:46.207404 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
15:21:46.207726 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:21:46.230220 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
15:21:46.233607 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
15:21:46.251820 [debug] [ThreadPool]: On list_postgres_public: Close
15:21:46.259790 [debug] [MainThread]: Using postgres connection "master"
15:21:46.259998 [debug] [MainThread]: On master: BEGIN
15:21:46.260065 [debug] [MainThread]: Opening a new connection, currently in state init
15:21:46.437986 [debug] [MainThread]: SQL status: BEGIN in 0.18 seconds
15:21:46.438700 [debug] [MainThread]: Using postgres connection "master"
15:21:46.439051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:21:46.605211 [debug] [MainThread]: SQL status: SELECT 4 in 0.17 seconds
15:21:46.607950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2c16bcc-ac86-46db-a9aa-1cd82dcc8a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b4430>]}
15:21:46.608369 [debug] [MainThread]: On master: ROLLBACK
15:21:46.626392 [debug] [MainThread]: Using postgres connection "master"
15:21:46.627167 [debug] [MainThread]: On master: BEGIN
15:21:46.664576 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
15:21:46.665299 [debug] [MainThread]: On master: COMMIT
15:21:46.665524 [debug] [MainThread]: Using postgres connection "master"
15:21:46.665721 [debug] [MainThread]: On master: COMMIT
15:21:46.683106 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
15:21:46.683483 [debug] [MainThread]: On master: Close
15:21:46.684209 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:21:46.684574 [info ] [MainThread]: 
15:21:46.689739 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.my_first_dbt_model
15:21:46.689930 [info ] [Thread-1  ]: 1 of 3 START view model public.my_first_dbt_model .............................. [RUN]
15:21:46.690150 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:21:46.690221 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.my_first_dbt_model
15:21:46.690291 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.my_first_dbt_model
15:21:46.691462 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.my_first_dbt_model"
15:21:46.691601 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
15:21:46.691727 [info ] [Thread-2  ]: 2 of 3 START table model public.wins_losses .................................... [RUN]
15:21:46.691928 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
15:21:46.691991 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
15:21:46.692050 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
15:21:46.693250 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
15:21:46.693608 [debug] [Thread-1  ]: finished collecting timing info
15:21:46.693684 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.my_first_dbt_model
15:21:46.704169 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_first_dbt_model"
15:21:46.704262 [debug] [Thread-2  ]: finished collecting timing info
15:21:46.704418 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
15:21:46.714601 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
15:21:46.714716 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:21:46.714810 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: BEGIN
15:21:46.714888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:46.715026 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:21:46.715082 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: BEGIN
15:21:46.715132 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:21:46.892816 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
15:21:46.893830 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:21:46.894052 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */

  create view "postgres"."public"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
15:21:46.913020 [debug] [Thread-2  ]: SQL status: BEGIN in 0.2 seconds
15:21:46.913908 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:21:46.914268 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */


  create  table "postgres"."public"."wins_losses__dbt_tmp"
  as (
    

--number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
15:21:46.915654 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
15:21:46.954736 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:21:46.954895 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:21:46.959302 [debug] [Thread-2  ]: SQL status: SELECT 190 in 0.04 seconds
15:21:46.960343 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:21:46.960412 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses" rename to "wins_losses__dbt_backup"
15:21:46.973154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
15:21:46.974025 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:21:46.974082 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:21:46.980057 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
15:21:46.980906 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:21:46.980963 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
15:21:46.992211 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
15:21:46.995054 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
15:21:46.995128 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:21:46.995182 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
15:21:46.999520 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
15:21:47.001792 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
15:21:47.001857 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:21:47.001910 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
15:21:47.013855 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
15:21:47.015829 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:21:47.015898 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
drop view if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
15:21:47.021227 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
15:21:47.021873 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:21:47.021931 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop view if exists "postgres"."public"."wins_losses__dbt_backup" cascade
15:21:47.036480 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
15:21:47.036925 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.037000 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: Close
15:21:47.037231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c16bcc-ac86-46db-a9aa-1cd82dcc8a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461bf10>]}
15:21:47.037381 [info ] [Thread-1  ]: 1 of 3 OK created view model public.my_first_dbt_model ......................... [[32mCREATE VIEW[0m in 0.35s]
15:21:47.037559 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.my_first_dbt_model
15:21:47.037725 [debug] [Thread-4  ]: Began running node model.wrkplay_dbt.my_second_dbt_model
15:21:47.037823 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:21:47.037987 [debug] [Thread-4  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:21:47.038048 [debug] [Thread-4  ]: Began compiling node model.wrkplay_dbt.my_second_dbt_model
15:21:47.038105 [debug] [Thread-4  ]: Compiling model.wrkplay_dbt.my_second_dbt_model
15:21:47.039067 [debug] [Thread-4  ]: Writing injected SQL for node "model.wrkplay_dbt.my_second_dbt_model"
15:21:47.039378 [debug] [Thread-4  ]: finished collecting timing info
15:21:47.039439 [debug] [Thread-4  ]: Began executing node model.wrkplay_dbt.my_second_dbt_model
15:21:47.040513 [debug] [Thread-4  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_second_dbt_model"
15:21:47.040705 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:21:47.040768 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: BEGIN
15:21:47.040817 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:21:47.044321 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
15:21:47.044773 [debug] [Thread-2  ]: finished collecting timing info
15:21:47.044842 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: Close
15:21:47.045054 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c16bcc-ac86-46db-a9aa-1cd82dcc8a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461bdc0>]}
15:21:47.045178 [info ] [Thread-2  ]: 2 of 3 OK created table model public.wins_losses ............................... [[32mSELECT 190[0m in 0.35s]
15:21:47.045337 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
15:21:47.240405 [debug] [Thread-4  ]: SQL status: BEGIN in 0.2 seconds
15:21:47.240939 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:21:47.241199 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
15:21:47.261583 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.02 seconds
15:21:47.265937 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:21:47.266339 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:21:47.284702 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.02 seconds
15:21:47.288055 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
15:21:47.288362 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:21:47.288547 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
15:21:47.307055 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
15:21:47.312147 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:21:47.312718 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
15:21:47.329928 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
15:21:47.331906 [debug] [Thread-4  ]: finished collecting timing info
15:21:47.332158 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: Close
15:21:47.332885 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c16bcc-ac86-46db-a9aa-1cd82dcc8a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104597070>]}
15:21:47.333324 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.29s]
15:21:47.333912 [debug] [Thread-4  ]: Finished running node model.wrkplay_dbt.my_second_dbt_model
15:21:47.335220 [debug] [MainThread]: Acquiring new postgres connection "master"
15:21:47.335387 [debug] [MainThread]: Using postgres connection "master"
15:21:47.335451 [debug] [MainThread]: On master: BEGIN
15:21:47.335505 [debug] [MainThread]: Opening a new connection, currently in state closed
15:21:47.524345 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
15:21:47.525073 [debug] [MainThread]: On master: COMMIT
15:21:47.525437 [debug] [MainThread]: Using postgres connection "master"
15:21:47.525774 [debug] [MainThread]: On master: COMMIT
15:21:47.547050 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
15:21:47.547635 [debug] [MainThread]: On master: Close
15:21:47.548824 [info ] [MainThread]: 
15:21:47.549510 [info ] [MainThread]: Finished running 2 view models, 1 table model in 1.83s.
15:21:47.550096 [debug] [MainThread]: Connection 'master' was properly closed.
15:21:47.550412 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_first_dbt_model' was properly closed.
15:21:47.550714 [debug] [MainThread]: Connection 'model.wrkplay_dbt.wins_losses' was properly closed.
15:21:47.550888 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_second_dbt_model' was properly closed.
15:21:47.555857 [info ] [MainThread]: 
15:21:47.556047 [info ] [MainThread]: [32mCompleted successfully[0m
15:21:47.556180 [info ] [MainThread]: 
15:21:47.556275 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
15:21:47.556448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454a3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c4430>]}


============================== 2022-07-08 15:26:00.480355 | a64aca8e-9649-4e28-87de-0655145090d2 ==============================
15:26:00.480375 [info ] [MainThread]: Running with dbt=1.1.1
15:26:00.481048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
15:26:00.481153 [debug] [MainThread]: Tracking: tracking
15:26:00.504072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211daaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211dac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211dac40>]}
15:26:00.526829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:26:00.526981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:26:00.531052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a64aca8e-9649-4e28-87de-0655145090d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213b70d0>]}
15:26:00.535107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a64aca8e-9649-4e28-87de-0655145090d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121307520>]}
15:26:00.535300 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:26:00.535435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a64aca8e-9649-4e28-87de-0655145090d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121307640>]}
15:26:00.536291 [info ] [MainThread]: 
15:26:00.536528 [debug] [MainThread]: Acquiring new postgres connection "master"
15:26:00.537160 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
15:26:00.542327 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
15:26:00.542433 [debug] [ThreadPool]: On list_postgres_public: BEGIN
15:26:00.542498 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:26:00.807206 [debug] [ThreadPool]: SQL status: BEGIN in 0.26 seconds
15:26:00.810002 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
15:26:00.812748 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:26:00.836261 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
15:26:00.852177 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
15:26:00.873209 [debug] [ThreadPool]: On list_postgres_public: Close
15:26:00.890108 [debug] [MainThread]: Using postgres connection "master"
15:26:00.890744 [debug] [MainThread]: On master: BEGIN
15:26:00.891145 [debug] [MainThread]: Opening a new connection, currently in state init
15:26:01.104360 [debug] [MainThread]: SQL status: BEGIN in 0.21 seconds
15:26:01.104959 [debug] [MainThread]: Using postgres connection "master"
15:26:01.105237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:26:01.273403 [debug] [MainThread]: SQL status: SELECT 1 in 0.17 seconds
15:26:01.276966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a64aca8e-9649-4e28-87de-0655145090d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121307280>]}
15:26:01.277714 [debug] [MainThread]: On master: ROLLBACK
15:26:01.295867 [debug] [MainThread]: Using postgres connection "master"
15:26:01.296376 [debug] [MainThread]: On master: BEGIN
15:26:01.332073 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
15:26:01.332723 [debug] [MainThread]: On master: COMMIT
15:26:01.333096 [debug] [MainThread]: Using postgres connection "master"
15:26:01.333642 [debug] [MainThread]: On master: COMMIT
15:26:01.352043 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
15:26:01.352797 [debug] [MainThread]: On master: Close
15:26:01.354676 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:26:01.355767 [info ] [MainThread]: 
15:26:01.364181 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
15:26:01.364880 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
15:26:01.365151 [info ] [Thread-1  ]: 1 of 10 START test not_null_my_first_dbt_model_id .............................. [RUN]
15:26:01.365462 [debug] [Thread-3  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
15:26:01.367993 [info ] [Thread-3  ]: 3 of 10 START test not_null_wins_losses_gameid ................................. [RUN]
15:26:01.365778 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
15:26:01.369389 [info ] [Thread-4  ]: 4 of 10 START test not_null_wins_losses_player_id .............................. [RUN]
15:26:01.369948 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
15:26:01.370152 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
15:26:01.370630 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
15:26:01.366317 [debug] [Thread-5  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
15:26:01.369119 [debug] [Thread-8  ]: Began running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
15:26:01.382283 [debug] [Thread-9  ]: Began running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
15:26:01.366003 [info ] [Thread-2  ]: 2 of 10 START test not_null_my_second_dbt_model_id ............................. [RUN]
15:26:01.366722 [debug] [Thread-6  ]: Began running node test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741
15:26:01.367651 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
15:26:01.368555 [debug] [Thread-3  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
15:26:01.368953 [debug] [Thread-7  ]: Began running node test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6
15:26:01.387516 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
15:26:01.387610 [debug] [Thread-10 ]: Began running node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
15:26:01.387744 [info ] [Thread-5  ]: 5 of 10 START test not_null_wins_losses_seasonid ............................... [RUN]
15:26:01.387824 [info ] [Thread-8  ]: 8 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
15:26:01.387890 [info ] [Thread-9  ]: 9 of 10 START test unique_my_second_dbt_model_id ............................... [RUN]
15:26:01.388087 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
15:26:01.388161 [info ] [Thread-6  ]: 6 of 10 START test positive_wins_losses_total_losses ........................... [RUN]
15:26:01.388231 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
15:26:01.388293 [debug] [Thread-3  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
15:26:01.388357 [info ] [Thread-7  ]: 7 of 10 START test positive_wins_losses_total_wins ............................. [RUN]
15:26:01.388513 [info ] [Thread-10 ]: 10 of 10 START test unique_wins_losses_seasonid ................................ [RUN]
15:26:01.388730 [debug] [Thread-5  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
15:26:01.388944 [debug] [Thread-8  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
15:26:01.389105 [debug] [Thread-9  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
15:26:01.389167 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
15:26:01.389258 [debug] [Thread-4  ]: finished collecting timing info
15:26:01.389410 [debug] [Thread-6  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741"
15:26:01.389472 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
15:26:01.389527 [debug] [Thread-3  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
15:26:01.389666 [debug] [Thread-7  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6"
15:26:01.389804 [debug] [Thread-10 ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
15:26:01.389860 [debug] [Thread-5  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
15:26:01.389913 [debug] [Thread-8  ]: Began compiling node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
15:26:01.389966 [debug] [Thread-9  ]: Began compiling node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
15:26:01.390017 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
15:26:01.390081 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
15:26:01.390136 [debug] [Thread-6  ]: Began compiling node test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741
15:26:01.391767 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
15:26:01.393249 [debug] [Thread-3  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
15:26:01.393335 [debug] [Thread-7  ]: Began compiling node test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6
15:26:01.393423 [debug] [Thread-10 ]: Began compiling node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
15:26:01.393502 [debug] [Thread-5  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
15:26:01.393572 [debug] [Thread-8  ]: Compiling test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
15:26:01.393654 [debug] [Thread-9  ]: Compiling test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
15:26:01.395693 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
15:26:01.402240 [debug] [Thread-4  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
15:26:01.402340 [debug] [Thread-6  ]: Compiling test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741
15:26:01.402804 [debug] [Thread-7  ]: Compiling test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6
15:26:01.402958 [debug] [Thread-10 ]: Compiling test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
15:26:01.403086 [debug] [Thread-3  ]: finished collecting timing info
15:26:01.404804 [debug] [Thread-5  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
15:26:01.407754 [debug] [Thread-8  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
15:26:01.407863 [debug] [Thread-1  ]: finished collecting timing info
15:26:01.409598 [debug] [Thread-9  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
15:26:01.414152 [debug] [Thread-10 ]: Writing injected SQL for node "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
15:26:01.414366 [debug] [Thread-3  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
15:26:01.414531 [debug] [Thread-2  ]: finished collecting timing info
15:26:01.414640 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
15:26:01.414834 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
15:26:01.415019 [debug] [Thread-8  ]: finished collecting timing info
15:26:01.415258 [debug] [Thread-6  ]: finished collecting timing info
15:26:01.415386 [debug] [Thread-7  ]: finished collecting timing info
15:26:01.415450 [debug] [Thread-5  ]: finished collecting timing info
15:26:01.416377 [debug] [Thread-3  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
15:26:01.416520 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
15:26:01.416584 [debug] [Thread-9  ]: finished collecting timing info
15:26:01.416637 [debug] [Thread-10 ]: finished collecting timing info
15:26:01.416704 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: BEGIN
15:26:01.417520 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
15:26:01.417625 [debug] [Thread-8  ]: Began executing node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
15:26:01.417820 [debug] [Thread-6  ]: Compilation Error in test positive_wins_losses_total_losses (models/schema.yml)
  'test_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:26:01.418001 [debug] [Thread-7  ]: Compilation Error in test positive_wins_losses_total_wins (models/schema.yml)
  'test_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:26:01.418088 [debug] [Thread-5  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
15:26:01.419140 [debug] [Thread-2  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
15:26:01.419359 [debug] [Thread-9  ]: Began executing node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
15:26:01.419471 [debug] [Thread-10 ]: Began executing node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
15:26:01.419568 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
15:26:01.419634 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:26:01.420567 [debug] [Thread-8  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
15:26:01.420771 [error] [Thread-6  ]: 6 of 10 ERROR positive_wins_losses_total_losses ................................ [[31mERROR[0m in 0.03s]
15:26:01.420890 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
15:26:01.420984 [error] [Thread-7  ]: 7 of 10 ERROR positive_wins_losses_total_wins .................................. [[31mERROR[0m in 0.03s]
15:26:01.421842 [debug] [Thread-5  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
15:26:01.423349 [debug] [Thread-9  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
15:26:01.445968 [debug] [Thread-10 ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
15:26:01.446094 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
15:26:01.446195 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: BEGIN
15:26:01.446552 [debug] [Thread-6  ]: Finished running node test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741
15:26:01.446643 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
15:26:01.446805 [debug] [Thread-7  ]: Finished running node test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6
15:26:01.446872 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
15:26:01.447181 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
15:26:01.447263 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
15:26:01.447354 [debug] [Thread-10 ]: Using postgres connection "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
15:26:01.447417 [debug] [Thread-3  ]: Opening a new connection, currently in state init
15:26:01.447479 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
15:26:01.447635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:26:01.447764 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
15:26:01.447837 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:26:01.447903 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: BEGIN
15:26:01.447965 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: BEGIN
15:26:01.448090 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
15:26:01.448226 [debug] [Thread-8  ]: Opening a new connection, currently in state init
15:26:01.448351 [debug] [Thread-5  ]: Opening a new connection, currently in state init
15:26:01.448413 [debug] [Thread-10 ]: Opening a new connection, currently in state init
15:26:01.448477 [debug] [Thread-9  ]: Opening a new connection, currently in state init
15:26:01.648537 [debug] [Thread-3  ]: SQL status: BEGIN in 0.2 seconds
15:26:01.649715 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
15:26:01.650039 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gameid
from "postgres"."public"."wins_losses"
where gameid is null



      
    ) dbt_internal_test
15:26:01.653991 [debug] [Thread-4  ]: SQL status: BEGIN in 0.23 seconds
15:26:01.654734 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
15:26:01.655026 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from "postgres"."public"."wins_losses"
where player_id is null



      
    ) dbt_internal_test
15:26:01.666916 [debug] [Thread-8  ]: SQL status: BEGIN in 0.22 seconds
15:26:01.667405 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
15:26:01.667605 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
15:26:01.670006 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.02 seconds
15:26:01.674044 [debug] [Thread-3  ]: finished collecting timing info
15:26:01.674662 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: ROLLBACK
15:26:01.675725 [debug] [Thread-5  ]: SQL status: BEGIN in 0.23 seconds
15:26:01.675940 [debug] [Thread-2  ]: SQL status: BEGIN in 0.23 seconds
15:26:01.676088 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.02 seconds
15:26:01.676207 [debug] [Thread-9  ]: SQL status: BEGIN in 0.23 seconds
15:26:01.676318 [debug] [Thread-1  ]: SQL status: BEGIN in 0.23 seconds
15:26:01.676542 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
15:26:01.676674 [debug] [Thread-10 ]: SQL status: BEGIN in 0.23 seconds
15:26:01.676877 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
15:26:01.678731 [debug] [Thread-4  ]: finished collecting timing info
15:26:01.679051 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
15:26:01.679289 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
15:26:01.679533 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seasonid
from "postgres"."public"."wins_losses"
where seasonid is null



      
    ) dbt_internal_test
15:26:01.679742 [debug] [Thread-10 ]: Using postgres connection "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
15:26:01.679928 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
15:26:01.680147 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: ROLLBACK
15:26:01.680367 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
15:26:01.680602 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
15:26:01.680931 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    seasonid as unique_field,
    count(*) as n_records

from "postgres"."public"."wins_losses"
where seasonid is not null
group by seasonid
having count(*) > 1



      
    ) dbt_internal_test
15:26:01.686952 [debug] [Thread-8  ]: SQL status: SELECT 1 in 0.02 seconds
15:26:01.688996 [debug] [Thread-8  ]: finished collecting timing info
15:26:01.689517 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
15:26:01.695488 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: Close
15:26:01.696472 [info ] [Thread-3  ]: 3 of 10 PASS not_null_wins_losses_gameid ....................................... [[32mPASS[0m in 0.33s]
15:26:01.697137 [debug] [Thread-3  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
15:26:01.698895 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: Close
15:26:01.699770 [info ] [Thread-4  ]: 4 of 10 PASS not_null_wins_losses_player_id .................................... [[32mPASS[0m in 0.33s]
15:26:01.699960 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.02 seconds
15:26:01.700626 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
15:26:01.702656 [debug] [Thread-5  ]: finished collecting timing info
15:26:01.702850 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.02 seconds
15:26:01.703482 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: ROLLBACK
15:26:01.703732 [debug] [Thread-9  ]: SQL status: SELECT 1 in 0.02 seconds
15:26:01.703866 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
15:26:01.703980 [debug] [Thread-10 ]: SQL status: SELECT 1 in 0.02 seconds
15:26:01.705810 [debug] [Thread-2  ]: finished collecting timing info
15:26:01.708689 [debug] [Thread-9  ]: finished collecting timing info
15:26:01.709776 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: Close
15:26:01.711629 [debug] [Thread-1  ]: finished collecting timing info
15:26:01.716566 [debug] [Thread-10 ]: finished collecting timing info
15:26:01.716977 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
15:26:01.717273 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
15:26:01.717459 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
15:26:01.717676 [info ] [Thread-8  ]: 8 of 10 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 0.33s]
15:26:01.717792 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: ROLLBACK
15:26:01.718342 [debug] [Thread-8  ]: Finished running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
15:26:01.725430 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: Close
15:26:01.727309 [info ] [Thread-5  ]: 5 of 10 PASS not_null_wins_losses_seasonid ..................................... [[32mPASS[0m in 0.34s]
15:26:01.728170 [debug] [Thread-5  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
15:26:01.735692 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
15:26:01.735819 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: Close
15:26:01.736228 [info ] [Thread-2  ]: 2 of 10 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.35s]
15:26:01.736460 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
15:26:01.736658 [error] [Thread-10 ]: 10 of 10 FAIL 15 unique_wins_losses_seasonid ................................... [[31mFAIL 15[0m in 0.35s]
15:26:01.736816 [debug] [Thread-10 ]: Finished running node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
15:26:01.737339 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
15:26:01.738770 [info ] [Thread-9  ]: 9 of 10 PASS unique_my_second_dbt_model_id ..................................... [[32mPASS[0m in 0.35s]
15:26:01.739715 [debug] [Thread-9  ]: Finished running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
15:26:01.739968 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
15:26:01.740982 [info ] [Thread-1  ]: 1 of 10 PASS not_null_my_first_dbt_model_id .................................... [[32mPASS[0m in 0.37s]
15:26:01.741382 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
15:26:01.742203 [debug] [MainThread]: Acquiring new postgres connection "master"
15:26:01.742366 [debug] [MainThread]: Using postgres connection "master"
15:26:01.742430 [debug] [MainThread]: On master: BEGIN
15:26:01.742483 [debug] [MainThread]: Opening a new connection, currently in state closed
15:26:01.926302 [debug] [MainThread]: SQL status: BEGIN in 0.18 seconds
15:26:01.927980 [debug] [MainThread]: On master: COMMIT
15:26:01.928384 [debug] [MainThread]: Using postgres connection "master"
15:26:01.929264 [debug] [MainThread]: On master: COMMIT
15:26:01.947970 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
15:26:01.948702 [debug] [MainThread]: On master: Close
15:26:01.950358 [info ] [MainThread]: 
15:26:01.950898 [info ] [MainThread]: Finished running 10 tests in 1.41s.
15:26:01.951209 [debug] [MainThread]: Connection 'master' was properly closed.
15:26:01.951364 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
15:26:01.951518 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1' was properly closed.
15:26:01.951664 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15' was properly closed.
15:26:01.951820 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
15:26:01.951962 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813' was properly closed.
15:26:01.952105 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
15:26:01.952247 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
15:26:01.952393 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741' was properly closed.
15:26:01.952537 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6' was properly closed.
15:26:01.952680 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb' was properly closed.
15:26:01.975444 [info ] [MainThread]: 
15:26:01.976237 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
15:26:01.976708 [info ] [MainThread]: 
15:26:01.977051 [error] [MainThread]: [33mCompilation Error in test positive_wins_losses_total_losses (models/schema.yml)[0m
15:26:01.977520 [error] [MainThread]:   'test_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:26:01.977856 [info ] [MainThread]: 
15:26:01.979731 [error] [MainThread]: [33mCompilation Error in test positive_wins_losses_total_wins (models/schema.yml)[0m
15:26:01.980080 [error] [MainThread]:   'test_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
15:26:01.980721 [info ] [MainThread]: 
15:26:01.981208 [error] [MainThread]: [31mFailure in test unique_wins_losses_seasonid (models/schema.yml)[0m
15:26:01.981599 [error] [MainThread]:   Got 15 results, configured to fail if != 0
15:26:01.981956 [info ] [MainThread]: 
15:26:01.982258 [info ] [MainThread]:   compiled SQL at target/compiled/wrkplay_dbt/models/schema.yml/unique_wins_losses_seasonid.sql
15:26:01.983203 [info ] [MainThread]: 
15:26:01.983524 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
15:26:01.984137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214195e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121419d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12119f580>]}


============================== 2022-07-08 15:28:27.156884 | 57706dac-d331-49bd-83b8-ae32e839e3a1 ==============================
15:28:27.156920 [info ] [MainThread]: Running with dbt=1.1.1
15:28:27.159450 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:28:27.159614 [debug] [MainThread]: Tracking: tracking
15:28:27.178752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b1ca0>]}
15:28:27.195727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:28:27.195836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:28:27.199108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57706dac-d331-49bd-83b8-ae32e839e3a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108888f70>]}
15:28:27.201795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57706dac-d331-49bd-83b8-ae32e839e3a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ef430>]}
15:28:27.201931 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:28:27.202055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57706dac-d331-49bd-83b8-ae32e839e3a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ef550>]}
15:28:27.202748 [info ] [MainThread]: 
15:28:27.202953 [debug] [MainThread]: Acquiring new postgres connection "master"
15:28:27.203355 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
15:28:27.207953 [debug] [ThreadPool]: Using postgres connection "list_postgres"
15:28:27.208117 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
15:28:27.208184 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:28:27.439832 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.23 seconds
15:28:27.445676 [debug] [ThreadPool]: On list_postgres: Close
15:28:27.448146 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
15:28:27.451727 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
15:28:27.451825 [debug] [ThreadPool]: On list_postgres_public: BEGIN
15:28:27.451884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:28:27.645285 [debug] [ThreadPool]: SQL status: BEGIN in 0.19 seconds
15:28:27.646223 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
15:28:27.646634 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:28:27.670044 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
15:28:27.674704 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
15:28:27.693321 [debug] [ThreadPool]: On list_postgres_public: Close
15:28:27.699037 [debug] [MainThread]: Using postgres connection "master"
15:28:27.699181 [debug] [MainThread]: On master: BEGIN
15:28:27.699242 [debug] [MainThread]: Opening a new connection, currently in state init
15:28:27.904838 [debug] [MainThread]: SQL status: BEGIN in 0.21 seconds
15:28:27.906231 [debug] [MainThread]: Using postgres connection "master"
15:28:27.906591 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:28:28.077845 [debug] [MainThread]: SQL status: SELECT 1 in 0.17 seconds
15:28:28.081460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57706dac-d331-49bd-83b8-ae32e839e3a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a0760>]}
15:28:28.082096 [debug] [MainThread]: On master: ROLLBACK
15:28:28.102158 [debug] [MainThread]: Using postgres connection "master"
15:28:28.103003 [debug] [MainThread]: On master: BEGIN
15:28:28.143775 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
15:28:28.144702 [debug] [MainThread]: On master: COMMIT
15:28:28.145097 [debug] [MainThread]: Using postgres connection "master"
15:28:28.145426 [debug] [MainThread]: On master: COMMIT
15:28:28.166296 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
15:28:28.167134 [debug] [MainThread]: On master: Close
15:28:28.168723 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:28:28.169470 [info ] [MainThread]: 
15:28:28.175987 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.my_first_dbt_model
15:28:28.176229 [info ] [Thread-1  ]: 1 of 3 START view model public.my_first_dbt_model .............................. [RUN]
15:28:28.176522 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:28:28.176601 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.my_first_dbt_model
15:28:28.176702 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.my_first_dbt_model
15:28:28.178029 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.my_first_dbt_model"
15:28:28.178132 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
15:28:28.178253 [info ] [Thread-2  ]: 2 of 3 START table model public.wins_losses .................................... [RUN]
15:28:28.178439 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
15:28:28.178523 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
15:28:28.178587 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
15:28:28.178641 [debug] [Thread-1  ]: finished collecting timing info
15:28:28.179855 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
15:28:28.179967 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.my_first_dbt_model
15:28:28.190453 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_first_dbt_model"
15:28:28.190659 [debug] [Thread-2  ]: finished collecting timing info
15:28:28.190747 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
15:28:28.200699 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
15:28:28.200813 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:28:28.200908 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: BEGIN
15:28:28.200969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:28:28.201126 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:28:28.201191 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: BEGIN
15:28:28.201244 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:28:28.387803 [debug] [Thread-2  ]: SQL status: BEGIN in 0.19 seconds
15:28:28.388314 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:28:28.388404 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */


  create  table "postgres"."public"."wins_losses__dbt_tmp"
  as (
    

--number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
15:28:28.408389 [debug] [Thread-1  ]: SQL status: BEGIN in 0.21 seconds
15:28:28.408704 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:28:28.408777 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */

  create view "postgres"."public"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
15:28:28.434110 [debug] [Thread-2  ]: SQL status: SELECT 190 in 0.05 seconds
15:28:28.434391 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
15:28:28.441345 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:28:28.442823 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:28:28.442914 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses" rename to "wins_losses__dbt_backup"
15:28:28.442979 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:28:28.462600 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
15:28:28.467481 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:28:28.467603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
15:28:28.467714 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
15:28:28.468846 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:28:28.468959 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:28:28.488604 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
15:28:28.494900 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
15:28:28.498837 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
15:28:28.499555 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
15:28:28.499642 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:28:28.499709 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:28:28.499766 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
15:28:28.499822 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
15:28:28.518960 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
15:28:28.526471 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:28:28.526586 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
15:28:28.526680 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop table if exists "postgres"."public"."wins_losses__dbt_backup" cascade
15:28:28.527468 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:28:28.527575 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
drop view if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
15:28:28.549260 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
15:28:28.551270 [debug] [Thread-1  ]: finished collecting timing info
15:28:28.551640 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: Close
15:28:28.552027 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.02 seconds
15:28:28.553452 [debug] [Thread-2  ]: finished collecting timing info
15:28:28.553805 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: Close
15:28:28.554447 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57706dac-d331-49bd-83b8-ae32e839e3a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896e9d0>]}
15:28:28.554647 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57706dac-d331-49bd-83b8-ae32e839e3a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896e250>]}
15:28:28.554879 [info ] [Thread-1  ]: 1 of 3 OK created view model public.my_first_dbt_model ......................... [[32mCREATE VIEW[0m in 0.38s]
15:28:28.555028 [info ] [Thread-2  ]: 2 of 3 OK created table model public.wins_losses ............................... [[32mSELECT 190[0m in 0.38s]
15:28:28.555230 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.my_first_dbt_model
15:28:28.555371 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
15:28:28.555606 [debug] [Thread-4  ]: Began running node model.wrkplay_dbt.my_second_dbt_model
15:28:28.555741 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:28:28.555917 [debug] [Thread-4  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:28:28.555980 [debug] [Thread-4  ]: Began compiling node model.wrkplay_dbt.my_second_dbt_model
15:28:28.556063 [debug] [Thread-4  ]: Compiling model.wrkplay_dbt.my_second_dbt_model
15:28:28.557184 [debug] [Thread-4  ]: Writing injected SQL for node "model.wrkplay_dbt.my_second_dbt_model"
15:28:28.557520 [debug] [Thread-4  ]: finished collecting timing info
15:28:28.557592 [debug] [Thread-4  ]: Began executing node model.wrkplay_dbt.my_second_dbt_model
15:28:28.558868 [debug] [Thread-4  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_second_dbt_model"
15:28:28.559113 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:28:28.559174 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: BEGIN
15:28:28.559226 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:28:28.749744 [debug] [Thread-4  ]: SQL status: BEGIN in 0.19 seconds
15:28:28.750782 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:28:28.751022 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
15:28:28.773475 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.02 seconds
15:28:28.779167 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:28:28.779363 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:28:28.800079 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.02 seconds
15:28:28.805168 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
15:28:28.805720 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:28:28.806075 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
15:28:28.824824 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
15:28:28.829437 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:28:28.830046 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
15:28:28.850615 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
15:28:28.854414 [debug] [Thread-4  ]: finished collecting timing info
15:28:28.854969 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: Close
15:28:28.856619 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57706dac-d331-49bd-83b8-ae32e839e3a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089aacd0>]}
15:28:28.857339 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.30s]
15:28:28.858082 [debug] [Thread-4  ]: Finished running node model.wrkplay_dbt.my_second_dbt_model
15:28:28.859325 [debug] [MainThread]: Acquiring new postgres connection "master"
15:28:28.859468 [debug] [MainThread]: Using postgres connection "master"
15:28:28.859530 [debug] [MainThread]: On master: BEGIN
15:28:28.859586 [debug] [MainThread]: Opening a new connection, currently in state closed
15:28:29.046432 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
15:28:29.047939 [debug] [MainThread]: On master: COMMIT
15:28:29.048239 [debug] [MainThread]: Using postgres connection "master"
15:28:29.048451 [debug] [MainThread]: On master: COMMIT
15:28:29.073590 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
15:28:29.074190 [debug] [MainThread]: On master: Close
15:28:29.075890 [info ] [MainThread]: 
15:28:29.076519 [info ] [MainThread]: Finished running 2 view models, 1 table model in 1.87s.
15:28:29.076868 [debug] [MainThread]: Connection 'master' was properly closed.
15:28:29.077023 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_first_dbt_model' was properly closed.
15:28:29.077169 [debug] [MainThread]: Connection 'model.wrkplay_dbt.wins_losses' was properly closed.
15:28:29.077309 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_second_dbt_model' was properly closed.
15:28:29.080978 [info ] [MainThread]: 
15:28:29.081192 [info ] [MainThread]: [32mCompleted successfully[0m
15:28:29.081323 [info ] [MainThread]: 
15:28:29.081418 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
15:28:29.081585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ef550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ef1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f4f40>]}


============================== 2022-07-08 15:29:25.882004 | e59d41be-104b-4649-b36f-38b582ed2bb9 ==============================
15:29:25.882046 [info ] [MainThread]: Running with dbt=1.1.1
15:29:25.882597 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:29:25.882679 [debug] [MainThread]: Tracking: tracking
15:29:25.900512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477abb0>]}
15:29:25.917818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:29:25.918058 [debug] [MainThread]: Partial parsing: updated file: wrkplay_dbt://models/wins_losses.sql
15:29:25.924199 [debug] [MainThread]: 1699: static parser successfully parsed wins_losses.sql
15:29:25.953304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e59d41be-104b-4649-b36f-38b582ed2bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049bfd30>]}
15:29:25.956356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e59d41be-104b-4649-b36f-38b582ed2bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ee190>]}
15:29:25.956498 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:29:25.956628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e59d41be-104b-4649-b36f-38b582ed2bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ee400>]}
15:29:25.957348 [info ] [MainThread]: 
15:29:25.957572 [debug] [MainThread]: Acquiring new postgres connection "master"
15:29:25.957984 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
15:29:25.962295 [debug] [ThreadPool]: Using postgres connection "list_postgres"
15:29:25.962371 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
15:29:25.962432 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:29:26.182995 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.22 seconds
15:29:26.184597 [debug] [ThreadPool]: On list_postgres: Close
15:29:26.186028 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
15:29:26.189270 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
15:29:26.204703 [debug] [ThreadPool]: On list_postgres_public: BEGIN
15:29:26.204768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:29:26.398375 [debug] [ThreadPool]: SQL status: BEGIN in 0.19 seconds
15:29:26.399326 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
15:29:26.399811 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:29:26.424228 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
15:29:26.430521 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
15:29:26.450194 [debug] [ThreadPool]: On list_postgres_public: Close
15:29:26.455493 [debug] [MainThread]: Using postgres connection "master"
15:29:26.455621 [debug] [MainThread]: On master: BEGIN
15:29:26.455678 [debug] [MainThread]: Opening a new connection, currently in state init
15:29:26.640561 [debug] [MainThread]: SQL status: BEGIN in 0.18 seconds
15:29:26.642020 [debug] [MainThread]: Using postgres connection "master"
15:29:26.642436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:29:26.810232 [debug] [MainThread]: SQL status: SELECT 1 in 0.17 seconds
15:29:26.813255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e59d41be-104b-4649-b36f-38b582ed2bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ee310>]}
15:29:26.813762 [debug] [MainThread]: On master: ROLLBACK
15:29:26.831780 [debug] [MainThread]: Using postgres connection "master"
15:29:26.832268 [debug] [MainThread]: On master: BEGIN
15:29:26.868605 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
15:29:26.869190 [debug] [MainThread]: On master: COMMIT
15:29:26.869559 [debug] [MainThread]: Using postgres connection "master"
15:29:26.869894 [debug] [MainThread]: On master: COMMIT
15:29:26.888015 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
15:29:26.888865 [debug] [MainThread]: On master: Close
15:29:26.891040 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:29:26.891677 [info ] [MainThread]: 
15:29:26.897544 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.my_first_dbt_model
15:29:26.897755 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
15:29:26.897934 [info ] [Thread-1  ]: 1 of 3 START view model public.my_first_dbt_model .............................. [RUN]
15:29:26.898055 [info ] [Thread-2  ]: 2 of 3 START view model public.wins_losses ..................................... [RUN]
15:29:26.898333 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:29:26.898508 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
15:29:26.898583 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.my_first_dbt_model
15:29:26.898649 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
15:29:26.898743 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.my_first_dbt_model
15:29:26.898798 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
15:29:26.900582 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.my_first_dbt_model"
15:29:26.901775 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
15:29:26.902275 [debug] [Thread-1  ]: finished collecting timing info
15:29:26.902363 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.my_first_dbt_model
15:29:26.908703 [debug] [Thread-2  ]: finished collecting timing info
15:29:26.912886 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_first_dbt_model"
15:29:26.912997 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
15:29:26.914203 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
15:29:26.914434 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:29:26.914515 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: BEGIN
15:29:26.914572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:29:26.914721 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:29:26.914785 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: BEGIN
15:29:26.914836 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:29:27.104442 [debug] [Thread-2  ]: SQL status: BEGIN in 0.19 seconds
15:29:27.105226 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
15:29:27.105982 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:29:27.106350 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:29:27.106726 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */

  create view "postgres"."public"."wins_losses__dbt_tmp" as (
    

--number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
15:29:27.107060 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */

  create view "postgres"."public"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
15:29:27.129095 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
15:29:27.137831 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:29:27.137971 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.03 seconds
15:29:27.138124 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:29:27.159129 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:29:27.159338 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses" rename to "wins_losses__dbt_backup"
15:29:27.178420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
15:29:27.179434 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:29:27.179505 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:29:27.179583 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
15:29:27.180521 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:29:27.180590 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
15:29:27.197692 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
15:29:27.200648 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
15:29:27.200721 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:29:27.200777 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
15:29:27.201468 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
15:29:27.201974 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
15:29:27.202036 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:29:27.202088 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
15:29:27.219653 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
15:29:27.221657 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:29:27.221728 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
drop view if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
15:29:27.231955 [debug] [Thread-2  ]: SQL status: COMMIT in 0.03 seconds
15:29:27.232614 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:29:27.232677 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop table if exists "postgres"."public"."wins_losses__dbt_backup" cascade
15:29:27.246160 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
15:29:27.246633 [debug] [Thread-1  ]: finished collecting timing info
15:29:27.246709 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: Close
15:29:27.246943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e59d41be-104b-4649-b36f-38b582ed2bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a96790>]}
15:29:27.247086 [info ] [Thread-1  ]: 1 of 3 OK created view model public.my_first_dbt_model ......................... [[32mCREATE VIEW[0m in 0.35s]
15:29:27.247268 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.my_first_dbt_model
15:29:27.247421 [debug] [Thread-4  ]: Began running node model.wrkplay_dbt.my_second_dbt_model
15:29:27.247517 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:29:27.247680 [debug] [Thread-4  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:29:27.247739 [debug] [Thread-4  ]: Began compiling node model.wrkplay_dbt.my_second_dbt_model
15:29:27.247797 [debug] [Thread-4  ]: Compiling model.wrkplay_dbt.my_second_dbt_model
15:29:27.248746 [debug] [Thread-4  ]: Writing injected SQL for node "model.wrkplay_dbt.my_second_dbt_model"
15:29:27.249062 [debug] [Thread-4  ]: finished collecting timing info
15:29:27.249125 [debug] [Thread-4  ]: Began executing node model.wrkplay_dbt.my_second_dbt_model
15:29:27.250209 [debug] [Thread-4  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_second_dbt_model"
15:29:27.250393 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:29:27.250455 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: BEGIN
15:29:27.250506 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:29:27.254881 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.02 seconds
15:29:27.255340 [debug] [Thread-2  ]: finished collecting timing info
15:29:27.255411 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: Close
15:29:27.255617 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e59d41be-104b-4649-b36f-38b582ed2bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac4c10>]}
15:29:27.255740 [info ] [Thread-2  ]: 2 of 3 OK created view model public.wins_losses ................................ [[32mCREATE VIEW[0m in 0.36s]
15:29:27.255897 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
15:29:27.447306 [debug] [Thread-4  ]: SQL status: BEGIN in 0.2 seconds
15:29:27.448318 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:29:27.448841 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
15:29:27.472252 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.02 seconds
15:29:27.478821 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:29:27.478997 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:29:27.501834 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.02 seconds
15:29:27.506056 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
15:29:27.506583 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:29:27.506778 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
15:29:27.527833 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
15:29:27.531962 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:29:27.532234 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
15:29:27.551406 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
15:29:27.555082 [debug] [Thread-4  ]: finished collecting timing info
15:29:27.555567 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: Close
15:29:27.556694 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e59d41be-104b-4649-b36f-38b582ed2bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac4f40>]}
15:29:27.557058 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.31s]
15:29:27.557331 [debug] [Thread-4  ]: Finished running node model.wrkplay_dbt.my_second_dbt_model
15:29:27.559027 [debug] [MainThread]: Acquiring new postgres connection "master"
15:29:27.559465 [debug] [MainThread]: Using postgres connection "master"
15:29:27.559651 [debug] [MainThread]: On master: BEGIN
15:29:27.559815 [debug] [MainThread]: Opening a new connection, currently in state closed
15:29:27.758663 [debug] [MainThread]: SQL status: BEGIN in 0.2 seconds
15:29:27.759625 [debug] [MainThread]: On master: COMMIT
15:29:27.760075 [debug] [MainThread]: Using postgres connection "master"
15:29:27.760412 [debug] [MainThread]: On master: COMMIT
15:29:27.780594 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
15:29:27.781286 [debug] [MainThread]: On master: Close
15:29:27.782658 [info ] [MainThread]: 
15:29:27.783271 [info ] [MainThread]: Finished running 3 view models in 1.82s.
15:29:27.783596 [debug] [MainThread]: Connection 'master' was properly closed.
15:29:27.783758 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_first_dbt_model' was properly closed.
15:29:27.783924 [debug] [MainThread]: Connection 'model.wrkplay_dbt.wins_losses' was properly closed.
15:29:27.784070 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_second_dbt_model' was properly closed.
15:29:27.788961 [info ] [MainThread]: 
15:29:27.789176 [info ] [MainThread]: [32mCompleted successfully[0m
15:29:27.789299 [info ] [MainThread]: 
15:29:27.789392 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
15:29:27.789554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a96790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac4f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a02fa0>]}


============================== 2022-07-08 15:34:00.284325 | 3edba8d5-08ab-4473-9a27-dfb95e24bc3f ==============================
15:34:00.284357 [info ] [MainThread]: Running with dbt=1.1.1
15:34:00.285250 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:34:00.285342 [debug] [MainThread]: Tracking: tracking
15:34:00.309701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529dc10>]}
15:34:00.330251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:34:00.330637 [debug] [MainThread]: Partial parsing: updated file: wrkplay_dbt://models/wins_losses.sql
15:34:00.337777 [debug] [MainThread]: 1699: static parser successfully parsed wins_losses.sql
15:34:00.368902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3edba8d5-08ab-4473-9a27-dfb95e24bc3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055efdc0>]}
15:34:00.390455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3edba8d5-08ab-4473-9a27-dfb95e24bc3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551d220>]}
15:34:00.390678 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:34:00.390817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3edba8d5-08ab-4473-9a27-dfb95e24bc3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554cf70>]}
15:34:00.391637 [info ] [MainThread]: 
15:34:00.391882 [debug] [MainThread]: Acquiring new postgres connection "master"
15:34:00.392354 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
15:34:00.396946 [debug] [ThreadPool]: Using postgres connection "list_postgres"
15:34:00.397036 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
15:34:00.397101 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:34:01.117588 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.72 seconds
15:34:01.121652 [debug] [ThreadPool]: On list_postgres: Close
15:34:01.123110 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
15:34:01.126505 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
15:34:01.126611 [debug] [ThreadPool]: On list_postgres_public: BEGIN
15:34:01.126671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:34:01.681733 [debug] [ThreadPool]: SQL status: BEGIN in 0.55 seconds
15:34:01.682789 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
15:34:01.683172 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:34:01.706427 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
15:34:01.710344 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
15:34:01.728162 [debug] [ThreadPool]: On list_postgres_public: Close
15:34:01.735823 [debug] [MainThread]: Using postgres connection "master"
15:34:01.735948 [debug] [MainThread]: On master: BEGIN
15:34:01.736008 [debug] [MainThread]: Opening a new connection, currently in state init
15:34:02.128920 [debug] [MainThread]: SQL status: BEGIN in 0.39 seconds
15:34:02.130336 [debug] [MainThread]: Using postgres connection "master"
15:34:02.130777 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:34:02.300479 [debug] [MainThread]: SQL status: SELECT 4 in 0.17 seconds
15:34:02.303180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3edba8d5-08ab-4473-9a27-dfb95e24bc3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105550ee0>]}
15:34:02.303960 [debug] [MainThread]: On master: ROLLBACK
15:34:02.565811 [debug] [MainThread]: Using postgres connection "master"
15:34:02.567435 [debug] [MainThread]: On master: BEGIN
15:34:02.604661 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
15:34:02.605601 [debug] [MainThread]: On master: COMMIT
15:34:02.605801 [debug] [MainThread]: Using postgres connection "master"
15:34:02.605974 [debug] [MainThread]: On master: COMMIT
15:34:02.623913 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
15:34:02.624730 [debug] [MainThread]: On master: Close
15:34:02.626791 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:34:02.627747 [info ] [MainThread]: 
15:34:02.632301 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.my_first_dbt_model
15:34:02.632391 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
15:34:02.632604 [info ] [Thread-1  ]: 1 of 3 START view model public.my_first_dbt_model .............................. [RUN]
15:34:02.632729 [info ] [Thread-2  ]: 2 of 3 START view model public.wins_losses ..................................... [RUN]
15:34:02.632987 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:34:02.633159 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
15:34:02.633238 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.my_first_dbt_model
15:34:02.633303 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
15:34:02.633398 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.my_first_dbt_model
15:34:02.633458 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
15:34:02.635023 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.my_first_dbt_model"
15:34:02.635651 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
15:34:02.636324 [debug] [Thread-1  ]: finished collecting timing info
15:34:02.636396 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.my_first_dbt_model
15:34:02.646899 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_first_dbt_model"
15:34:02.647072 [debug] [Thread-2  ]: finished collecting timing info
15:34:02.647145 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
15:34:02.648257 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
15:34:02.648438 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:34:02.648505 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: BEGIN
15:34:02.648561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:34:02.648753 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:34:02.648816 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: BEGIN
15:34:02.648867 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:34:02.864359 [debug] [Thread-2  ]: SQL status: BEGIN in 0.22 seconds
15:34:02.865542 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:34:02.865836 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */

  create view "postgres"."public"."wins_losses__dbt_tmp" as (
    --number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
15:34:02.901278 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.04 seconds
15:34:02.909350 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:34:02.909500 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses" rename to "wins_losses__dbt_backup"
15:34:02.914259 [debug] [Thread-1  ]: SQL status: BEGIN in 0.27 seconds
15:34:02.914319 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:34:02.914369 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */

  create view "postgres"."public"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
15:34:02.928524 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
15:34:02.953219 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:34:02.953374 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
15:34:03.092029 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.18 seconds
15:34:03.097428 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:34:03.097556 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:34:03.123164 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.17 seconds
15:34:03.130918 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
15:34:03.131022 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:34:03.131083 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
15:34:03.140431 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.04 seconds
15:34:03.142592 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:34:03.142697 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:34:03.150535 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
15:34:03.156659 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
15:34:03.156769 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop view if exists "postgres"."public"."wins_losses__dbt_backup" cascade
15:34:03.164304 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
15:34:03.167713 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
15:34:03.168475 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:34:03.168661 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
15:34:03.178473 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
15:34:03.182111 [debug] [Thread-2  ]: finished collecting timing info
15:34:03.182601 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: Close
15:34:03.183649 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edba8d5-08ab-4473-9a27-dfb95e24bc3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057fb490>]}
15:34:03.183917 [info ] [Thread-2  ]: 2 of 3 OK created view model public.wins_losses ................................ [[32mCREATE VIEW[0m in 0.55s]
15:34:03.184178 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
15:34:03.187700 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
15:34:03.188576 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
15:34:03.188640 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
drop view if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
15:34:03.212603 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
15:34:03.215495 [debug] [Thread-1  ]: finished collecting timing info
15:34:03.215849 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: Close
15:34:03.216602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edba8d5-08ab-4473-9a27-dfb95e24bc3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c3790>]}
15:34:03.216772 [info ] [Thread-1  ]: 1 of 3 OK created view model public.my_first_dbt_model ......................... [[32mCREATE VIEW[0m in 0.58s]
15:34:03.216947 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.my_first_dbt_model
15:34:03.217202 [debug] [Thread-4  ]: Began running node model.wrkplay_dbt.my_second_dbt_model
15:34:03.217432 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:34:03.217682 [debug] [Thread-4  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:34:03.217746 [debug] [Thread-4  ]: Began compiling node model.wrkplay_dbt.my_second_dbt_model
15:34:03.217814 [debug] [Thread-4  ]: Compiling model.wrkplay_dbt.my_second_dbt_model
15:34:03.218987 [debug] [Thread-4  ]: Writing injected SQL for node "model.wrkplay_dbt.my_second_dbt_model"
15:34:03.219443 [debug] [Thread-4  ]: finished collecting timing info
15:34:03.219514 [debug] [Thread-4  ]: Began executing node model.wrkplay_dbt.my_second_dbt_model
15:34:03.220681 [debug] [Thread-4  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_second_dbt_model"
15:34:03.220899 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:34:03.220958 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: BEGIN
15:34:03.221013 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:34:03.706082 [debug] [Thread-4  ]: SQL status: BEGIN in 0.49 seconds
15:34:03.706741 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:34:03.707104 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
15:34:03.730195 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.02 seconds
15:34:03.733775 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:34:03.734081 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:34:03.754049 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.02 seconds
15:34:03.756120 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
15:34:03.756320 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:34:03.756488 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
15:34:03.799815 [debug] [Thread-4  ]: SQL status: COMMIT in 0.04 seconds
15:34:03.802516 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
15:34:03.802732 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
15:34:03.822542 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
15:34:03.824456 [debug] [Thread-4  ]: finished collecting timing info
15:34:03.824773 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: Close
15:34:03.825618 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edba8d5-08ab-4473-9a27-dfb95e24bc3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057fbd30>]}
15:34:03.826128 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.61s]
15:34:03.826631 [debug] [Thread-4  ]: Finished running node model.wrkplay_dbt.my_second_dbt_model
15:34:03.827471 [debug] [MainThread]: Acquiring new postgres connection "master"
15:34:03.827594 [debug] [MainThread]: Using postgres connection "master"
15:34:03.827659 [debug] [MainThread]: On master: BEGIN
15:34:03.827714 [debug] [MainThread]: Opening a new connection, currently in state closed
15:34:04.177898 [debug] [MainThread]: SQL status: BEGIN in 0.35 seconds
15:34:04.179173 [debug] [MainThread]: On master: COMMIT
15:34:04.179404 [debug] [MainThread]: Using postgres connection "master"
15:34:04.179628 [debug] [MainThread]: On master: COMMIT
15:34:04.206560 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
15:34:04.207849 [debug] [MainThread]: On master: Close
15:34:04.209687 [info ] [MainThread]: 
15:34:04.210353 [info ] [MainThread]: Finished running 3 view models in 3.82s.
15:34:04.210752 [debug] [MainThread]: Connection 'master' was properly closed.
15:34:04.210824 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_first_dbt_model' was properly closed.
15:34:04.210880 [debug] [MainThread]: Connection 'model.wrkplay_dbt.wins_losses' was properly closed.
15:34:04.210929 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_second_dbt_model' was properly closed.
15:34:04.214674 [info ] [MainThread]: 
15:34:04.214795 [info ] [MainThread]: [32mCompleted successfully[0m
15:34:04.214911 [info ] [MainThread]: 
15:34:04.215005 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
15:34:04.215156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105737e50>]}


============================== 2022-07-08 16:01:10.850144 | 0ca79c55-9be5-42f2-a2c7-cd11d6cb9d17 ==============================
16:01:10.850159 [info ] [MainThread]: Running with dbt=1.1.1
16:01:10.850857 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
16:01:10.850945 [debug] [MainThread]: Tracking: tracking
16:01:10.873845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104635b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104635c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104635ca0>]}
16:01:10.894194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:01:10.894354 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:01:10.898083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ca79c55-9be5-42f2-a2c7-cd11d6cb9d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480f0d0>]}
16:01:10.901403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ca79c55-9be5-42f2-a2c7-cd11d6cb9d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104760580>]}
16:01:10.901595 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:01:10.901743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ca79c55-9be5-42f2-a2c7-cd11d6cb9d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047606a0>]}
16:01:10.902679 [info ] [MainThread]: 
16:01:10.902955 [debug] [MainThread]: Acquiring new postgres connection "master"
16:01:10.903469 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
16:01:10.908234 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
16:01:10.908345 [debug] [ThreadPool]: On list_postgres_public: BEGIN
16:01:10.908452 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:01:11.371605 [debug] [ThreadPool]: SQL status: BEGIN in 0.46 seconds
16:01:11.373069 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
16:01:11.373451 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:01:11.395527 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
16:01:11.400237 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
16:01:11.505032 [debug] [ThreadPool]: On list_postgres_public: Close
16:01:11.512712 [debug] [MainThread]: Using postgres connection "master"
16:01:11.512850 [debug] [MainThread]: On master: BEGIN
16:01:11.512919 [debug] [MainThread]: Opening a new connection, currently in state init
16:01:11.982116 [debug] [MainThread]: SQL status: BEGIN in 0.47 seconds
16:01:11.982933 [debug] [MainThread]: Using postgres connection "master"
16:01:11.983440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:01:12.159748 [debug] [MainThread]: SQL status: SELECT 4 in 0.18 seconds
16:01:12.163932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ca79c55-9be5-42f2-a2c7-cd11d6cb9d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104760400>]}
16:01:12.164897 [debug] [MainThread]: On master: ROLLBACK
16:01:12.189596 [debug] [MainThread]: Using postgres connection "master"
16:01:12.190317 [debug] [MainThread]: On master: BEGIN
16:01:12.233351 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
16:01:12.233978 [debug] [MainThread]: On master: COMMIT
16:01:12.234165 [debug] [MainThread]: Using postgres connection "master"
16:01:12.234433 [debug] [MainThread]: On master: COMMIT
16:01:12.259674 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
16:01:12.260886 [debug] [MainThread]: On master: Close
16:01:12.262472 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:01:12.263033 [info ] [MainThread]: 
16:01:12.268360 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:01:12.268472 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:01:12.268543 [debug] [Thread-3  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:01:12.268604 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:01:12.268664 [debug] [Thread-5  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:01:12.268765 [debug] [Thread-6  ]: Began running node test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741
16:01:12.268827 [debug] [Thread-7  ]: Began running node test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6
16:01:12.268881 [debug] [Thread-8  ]: Began running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:01:12.268959 [info ] [Thread-1  ]: 1 of 10 START test not_null_my_first_dbt_model_id .............................. [RUN]
16:01:12.269025 [debug] [Thread-9  ]: Began running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:01:12.269075 [debug] [Thread-10 ]: Began running node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
16:01:12.269141 [info ] [Thread-2  ]: 2 of 10 START test not_null_my_second_dbt_model_id ............................. [RUN]
16:01:12.269223 [info ] [Thread-3  ]: 3 of 10 START test not_null_wins_losses_gameid ................................. [RUN]
16:01:12.269293 [info ] [Thread-4  ]: 4 of 10 START test not_null_wins_losses_player_id .............................. [RUN]
16:01:12.269368 [info ] [Thread-5  ]: 5 of 10 START test not_null_wins_losses_seasonid ............................... [RUN]
16:01:12.269432 [info ] [Thread-6  ]: 6 of 10 START test positive_wins_losses_total_losses ........................... [RUN]
16:01:12.269496 [info ] [Thread-7  ]: 7 of 10 START test positive_wins_losses_total_wins ............................. [RUN]
16:01:12.269561 [info ] [Thread-8  ]: 8 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
16:01:12.269823 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:01:12.269874 [info ] [Thread-9  ]: 9 of 10 START test unique_my_second_dbt_model_id ............................... [RUN]
16:01:12.269939 [info ] [Thread-10 ]: 10 of 10 START test unique_wins_losses_seasonid ................................ [RUN]
16:01:12.270125 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:01:12.270305 [debug] [Thread-3  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:01:12.270459 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:01:12.270621 [debug] [Thread-5  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:01:12.270772 [debug] [Thread-6  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741"
16:01:12.270924 [debug] [Thread-7  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6"
16:01:12.271083 [debug] [Thread-8  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:01:12.271144 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:01:12.271304 [debug] [Thread-9  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:01:12.271441 [debug] [Thread-10 ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
16:01:12.271497 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:01:12.271551 [debug] [Thread-3  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:01:12.271652 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:01:12.271706 [debug] [Thread-5  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:01:12.271760 [debug] [Thread-6  ]: Began compiling node test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741
16:01:12.271813 [debug] [Thread-7  ]: Began compiling node test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6
16:01:12.271867 [debug] [Thread-8  ]: Began compiling node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:01:12.271949 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:01:12.272001 [debug] [Thread-9  ]: Began compiling node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:01:12.272051 [debug] [Thread-10 ]: Began compiling node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
16:01:12.272101 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:01:12.272151 [debug] [Thread-3  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:01:12.272200 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:01:12.272250 [debug] [Thread-5  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:01:12.272299 [debug] [Thread-6  ]: Compiling test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741
16:01:12.272347 [debug] [Thread-7  ]: Compiling test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6
16:01:12.272396 [debug] [Thread-8  ]: Compiling test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:01:12.278319 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:01:12.278411 [debug] [Thread-9  ]: Compiling test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:01:12.278473 [debug] [Thread-10 ]: Compiling test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
16:01:12.279927 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:01:12.281355 [debug] [Thread-3  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:01:12.283216 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:01:12.284645 [debug] [Thread-5  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:01:12.290005 [debug] [Thread-8  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:01:12.291552 [debug] [Thread-9  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:01:12.293008 [debug] [Thread-10 ]: Writing injected SQL for node "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
16:01:12.293175 [debug] [Thread-1  ]: finished collecting timing info
16:01:12.293463 [debug] [Thread-6  ]: finished collecting timing info
16:01:12.293579 [debug] [Thread-7  ]: finished collecting timing info
16:01:12.293627 [debug] [Thread-2  ]: finished collecting timing info
16:01:12.293766 [debug] [Thread-4  ]: finished collecting timing info
16:01:12.293828 [debug] [Thread-3  ]: finished collecting timing info
16:01:12.293958 [debug] [Thread-5  ]: finished collecting timing info
16:01:12.294053 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:01:12.294196 [debug] [Thread-6  ]: Compilation Error in test positive_wins_losses_total_losses (models/schema.yml)
  'test_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
16:01:12.294270 [debug] [Thread-8  ]: finished collecting timing info
16:01:12.294413 [debug] [Thread-7  ]: Compilation Error in test positive_wins_losses_total_wins (models/schema.yml)
  'test_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
16:01:12.294494 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:01:12.294560 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:01:12.294620 [debug] [Thread-3  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:01:12.294678 [debug] [Thread-5  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:01:12.301164 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:01:12.301286 [error] [Thread-6  ]: 6 of 10 ERROR positive_wins_losses_total_losses ................................ [[31mERROR[0m in 0.03s]
16:01:12.301359 [debug] [Thread-10 ]: finished collecting timing info
16:01:12.301464 [debug] [Thread-8  ]: Began executing node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:01:12.301513 [debug] [Thread-9  ]: finished collecting timing info
16:01:12.301608 [error] [Thread-7  ]: 7 of 10 ERROR positive_wins_losses_total_wins .................................. [[31mERROR[0m in 0.03s]
16:01:12.302382 [debug] [Thread-2  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:01:12.303090 [debug] [Thread-4  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:01:12.303790 [debug] [Thread-3  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:01:12.304487 [debug] [Thread-5  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:01:12.304694 [debug] [Thread-6  ]: Finished running node test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741
16:01:12.304772 [debug] [Thread-10 ]: Began executing node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
16:01:12.305499 [debug] [Thread-8  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:01:12.305565 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:01:12.305629 [debug] [Thread-9  ]: Began executing node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:01:12.305768 [debug] [Thread-7  ]: Finished running node test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6
16:01:12.306046 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:01:12.306123 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:01:12.306301 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:01:12.307526 [debug] [Thread-10 ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
16:01:12.307596 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:01:12.307693 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
16:01:12.330084 [debug] [Thread-9  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:01:12.330216 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:01:12.330332 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
16:01:12.330435 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: BEGIN
16:01:12.330503 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: BEGIN
16:01:12.330605 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: BEGIN
16:01:12.330675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:01:12.330804 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
16:01:12.330863 [debug] [Thread-10 ]: Using postgres connection "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
16:01:12.330936 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:01:12.331005 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:01:12.331062 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:01:12.331123 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:01:12.331187 [debug] [Thread-5  ]: Opening a new connection, currently in state init
16:01:12.331367 [debug] [Thread-8  ]: Opening a new connection, currently in state init
16:01:12.331425 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: BEGIN
16:01:12.331626 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
16:01:12.331863 [debug] [Thread-10 ]: Opening a new connection, currently in state init
16:01:12.331922 [debug] [Thread-9  ]: Opening a new connection, currently in state init
16:01:12.728044 [debug] [Thread-9  ]: SQL status: BEGIN in 0.4 seconds
16:01:12.729626 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:01:12.730158 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
16:01:12.730476 [debug] [Thread-3  ]: SQL status: BEGIN in 0.4 seconds
16:01:12.730771 [debug] [Thread-4  ]: SQL status: BEGIN in 0.4 seconds
16:01:12.731056 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:01:12.731262 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:01:12.731449 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gameid
from "postgres"."public"."wins_losses"
where gameid is null



      
    ) dbt_internal_test
16:01:12.731636 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from "postgres"."public"."wins_losses"
where player_id is null



      
    ) dbt_internal_test
16:01:12.780836 [debug] [Thread-10 ]: SQL status: BEGIN in 0.45 seconds
16:01:12.781709 [debug] [Thread-10 ]: Using postgres connection "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
16:01:12.782188 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    seasonid as unique_field,
    count(*) as n_records

from "postgres"."public"."wins_losses"
where seasonid is not null
group by seasonid
having count(*) > 1



      
    ) dbt_internal_test
16:01:12.782867 [debug] [Thread-1  ]: SQL status: BEGIN in 0.45 seconds
16:01:12.783223 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:01:12.783531 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
16:01:12.787217 [debug] [Thread-8  ]: SQL status: BEGIN in 0.46 seconds
16:01:12.787391 [debug] [Thread-2  ]: SQL status: BEGIN in 0.46 seconds
16:01:12.787621 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:01:12.787851 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:01:12.788099 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
16:01:12.788354 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
16:01:12.823155 [debug] [Thread-5  ]: SQL status: BEGIN in 0.49 seconds
16:01:12.825036 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:01:12.825397 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seasonid
from "postgres"."public"."wins_losses"
where seasonid is null



      
    ) dbt_internal_test
16:01:12.825811 [debug] [Thread-9  ]: SQL status: SELECT 1 in 0.09 seconds
16:01:12.828782 [debug] [Thread-9  ]: finished collecting timing info
16:01:12.829028 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
16:01:12.838883 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.11 seconds
16:01:12.839237 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.11 seconds
16:01:12.841313 [debug] [Thread-3  ]: finished collecting timing info
16:01:12.841981 [debug] [Thread-4  ]: finished collecting timing info
16:01:12.842070 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: ROLLBACK
16:01:12.842147 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: ROLLBACK
16:01:12.854986 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.07 seconds
16:01:12.858557 [debug] [Thread-1  ]: finished collecting timing info
16:01:12.859048 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.07 seconds
16:01:12.859171 [debug] [Thread-8  ]: SQL status: SELECT 1 in 0.07 seconds
16:01:12.859258 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
16:01:12.859993 [debug] [Thread-2  ]: finished collecting timing info
16:01:12.860603 [debug] [Thread-8  ]: finished collecting timing info
16:01:12.860748 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
16:01:12.860834 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
16:01:12.861986 [debug] [Thread-10 ]: SQL status: SELECT 1 in 0.08 seconds
16:01:12.862541 [debug] [Thread-10 ]: finished collecting timing info
16:01:12.862611 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: ROLLBACK
16:01:12.876273 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
16:01:12.876595 [info ] [Thread-9  ]: 9 of 10 PASS unique_my_second_dbt_model_id ..................................... [[32mPASS[0m in 0.61s]
16:01:12.876845 [debug] [Thread-9  ]: Finished running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:01:12.884397 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: Close
16:01:12.884479 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: Close
16:01:12.884793 [info ] [Thread-3  ]: 3 of 10 PASS not_null_wins_losses_gameid ....................................... [[32mPASS[0m in 0.61s]
16:01:12.884981 [debug] [Thread-3  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:01:12.885434 [info ] [Thread-4  ]: 4 of 10 PASS not_null_wins_losses_player_id .................................... [[32mPASS[0m in 0.61s]
16:01:12.885999 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:01:12.887926 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.06 seconds
16:01:12.888820 [debug] [Thread-5  ]: finished collecting timing info
16:01:12.888929 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: ROLLBACK
16:01:12.902568 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: Close
16:01:12.903390 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
16:01:12.905080 [info ] [Thread-2  ]: 2 of 10 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.63s]
16:01:12.906256 [info ] [Thread-8  ]: 8 of 10 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 0.64s]
16:01:12.906389 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
16:01:12.906454 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: Close
16:01:12.906690 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:01:12.906823 [debug] [Thread-8  ]: Finished running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:01:12.907092 [info ] [Thread-1  ]: 1 of 10 PASS not_null_my_first_dbt_model_id .................................... [[32mPASS[0m in 0.64s]
16:01:12.907306 [error] [Thread-10 ]: 10 of 10 FAIL 15 unique_wins_losses_seasonid ................................... [[31mFAIL 15[0m in 0.64s]
16:01:12.907467 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:01:12.907601 [debug] [Thread-10 ]: Finished running node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
16:01:12.940973 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: Close
16:01:12.941445 [info ] [Thread-5  ]: 5 of 10 PASS not_null_wins_losses_seasonid ..................................... [[32mPASS[0m in 0.67s]
16:01:12.941646 [debug] [Thread-5  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:01:12.942485 [debug] [MainThread]: Acquiring new postgres connection "master"
16:01:12.942592 [debug] [MainThread]: Using postgres connection "master"
16:01:12.942650 [debug] [MainThread]: On master: BEGIN
16:01:12.942704 [debug] [MainThread]: Opening a new connection, currently in state closed
16:01:13.341256 [debug] [MainThread]: SQL status: BEGIN in 0.4 seconds
16:01:13.342918 [debug] [MainThread]: On master: COMMIT
16:01:13.343160 [debug] [MainThread]: Using postgres connection "master"
16:01:13.343383 [debug] [MainThread]: On master: COMMIT
16:01:13.388448 [debug] [MainThread]: SQL status: COMMIT in 0.04 seconds
16:01:13.389515 [debug] [MainThread]: On master: Close
16:01:13.391682 [info ] [MainThread]: 
16:01:13.392523 [info ] [MainThread]: Finished running 10 tests in 2.49s.
16:01:13.392886 [debug] [MainThread]: Connection 'master' was properly closed.
16:01:13.393074 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
16:01:13.393256 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
16:01:13.393428 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1' was properly closed.
16:01:13.393599 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15' was properly closed.
16:01:13.393769 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813' was properly closed.
16:01:13.393938 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_wins_losses_total_losses.159f570741' was properly closed.
16:01:13.394239 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_wins_losses_total_wins.1e3c0d0dd6' was properly closed.
16:01:13.394318 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
16:01:13.394370 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
16:01:13.394417 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb' was properly closed.
16:01:13.399726 [info ] [MainThread]: 
16:01:13.399852 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
16:01:13.399958 [info ] [MainThread]: 
16:01:13.400043 [error] [MainThread]: [33mCompilation Error in test positive_wins_losses_total_losses (models/schema.yml)[0m
16:01:13.400129 [error] [MainThread]:   'test_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
16:01:13.400210 [info ] [MainThread]: 
16:01:13.400294 [error] [MainThread]: [33mCompilation Error in test positive_wins_losses_total_wins (models/schema.yml)[0m
16:01:13.400372 [error] [MainThread]:   'test_positive' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
16:01:13.400450 [info ] [MainThread]: 
16:01:13.400530 [error] [MainThread]: [31mFailure in test unique_wins_losses_seasonid (models/schema.yml)[0m
16:01:13.400619 [error] [MainThread]:   Got 15 results, configured to fail if != 0
16:01:13.400699 [info ] [MainThread]: 
16:01:13.400779 [info ] [MainThread]:   compiled SQL at target/compiled/wrkplay_dbt/models/schema.yml/unique_wins_losses_seasonid.sql
16:01:13.400870 [info ] [MainThread]: 
16:01:13.400952 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
16:01:13.401080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104873370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104873eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a1580>]}


============================== 2022-07-08 16:15:52.138966 | dbabbca2-42ef-412f-952f-e42a86c5853c ==============================
16:15:52.138992 [info ] [MainThread]: Running with dbt=1.1.1
16:15:52.140144 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
16:15:52.140287 [debug] [MainThread]: Tracking: tracking
16:15:52.167810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822db50>]}
16:15:52.187584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
16:15:52.187822 [debug] [MainThread]: Partial parsing: added file: wrkplay_dbt://macros/positive_test.sql
16:15:52.188057 [debug] [MainThread]: Partial parsing: update schema file: wrkplay_dbt://models/schema.yml
16:15:52.188154 [debug] [MainThread]: Parsing macros/positive_test.sql
16:15:52.195647 [debug] [MainThread]: 1699: static parser successfully parsed wins_losses.sql
16:15:52.223607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbabbca2-42ef-412f-952f-e42a86c5853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108424310>]}
16:15:52.227042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbabbca2-42ef-412f-952f-e42a86c5853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a2130>]}
16:15:52.227224 [info ] [MainThread]: Found 3 models, 10 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:15:52.227375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbabbca2-42ef-412f-952f-e42a86c5853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a23a0>]}
16:15:52.228230 [info ] [MainThread]: 
16:15:52.228437 [debug] [MainThread]: Acquiring new postgres connection "master"
16:15:52.228871 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
16:15:52.233119 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
16:15:52.233223 [debug] [ThreadPool]: On list_postgres_public: BEGIN
16:15:52.233289 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:15:52.467256 [debug] [ThreadPool]: SQL status: BEGIN in 0.23 seconds
16:15:52.468721 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
16:15:52.469176 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:15:52.492700 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
16:15:52.497524 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
16:15:52.528503 [debug] [ThreadPool]: On list_postgres_public: Close
16:15:52.535876 [debug] [MainThread]: Using postgres connection "master"
16:15:52.536022 [debug] [MainThread]: On master: BEGIN
16:15:52.536083 [debug] [MainThread]: Opening a new connection, currently in state init
16:15:52.798333 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
16:15:52.799663 [debug] [MainThread]: Using postgres connection "master"
16:15:52.800024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:15:52.975718 [debug] [MainThread]: SQL status: SELECT 4 in 0.18 seconds
16:15:52.980911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbabbca2-42ef-412f-952f-e42a86c5853c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a2070>]}
16:15:52.981711 [debug] [MainThread]: On master: ROLLBACK
16:15:53.000036 [debug] [MainThread]: Using postgres connection "master"
16:15:53.000972 [debug] [MainThread]: On master: BEGIN
16:15:53.039872 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
16:15:53.040831 [debug] [MainThread]: On master: COMMIT
16:15:53.041201 [debug] [MainThread]: Using postgres connection "master"
16:15:53.041532 [debug] [MainThread]: On master: COMMIT
16:15:53.061614 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
16:15:53.062525 [debug] [MainThread]: On master: Close
16:15:53.064211 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:15:53.064855 [info ] [MainThread]: 
16:15:53.069717 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:15:53.069829 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:15:53.069910 [debug] [Thread-3  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:15:53.069984 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:15:53.070072 [debug] [Thread-5  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:15:53.070139 [debug] [Thread-6  ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
16:15:53.070200 [debug] [Thread-7  ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
16:15:53.070289 [info ] [Thread-1  ]: 1 of 10 START test not_null_my_first_dbt_model_id .............................. [RUN]
16:15:53.070354 [debug] [Thread-8  ]: Began running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:15:53.070432 [debug] [Thread-9  ]: Began running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:15:53.070503 [debug] [Thread-10 ]: Began running node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
16:15:53.070550 [info ] [Thread-2  ]: 2 of 10 START test not_null_my_second_dbt_model_id ............................. [RUN]
16:15:53.070627 [info ] [Thread-3  ]: 3 of 10 START test not_null_wins_losses_gameid ................................. [RUN]
16:15:53.070700 [info ] [Thread-4  ]: 4 of 10 START test not_null_wins_losses_player_id .............................. [RUN]
16:15:53.070767 [info ] [Thread-5  ]: 5 of 10 START test not_null_wins_losses_seasonid ............................... [RUN]
16:15:53.070835 [info ] [Thread-6  ]: 6 of 10 START test positive_test_wins_losses_total_losses ...................... [RUN]
16:15:53.070905 [info ] [Thread-7  ]: 7 of 10 START test positive_test_wins_losses_total_wins ........................ [RUN]
16:15:53.071229 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:15:53.071302 [info ] [Thread-8  ]: 8 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
16:15:53.071369 [info ] [Thread-9  ]: 9 of 10 START test unique_my_second_dbt_model_id ............................... [RUN]
16:15:53.071433 [info ] [Thread-10 ]: 10 of 10 START test unique_wins_losses_seasonid ................................ [RUN]
16:15:53.071625 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:15:53.071800 [debug] [Thread-3  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:15:53.071968 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:15:53.072137 [debug] [Thread-5  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:15:53.072297 [debug] [Thread-6  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
16:15:53.072447 [debug] [Thread-7  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
16:15:53.072518 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:15:53.072679 [debug] [Thread-8  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:15:53.072824 [debug] [Thread-9  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:15:53.072976 [debug] [Thread-10 ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
16:15:53.073034 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:15:53.073091 [debug] [Thread-3  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:15:53.073147 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:15:53.073210 [debug] [Thread-5  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:15:53.073836 [debug] [Thread-5  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:15:53.073314 [debug] [Thread-7  ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
16:15:53.073400 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:15:53.073453 [debug] [Thread-8  ]: Began compiling node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:15:53.073503 [debug] [Thread-9  ]: Began compiling node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:15:53.073555 [debug] [Thread-10 ]: Began compiling node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
16:15:53.073649 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:15:53.073720 [debug] [Thread-3  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:15:53.073780 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:15:53.073263 [debug] [Thread-6  ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
16:15:53.078065 [debug] [Thread-5  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:15:53.078162 [debug] [Thread-7  ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
16:15:53.079564 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:15:53.079644 [debug] [Thread-8  ]: Compiling test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:15:53.079707 [debug] [Thread-9  ]: Compiling test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:15:53.079765 [debug] [Thread-10 ]: Compiling test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
16:15:53.081093 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:15:53.082423 [debug] [Thread-3  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:15:53.084332 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:15:53.084409 [debug] [Thread-6  ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
16:15:53.085755 [debug] [Thread-7  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
16:15:53.109168 [debug] [Thread-8  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:15:53.110701 [debug] [Thread-9  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:15:53.110810 [debug] [Thread-1  ]: finished collecting timing info
16:15:53.110864 [debug] [Thread-5  ]: finished collecting timing info
16:15:53.112291 [debug] [Thread-10 ]: Writing injected SQL for node "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
16:15:53.113891 [debug] [Thread-6  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
16:15:53.114095 [debug] [Thread-3  ]: finished collecting timing info
16:15:53.114157 [debug] [Thread-2  ]: finished collecting timing info
16:15:53.114311 [debug] [Thread-8  ]: finished collecting timing info
16:15:53.114360 [debug] [Thread-4  ]: finished collecting timing info
16:15:53.114447 [debug] [Thread-7  ]: finished collecting timing info
16:15:53.114516 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:15:53.114608 [debug] [Thread-5  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:15:53.114697 [debug] [Thread-9  ]: finished collecting timing info
16:15:53.114803 [debug] [Thread-3  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:15:53.114917 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:15:53.114985 [debug] [Thread-6  ]: finished collecting timing info
16:15:53.115039 [debug] [Thread-8  ]: Began executing node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:15:53.115087 [debug] [Thread-10 ]: finished collecting timing info
16:15:53.115153 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:15:53.115221 [debug] [Thread-7  ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
16:15:53.121820 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:15:53.122600 [debug] [Thread-5  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:15:53.122693 [debug] [Thread-9  ]: Began executing node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:15:53.123393 [debug] [Thread-3  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:15:53.124063 [debug] [Thread-2  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:15:53.124144 [debug] [Thread-6  ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
16:15:53.124746 [debug] [Thread-8  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:15:53.124823 [debug] [Thread-10 ]: Began executing node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
16:15:53.125492 [debug] [Thread-4  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:15:53.126146 [debug] [Thread-7  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
16:15:53.126960 [debug] [Thread-9  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:15:53.127194 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:15:53.127285 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:15:53.128368 [debug] [Thread-6  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
16:15:53.128458 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:15:53.128527 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:15:53.129242 [debug] [Thread-10 ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
16:15:53.129440 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:15:53.129651 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
16:15:53.129731 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:15:53.129815 [debug] [Thread-7  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
16:15:53.129882 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: BEGIN
16:15:53.129941 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:15:53.130039 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: BEGIN
16:15:53.130109 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
16:15:53.130183 [debug] [Thread-6  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
16:15:53.130264 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
16:15:53.130367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:15:53.130448 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: BEGIN
16:15:53.130505 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: BEGIN
16:15:53.130562 [debug] [Thread-5  ]: Opening a new connection, currently in state init
16:15:53.130633 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
16:15:53.130686 [debug] [Thread-10 ]: Using postgres connection "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
16:15:53.130757 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:15:53.130815 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:15:53.130885 [debug] [Thread-6  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: BEGIN
16:15:53.130962 [debug] [Thread-8  ]: Opening a new connection, currently in state init
16:15:53.131090 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:15:53.131155 [debug] [Thread-7  ]: Opening a new connection, currently in state init
16:15:53.131287 [debug] [Thread-9  ]: Opening a new connection, currently in state init
16:15:53.131357 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: BEGIN
16:15:53.131531 [debug] [Thread-6  ]: Opening a new connection, currently in state init
16:15:53.131802 [debug] [Thread-10 ]: Opening a new connection, currently in state init
16:15:53.318690 [debug] [Thread-3  ]: SQL status: BEGIN in 0.19 seconds
16:15:53.318872 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:15:53.318936 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gameid
from "postgres"."public"."wins_losses"
where gameid is null



      
    ) dbt_internal_test
16:15:53.319009 [debug] [Thread-8  ]: SQL status: BEGIN in 0.19 seconds
16:15:53.319091 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:15:53.319152 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
16:15:53.326637 [debug] [Thread-1  ]: SQL status: BEGIN in 0.2 seconds
16:15:53.326871 [debug] [Thread-5  ]: SQL status: BEGIN in 0.2 seconds
16:15:53.327133 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:15:53.327320 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:15:53.327700 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seasonid
from "postgres"."public"."wins_losses"
where seasonid is null



      
    ) dbt_internal_test
16:15:53.327502 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
16:15:53.333017 [debug] [Thread-4  ]: SQL status: BEGIN in 0.2 seconds
16:15:53.333862 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:15:53.334044 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from "postgres"."public"."wins_losses"
where player_id is null



      
    ) dbt_internal_test
16:15:53.334725 [debug] [Thread-2  ]: SQL status: BEGIN in 0.2 seconds
16:15:53.334918 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:15:53.335074 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
16:15:53.338152 [debug] [Thread-7  ]: SQL status: BEGIN in 0.21 seconds
16:15:53.338694 [debug] [Thread-7  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
16:15:53.338921 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        total_wins as positive

    from "postgres"."public"."wins_losses"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
16:15:53.339233 [debug] [Thread-8  ]: SQL status: SELECT 1 in 0.02 seconds
16:15:53.342702 [debug] [Thread-8  ]: finished collecting timing info
16:15:53.342880 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
16:15:53.345420 [debug] [Thread-9  ]: SQL status: BEGIN in 0.21 seconds
16:15:53.345497 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:15:53.345564 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
16:15:53.345641 [debug] [Thread-6  ]: SQL status: BEGIN in 0.21 seconds
16:15:53.345704 [debug] [Thread-10 ]: SQL status: BEGIN in 0.21 seconds
16:15:53.345798 [debug] [Thread-6  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
16:15:53.345859 [debug] [Thread-10 ]: Using postgres connection "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"
16:15:53.345915 [debug] [Thread-6  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        total_losses as positive

    from "postgres"."public"."wins_losses"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
16:15:53.345967 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    seasonid as unique_field,
    count(*) as n_records

from "postgres"."public"."wins_losses"
where seasonid is not null
group by seasonid
having count(*) > 1



      
    ) dbt_internal_test
16:15:53.347552 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
16:15:53.350160 [debug] [Thread-1  ]: finished collecting timing info
16:15:53.350267 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
16:15:53.355599 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.02 seconds
16:15:53.358105 [debug] [Thread-2  ]: finished collecting timing info
16:15:53.358552 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
16:15:53.360143 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: Close
16:15:53.360476 [info ] [Thread-8  ]: 8 of 10 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 0.29s]
16:15:53.360711 [debug] [Thread-8  ]: Finished running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:15:53.367748 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
16:15:53.369093 [info ] [Thread-1  ]: 1 of 10 PASS not_null_my_first_dbt_model_id .................................... [[32mPASS[0m in 0.30s]
16:15:53.369865 [debug] [Thread-9  ]: SQL status: SELECT 1 in 0.02 seconds
16:15:53.370255 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:15:53.372011 [debug] [Thread-9  ]: finished collecting timing info
16:15:53.372279 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
16:15:53.376129 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
16:15:53.377423 [info ] [Thread-2  ]: 2 of 10 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.31s]
16:15:53.378317 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:15:53.388872 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.07 seconds
16:15:53.391831 [debug] [Thread-3  ]: finished collecting timing info
16:15:53.392024 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
16:15:53.392209 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.06 seconds
16:15:53.392552 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: ROLLBACK
16:15:53.394068 [debug] [Thread-4  ]: finished collecting timing info
16:15:53.394298 [info ] [Thread-9  ]: 9 of 10 PASS unique_my_second_dbt_model_id ..................................... [[32mPASS[0m in 0.32s]
16:15:53.394548 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: ROLLBACK
16:15:53.394756 [debug] [Thread-9  ]: Finished running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:15:53.394868 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.06 seconds
16:15:53.395592 [debug] [Thread-7  ]: finished collecting timing info
16:15:53.395723 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: ROLLBACK
16:15:53.396795 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.05 seconds
16:15:53.397334 [debug] [Thread-6  ]: finished collecting timing info
16:15:53.397435 [debug] [Thread-6  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: ROLLBACK
16:15:53.400445 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.07 seconds
16:15:53.401028 [debug] [Thread-5  ]: finished collecting timing info
16:15:53.401108 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: ROLLBACK
16:15:53.402208 [debug] [Thread-10 ]: SQL status: SELECT 1 in 0.06 seconds
16:15:53.402697 [debug] [Thread-10 ]: finished collecting timing info
16:15:53.402764 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: ROLLBACK
16:15:53.412913 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: Close
16:15:53.412985 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: Close
16:15:53.413055 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: Close
16:15:53.413319 [info ] [Thread-4  ]: 4 of 10 PASS not_null_wins_losses_player_id .................................... [[32mPASS[0m in 0.34s]
16:15:53.413463 [info ] [Thread-7  ]: 7 of 10 PASS positive_test_wins_losses_total_wins .............................. [[32mPASS[0m in 0.34s]
16:15:53.413601 [info ] [Thread-3  ]: 3 of 10 PASS not_null_wins_losses_gameid ....................................... [[32mPASS[0m in 0.34s]
16:15:53.413765 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:15:53.413902 [debug] [Thread-7  ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
16:15:53.414029 [debug] [Thread-3  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:15:53.416190 [debug] [Thread-6  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: Close
16:15:53.416411 [info ] [Thread-6  ]: 6 of 10 PASS positive_test_wins_losses_total_losses ............................ [[32mPASS[0m in 0.34s]
16:15:53.416555 [debug] [Thread-6  ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
16:15:53.421088 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: Close
16:15:53.421161 [debug] [Thread-10 ]: On test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb: Close
16:15:53.421340 [info ] [Thread-5  ]: 5 of 10 PASS not_null_wins_losses_seasonid ..................................... [[32mPASS[0m in 0.35s]
16:15:53.421489 [debug] [Thread-5  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:15:53.421653 [error] [Thread-10 ]: 10 of 10 FAIL 15 unique_wins_losses_seasonid ................................... [[31mFAIL 15[0m in 0.35s]
16:15:53.421805 [debug] [Thread-10 ]: Finished running node test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb
16:15:53.422512 [debug] [MainThread]: Acquiring new postgres connection "master"
16:15:53.422600 [debug] [MainThread]: Using postgres connection "master"
16:15:53.422655 [debug] [MainThread]: On master: BEGIN
16:15:53.422703 [debug] [MainThread]: Opening a new connection, currently in state closed
16:15:53.603654 [debug] [MainThread]: SQL status: BEGIN in 0.18 seconds
16:15:53.605352 [debug] [MainThread]: On master: COMMIT
16:15:53.605662 [debug] [MainThread]: Using postgres connection "master"
16:15:53.605942 [debug] [MainThread]: On master: COMMIT
16:15:53.628333 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
16:15:53.629664 [debug] [MainThread]: On master: Close
16:15:53.631318 [info ] [MainThread]: 
16:15:53.631817 [info ] [MainThread]: Finished running 10 tests in 1.40s.
16:15:53.632150 [debug] [MainThread]: Connection 'master' was properly closed.
16:15:53.632307 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
16:15:53.632611 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
16:15:53.632778 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1' was properly closed.
16:15:53.632847 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15' was properly closed.
16:15:53.632970 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813' was properly closed.
16:15:53.633027 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe' was properly closed.
16:15:53.633083 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77' was properly closed.
16:15:53.633131 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
16:15:53.633176 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
16:15:53.633221 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_wins_losses_seasonid.3540088bcb' was properly closed.
16:15:53.638643 [info ] [MainThread]: 
16:15:53.638840 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
16:15:53.638953 [info ] [MainThread]: 
16:15:53.639041 [error] [MainThread]: [31mFailure in test unique_wins_losses_seasonid (models/schema.yml)[0m
16:15:53.639133 [error] [MainThread]:   Got 15 results, configured to fail if != 0
16:15:53.639216 [info ] [MainThread]: 
16:15:53.639298 [info ] [MainThread]:   compiled SQL at target/compiled/wrkplay_dbt/models/schema.yml/unique_wins_losses_seasonid.sql
16:15:53.639392 [info ] [MainThread]: 
16:15:53.639472 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
16:15:53.639601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841fb20>]}


============================== 2022-07-08 16:16:25.728397 | ad35e43e-c8b6-4e04-a9e3-5133f86826df ==============================
16:16:25.728417 [info ] [MainThread]: Running with dbt=1.1.1
16:16:25.729207 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
16:16:25.729313 [debug] [MainThread]: Tracking: tracking
16:16:25.745465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e39be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e39d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e39d30>]}
16:16:25.762811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:16:25.763090 [debug] [MainThread]: Partial parsing: update schema file: wrkplay_dbt://models/schema.yml
16:16:25.770023 [debug] [MainThread]: 1699: static parser successfully parsed wins_losses.sql
16:16:25.798417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad35e43e-c8b6-4e04-a9e3-5133f86826df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106031fa0>]}
16:16:25.801217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad35e43e-c8b6-4e04-a9e3-5133f86826df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fac490>]}
16:16:25.801370 [info ] [MainThread]: Found 3 models, 9 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:16:25.801505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad35e43e-c8b6-4e04-a9e3-5133f86826df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e38610>]}
16:16:25.802303 [info ] [MainThread]: 
16:16:25.802502 [debug] [MainThread]: Acquiring new postgres connection "master"
16:16:25.802950 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
16:16:25.807297 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
16:16:25.807379 [debug] [ThreadPool]: On list_postgres_public: BEGIN
16:16:25.807442 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:16:26.037267 [debug] [ThreadPool]: SQL status: BEGIN in 0.23 seconds
16:16:26.038605 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
16:16:26.038988 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:16:26.062561 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
16:16:26.067547 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
16:16:26.086042 [debug] [ThreadPool]: On list_postgres_public: Close
16:16:26.093240 [debug] [MainThread]: Using postgres connection "master"
16:16:26.093376 [debug] [MainThread]: On master: BEGIN
16:16:26.093439 [debug] [MainThread]: Opening a new connection, currently in state init
16:16:26.279924 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
16:16:26.281414 [debug] [MainThread]: Using postgres connection "master"
16:16:26.281804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:16:26.451638 [debug] [MainThread]: SQL status: SELECT 4 in 0.17 seconds
16:16:26.456357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad35e43e-c8b6-4e04-a9e3-5133f86826df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fac1c0>]}
16:16:26.456955 [debug] [MainThread]: On master: ROLLBACK
16:16:26.475131 [debug] [MainThread]: Using postgres connection "master"
16:16:26.475959 [debug] [MainThread]: On master: BEGIN
16:16:26.517646 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
16:16:26.518765 [debug] [MainThread]: On master: COMMIT
16:16:26.519172 [debug] [MainThread]: Using postgres connection "master"
16:16:26.519517 [debug] [MainThread]: On master: COMMIT
16:16:26.540436 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
16:16:26.541248 [debug] [MainThread]: On master: Close
16:16:26.542997 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:16:26.543465 [info ] [MainThread]: 
16:16:26.550484 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:16:26.550673 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:16:26.550766 [info ] [Thread-1  ]: 1 of 9 START test not_null_my_first_dbt_model_id ............................... [RUN]
16:16:26.550835 [debug] [Thread-3  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:16:26.550917 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:16:26.550970 [info ] [Thread-2  ]: 2 of 9 START test not_null_my_second_dbt_model_id .............................. [RUN]
16:16:26.551028 [debug] [Thread-5  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:16:26.551296 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:16:26.551368 [info ] [Thread-3  ]: 3 of 9 START test not_null_wins_losses_gameid .................................. [RUN]
16:16:26.551421 [debug] [Thread-6  ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
16:16:26.551489 [info ] [Thread-4  ]: 4 of 9 START test not_null_wins_losses_player_id ............................... [RUN]
16:16:26.551538 [debug] [Thread-7  ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
16:16:26.551736 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:16:26.551813 [debug] [Thread-8  ]: Began running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:16:26.551859 [info ] [Thread-5  ]: 5 of 9 START test not_null_wins_losses_seasonid ................................ [RUN]
16:16:26.551909 [debug] [Thread-9  ]: Began running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:16:26.551981 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:16:26.552154 [debug] [Thread-3  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:16:26.552220 [info ] [Thread-6  ]: 6 of 9 START test positive_test_wins_losses_total_losses ....................... [RUN]
16:16:26.552372 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:16:26.552438 [info ] [Thread-7  ]: 7 of 9 START test positive_test_wins_losses_total_wins ......................... [RUN]
16:16:26.552499 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:16:26.552558 [info ] [Thread-8  ]: 8 of 9 START test unique_my_first_dbt_model_id ................................. [RUN]
16:16:26.552717 [debug] [Thread-5  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:16:26.552778 [info ] [Thread-9  ]: 9 of 9 START test unique_my_second_dbt_model_id ................................ [RUN]
16:16:26.552880 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:16:26.552945 [debug] [Thread-3  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:16:26.553085 [debug] [Thread-6  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
16:16:26.553140 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:16:26.553277 [debug] [Thread-7  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
16:16:26.553332 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:16:26.553556 [debug] [Thread-8  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:16:26.553632 [debug] [Thread-5  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:16:26.553808 [debug] [Thread-9  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:16:26.557965 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:16:26.558064 [debug] [Thread-3  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:16:26.558131 [debug] [Thread-6  ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
16:16:26.558187 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:16:26.558242 [debug] [Thread-7  ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
16:16:26.559606 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:16:26.559687 [debug] [Thread-8  ]: Began compiling node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:16:26.559752 [debug] [Thread-5  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:16:26.559809 [debug] [Thread-9  ]: Began compiling node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:16:26.561276 [debug] [Thread-3  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:16:26.561384 [debug] [Thread-6  ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
16:16:26.562676 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:16:26.562775 [debug] [Thread-7  ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
16:16:26.562892 [debug] [Thread-1  ]: finished collecting timing info
16:16:26.562950 [debug] [Thread-8  ]: Compiling test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:16:26.564364 [debug] [Thread-5  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:16:26.564445 [debug] [Thread-9  ]: Compiling test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:16:26.564494 [debug] [Thread-2  ]: finished collecting timing info
16:16:26.566357 [debug] [Thread-6  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
16:16:26.587651 [debug] [Thread-7  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
16:16:26.587754 [debug] [Thread-3  ]: finished collecting timing info
16:16:26.587887 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:16:26.590782 [debug] [Thread-8  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:16:26.590877 [debug] [Thread-4  ]: finished collecting timing info
16:16:26.592447 [debug] [Thread-9  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:16:26.592584 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:16:26.592742 [debug] [Thread-5  ]: finished collecting timing info
16:16:26.592896 [debug] [Thread-3  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:16:26.599269 [debug] [Thread-6  ]: finished collecting timing info
16:16:26.599348 [debug] [Thread-7  ]: finished collecting timing info
16:16:26.599688 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:16:26.599845 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:16:26.600676 [debug] [Thread-2  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:16:26.600752 [debug] [Thread-8  ]: finished collecting timing info
16:16:26.600853 [debug] [Thread-5  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:16:26.601609 [debug] [Thread-3  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:16:26.601685 [debug] [Thread-9  ]: finished collecting timing info
16:16:26.601779 [debug] [Thread-6  ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
16:16:26.601868 [debug] [Thread-7  ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
16:16:26.602672 [debug] [Thread-4  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:16:26.602849 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:16:26.602912 [debug] [Thread-8  ]: Began executing node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:16:26.603634 [debug] [Thread-5  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:16:26.603702 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:16:26.603809 [debug] [Thread-9  ]: Began executing node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:16:26.604485 [debug] [Thread-6  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
16:16:26.605124 [debug] [Thread-7  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
16:16:26.605229 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:16:26.605330 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
16:16:26.605994 [debug] [Thread-8  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:16:26.606083 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:16:26.606175 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
16:16:26.606838 [debug] [Thread-9  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:16:26.606924 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:16:26.607068 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: BEGIN
16:16:26.607148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:16:26.607222 [debug] [Thread-6  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
16:16:26.607279 [debug] [Thread-7  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
16:16:26.607368 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: BEGIN
16:16:26.607454 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:16:26.607509 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:16:26.607593 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: BEGIN
16:16:26.607657 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:16:26.607798 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:16:26.607856 [debug] [Thread-6  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: BEGIN
16:16:26.607918 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: BEGIN
16:16:26.607974 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:16:26.608084 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
16:16:26.608136 [debug] [Thread-5  ]: Opening a new connection, currently in state init
16:16:26.608241 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
16:16:26.608292 [debug] [Thread-6  ]: Opening a new connection, currently in state init
16:16:26.608346 [debug] [Thread-7  ]: Opening a new connection, currently in state init
16:16:26.608447 [debug] [Thread-8  ]: Opening a new connection, currently in state init
16:16:26.608543 [debug] [Thread-9  ]: Opening a new connection, currently in state init
16:16:26.804041 [debug] [Thread-6  ]: SQL status: BEGIN in 0.2 seconds
16:16:26.804771 [debug] [Thread-6  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
16:16:26.805123 [debug] [Thread-6  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        total_losses as positive

    from "postgres"."public"."wins_losses"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
16:16:26.807096 [debug] [Thread-9  ]: SQL status: BEGIN in 0.2 seconds
16:16:26.807458 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
16:16:26.807787 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
16:16:26.809363 [debug] [Thread-5  ]: SQL status: BEGIN in 0.2 seconds
16:16:26.809827 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
16:16:26.810170 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seasonid
from "postgres"."public"."wins_losses"
where seasonid is null



      
    ) dbt_internal_test
16:16:26.811521 [debug] [Thread-7  ]: SQL status: BEGIN in 0.2 seconds
16:16:26.811869 [debug] [Thread-7  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
16:16:26.812178 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        total_wins as positive

    from "postgres"."public"."wins_losses"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
16:16:26.817342 [debug] [Thread-3  ]: SQL status: BEGIN in 0.21 seconds
16:16:26.817744 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
16:16:26.818068 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gameid
from "postgres"."public"."wins_losses"
where gameid is null



      
    ) dbt_internal_test
16:16:26.823129 [debug] [Thread-1  ]: SQL status: BEGIN in 0.22 seconds
16:16:26.823586 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
16:16:26.823902 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
16:16:26.828081 [debug] [Thread-4  ]: SQL status: BEGIN in 0.22 seconds
16:16:26.828534 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
16:16:26.828848 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from "postgres"."public"."wins_losses"
where player_id is null



      
    ) dbt_internal_test
16:16:26.829677 [debug] [Thread-9  ]: SQL status: SELECT 1 in 0.02 seconds
16:16:26.835165 [debug] [Thread-9  ]: finished collecting timing info
16:16:26.835360 [debug] [Thread-2  ]: SQL status: BEGIN in 0.23 seconds
16:16:26.835492 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
16:16:26.835544 [debug] [Thread-8  ]: SQL status: BEGIN in 0.23 seconds
16:16:26.835626 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
16:16:26.835729 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
16:16:26.835802 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
16:16:26.835863 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
16:16:26.843710 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
16:16:26.847039 [debug] [Thread-1  ]: finished collecting timing info
16:16:26.847554 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
16:16:26.852991 [debug] [Thread-9  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
16:16:26.854507 [info ] [Thread-9  ]: 9 of 9 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.30s]
16:16:26.855684 [debug] [Thread-9  ]: Finished running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
16:16:26.856665 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.02 seconds
16:16:26.856825 [debug] [Thread-8  ]: SQL status: SELECT 1 in 0.02 seconds
16:16:26.858485 [debug] [Thread-2  ]: finished collecting timing info
16:16:26.859226 [debug] [Thread-8  ]: finished collecting timing info
16:16:26.859314 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
16:16:26.859381 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
16:16:26.860040 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.05 seconds
16:16:26.860566 [debug] [Thread-7  ]: finished collecting timing info
16:16:26.860636 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: ROLLBACK
16:16:26.860714 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.06 seconds
16:16:26.861313 [debug] [Thread-6  ]: finished collecting timing info
16:16:26.861388 [debug] [Thread-6  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: ROLLBACK
16:16:26.864417 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
16:16:26.865682 [info ] [Thread-1  ]: 1 of 9 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.31s]
16:16:26.866502 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
16:16:26.868645 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.06 seconds
16:16:26.869211 [debug] [Thread-5  ]: finished collecting timing info
16:16:26.869285 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: ROLLBACK
16:16:26.870294 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.05 seconds
16:16:26.870782 [debug] [Thread-3  ]: finished collecting timing info
16:16:26.870847 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: ROLLBACK
16:16:26.871819 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.04 seconds
16:16:26.872301 [debug] [Thread-4  ]: finished collecting timing info
16:16:26.872364 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: ROLLBACK
16:16:26.877894 [debug] [Thread-8  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: Close
16:16:26.879392 [info ] [Thread-8  ]: 8 of 9 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.33s]
16:16:26.879704 [debug] [Thread-6  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: Close
16:16:26.879944 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: Close
16:16:26.880024 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
16:16:26.880203 [debug] [Thread-8  ]: Finished running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
16:16:26.880521 [info ] [Thread-6  ]: 6 of 9 PASS positive_test_wins_losses_total_losses ............................. [[32mPASS[0m in 0.33s]
16:16:26.880670 [info ] [Thread-7  ]: 7 of 9 PASS positive_test_wins_losses_total_wins ............................... [[32mPASS[0m in 0.33s]
16:16:26.880799 [info ] [Thread-2  ]: 2 of 9 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.33s]
16:16:26.881041 [debug] [Thread-6  ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
16:16:26.881193 [debug] [Thread-7  ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
16:16:26.881333 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
16:16:26.888160 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: Close
16:16:26.889511 [info ] [Thread-5  ]: 5 of 9 PASS not_null_wins_losses_seasonid ...................................... [[32mPASS[0m in 0.34s]
16:16:26.889865 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: Close
16:16:26.892221 [info ] [Thread-3  ]: 3 of 9 PASS not_null_wins_losses_gameid ........................................ [[32mPASS[0m in 0.34s]
16:16:26.892535 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: Close
16:16:26.893048 [debug] [Thread-3  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
16:16:26.890784 [debug] [Thread-5  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
16:16:26.893909 [info ] [Thread-4  ]: 4 of 9 PASS not_null_wins_losses_player_id ..................................... [[32mPASS[0m in 0.34s]
16:16:26.894183 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
16:16:26.895147 [debug] [MainThread]: Acquiring new postgres connection "master"
16:16:26.895254 [debug] [MainThread]: Using postgres connection "master"
16:16:26.895310 [debug] [MainThread]: On master: BEGIN
16:16:26.895363 [debug] [MainThread]: Opening a new connection, currently in state closed
16:16:27.085850 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
16:16:27.087158 [debug] [MainThread]: On master: COMMIT
16:16:27.087450 [debug] [MainThread]: Using postgres connection "master"
16:16:27.087723 [debug] [MainThread]: On master: COMMIT
16:16:27.105725 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
16:16:27.106713 [debug] [MainThread]: On master: Close
16:16:27.108481 [info ] [MainThread]: 
16:16:27.109109 [info ] [MainThread]: Finished running 9 tests in 1.31s.
16:16:27.109738 [debug] [MainThread]: Connection 'master' was properly closed.
16:16:27.109978 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
16:16:27.110034 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
16:16:27.110082 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1' was properly closed.
16:16:27.110131 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15' was properly closed.
16:16:27.110187 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813' was properly closed.
16:16:27.110242 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe' was properly closed.
16:16:27.110293 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77' was properly closed.
16:16:27.110338 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
16:16:27.110383 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
16:16:27.114971 [info ] [MainThread]: 
16:16:27.115108 [info ] [MainThread]: [32mCompleted successfully[0m
16:16:27.115225 [info ] [MainThread]: 
16:16:27.115310 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
16:16:27.115441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd6c10>]}


============================== 2022-07-08 16:16:32.372850 | 5351534f-9153-4608-9191-fed70b460c49 ==============================
16:16:32.372889 [info ] [MainThread]: Running with dbt=1.1.1
16:16:32.373289 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:16:32.373377 [debug] [MainThread]: Tracking: tracking
16:16:32.388278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11159da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11159db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11159db80>]}
16:16:32.405454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:16:32.405572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:16:32.408863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5351534f-9153-4608-9191-fed70b460c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118810d0>]}
16:16:32.411526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5351534f-9153-4608-9191-fed70b460c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116dc640>]}
16:16:32.411676 [info ] [MainThread]: Found 3 models, 9 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:16:32.411825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5351534f-9153-4608-9191-fed70b460c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116dc6d0>]}
16:16:32.412513 [info ] [MainThread]: 
16:16:32.412716 [debug] [MainThread]: Acquiring new postgres connection "master"
16:16:32.413121 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
16:16:32.417414 [debug] [ThreadPool]: Using postgres connection "list_postgres"
16:16:32.417493 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
16:16:32.417553 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:16:32.639260 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.22 seconds
16:16:32.641441 [debug] [ThreadPool]: On list_postgres: Close
16:16:32.642584 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
16:16:32.645924 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
16:16:32.646026 [debug] [ThreadPool]: On list_postgres_public: BEGIN
16:16:32.646089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:16:32.830342 [debug] [ThreadPool]: SQL status: BEGIN in 0.18 seconds
16:16:32.831111 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
16:16:32.831375 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:16:32.855072 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
16:16:32.859887 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
16:16:32.879810 [debug] [ThreadPool]: On list_postgres_public: Close
16:16:32.887287 [debug] [MainThread]: Using postgres connection "master"
16:16:32.887478 [debug] [MainThread]: On master: BEGIN
16:16:32.887541 [debug] [MainThread]: Opening a new connection, currently in state init
16:16:33.087397 [debug] [MainThread]: SQL status: BEGIN in 0.2 seconds
16:16:33.088762 [debug] [MainThread]: Using postgres connection "master"
16:16:33.089007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:16:33.264814 [debug] [MainThread]: SQL status: SELECT 4 in 0.18 seconds
16:16:33.269129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5351534f-9153-4608-9191-fed70b460c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116dc430>]}
16:16:33.269623 [debug] [MainThread]: On master: ROLLBACK
16:16:33.288534 [debug] [MainThread]: Using postgres connection "master"
16:16:33.289363 [debug] [MainThread]: On master: BEGIN
16:16:33.348584 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
16:16:33.349636 [debug] [MainThread]: On master: COMMIT
16:16:33.350043 [debug] [MainThread]: Using postgres connection "master"
16:16:33.350384 [debug] [MainThread]: On master: COMMIT
16:16:33.368604 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
16:16:33.369513 [debug] [MainThread]: On master: Close
16:16:33.371237 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:16:33.372033 [info ] [MainThread]: 
16:16:33.378569 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.my_first_dbt_model
16:16:33.378848 [info ] [Thread-1  ]: 1 of 3 START view model public.my_first_dbt_model .............................. [RUN]
16:16:33.379006 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
16:16:33.379233 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_first_dbt_model"
16:16:33.379368 [info ] [Thread-2  ]: 2 of 3 START view model public.wins_losses ..................................... [RUN]
16:16:33.379472 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.my_first_dbt_model
16:16:33.379661 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
16:16:33.379769 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.my_first_dbt_model
16:16:33.379835 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
16:16:33.381683 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.my_first_dbt_model"
16:16:33.381777 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
16:16:33.382571 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
16:16:33.383068 [debug] [Thread-1  ]: finished collecting timing info
16:16:33.383177 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.my_first_dbt_model
16:16:33.389136 [debug] [Thread-2  ]: finished collecting timing info
16:16:33.393825 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_first_dbt_model"
16:16:33.393954 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
16:16:33.395123 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
16:16:33.395312 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
16:16:33.395395 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: BEGIN
16:16:33.395458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:16:33.395520 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
16:16:33.395655 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: BEGIN
16:16:33.395716 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:16:33.611404 [debug] [Thread-2  ]: SQL status: BEGIN in 0.22 seconds
16:16:33.611813 [debug] [Thread-1  ]: SQL status: BEGIN in 0.22 seconds
16:16:33.612103 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
16:16:33.612301 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
16:16:33.612491 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */

  create view "postgres"."public"."wins_losses__dbt_tmp" as (
    --number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
16:16:33.612668 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */

  create view "postgres"."public"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
16:16:33.636694 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
16:16:33.643779 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
16:16:33.643965 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:16:33.645706 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.03 seconds
16:16:33.646902 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
16:16:33.646983 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses" rename to "wins_losses__dbt_backup"
16:16:33.665009 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
16:16:33.668908 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
16:16:33.669219 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
16:16:33.669417 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:16:33.670583 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
16:16:33.670706 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
16:16:33.699365 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
16:16:33.699642 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.03 seconds
16:16:33.706163 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
16:16:33.706760 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
16:16:33.706845 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
16:16:33.706911 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
16:16:33.706969 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
16:16:33.707024 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
16:16:33.732428 [debug] [Thread-2  ]: SQL status: COMMIT in 0.03 seconds
16:16:33.732675 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
16:16:33.737626 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
16:16:33.738340 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
16:16:33.738414 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop view if exists "postgres"."public"."wins_losses__dbt_backup" cascade
16:16:33.738474 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
drop view if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
16:16:33.760938 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
16:16:33.761033 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
16:16:33.761633 [debug] [Thread-2  ]: finished collecting timing info
16:16:33.762067 [debug] [Thread-1  ]: finished collecting timing info
16:16:33.762155 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: Close
16:16:33.762260 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: Close
16:16:33.762568 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5351534f-9153-4608-9191-fed70b460c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118fddf0>]}
16:16:33.762716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5351534f-9153-4608-9191-fed70b460c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111974460>]}
16:16:33.762904 [info ] [Thread-2  ]: 2 of 3 OK created view model public.wins_losses ................................ [[32mCREATE VIEW[0m in 0.38s]
16:16:33.763044 [info ] [Thread-1  ]: 1 of 3 OK created view model public.my_first_dbt_model ......................... [[32mCREATE VIEW[0m in 0.38s]
16:16:33.763250 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
16:16:33.763384 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.my_first_dbt_model
16:16:33.763746 [debug] [Thread-4  ]: Began running node model.wrkplay_dbt.my_second_dbt_model
16:16:33.763841 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:16:33.764007 [debug] [Thread-4  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_second_dbt_model"
16:16:33.764066 [debug] [Thread-4  ]: Began compiling node model.wrkplay_dbt.my_second_dbt_model
16:16:33.764127 [debug] [Thread-4  ]: Compiling model.wrkplay_dbt.my_second_dbt_model
16:16:33.765073 [debug] [Thread-4  ]: Writing injected SQL for node "model.wrkplay_dbt.my_second_dbt_model"
16:16:33.765347 [debug] [Thread-4  ]: finished collecting timing info
16:16:33.765411 [debug] [Thread-4  ]: Began executing node model.wrkplay_dbt.my_second_dbt_model
16:16:33.766493 [debug] [Thread-4  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_second_dbt_model"
16:16:33.766942 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
16:16:33.767000 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: BEGIN
16:16:33.767051 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:16:34.080623 [debug] [Thread-4  ]: SQL status: BEGIN in 0.31 seconds
16:16:34.081834 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
16:16:34.082040 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
16:16:34.105544 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.02 seconds
16:16:34.110506 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
16:16:34.110699 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:16:34.139801 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.03 seconds
16:16:34.143583 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
16:16:34.143832 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
16:16:34.143995 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
16:16:34.170629 [debug] [Thread-4  ]: SQL status: COMMIT in 0.03 seconds
16:16:34.175085 [debug] [Thread-4  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
16:16:34.175234 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
16:16:34.194563 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
16:16:34.198113 [debug] [Thread-4  ]: finished collecting timing info
16:16:34.198902 [debug] [Thread-4  ]: On model.wrkplay_dbt.my_second_dbt_model: Close
16:16:34.199422 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5351534f-9153-4608-9191-fed70b460c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118fd910>]}
16:16:34.199683 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.44s]
16:16:34.199947 [debug] [Thread-4  ]: Finished running node model.wrkplay_dbt.my_second_dbt_model
16:16:34.200995 [debug] [MainThread]: Acquiring new postgres connection "master"
16:16:34.201106 [debug] [MainThread]: Using postgres connection "master"
16:16:34.201163 [debug] [MainThread]: On master: BEGIN
16:16:34.201219 [debug] [MainThread]: Opening a new connection, currently in state closed
16:16:34.405874 [debug] [MainThread]: SQL status: BEGIN in 0.2 seconds
16:16:34.407011 [debug] [MainThread]: On master: COMMIT
16:16:34.407219 [debug] [MainThread]: Using postgres connection "master"
16:16:34.407417 [debug] [MainThread]: On master: COMMIT
16:16:34.430933 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
16:16:34.432043 [debug] [MainThread]: On master: Close
16:16:34.433742 [info ] [MainThread]: 
16:16:34.434283 [info ] [MainThread]: Finished running 3 view models in 2.02s.
16:16:34.434746 [debug] [MainThread]: Connection 'master' was properly closed.
16:16:34.434880 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_first_dbt_model' was properly closed.
16:16:34.434937 [debug] [MainThread]: Connection 'model.wrkplay_dbt.wins_losses' was properly closed.
16:16:34.434989 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_second_dbt_model' was properly closed.
16:16:34.438385 [info ] [MainThread]: 
16:16:34.438522 [info ] [MainThread]: [32mCompleted successfully[0m
16:16:34.438664 [info ] [MainThread]: 
16:16:34.438759 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:16:34.438913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116dc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116dc580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ea9a0>]}


============================== 2022-07-08 17:05:46.045310 | 12a34e78-8420-4766-8cf5-a6d8fb495bdc ==============================
17:05:46.045331 [info ] [MainThread]: Running with dbt=1.1.1
17:05:46.046205 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:05:46.046339 [debug] [MainThread]: Tracking: tracking
17:05:46.070310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088798e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108879a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108879a30>]}
17:05:46.090558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
17:05:46.090756 [debug] [MainThread]: Partial parsing: added file: wrkplay_dbt://models/number_played_against.sql
17:05:46.090925 [debug] [MainThread]: Partial parsing: update schema file: wrkplay_dbt://models/schema.yml
17:05:46.097530 [debug] [MainThread]: 1699: static parser successfully parsed number_played_against.sql
17:05:46.123323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12a34e78-8420-4766-8cf5-a6d8fb495bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae10d0>]}
17:05:46.127045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12a34e78-8420-4766-8cf5-a6d8fb495bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa2070>]}
17:05:46.127193 [info ] [MainThread]: Found 4 models, 13 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:05:46.127331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a34e78-8420-4766-8cf5-a6d8fb495bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab66d0>]}
17:05:46.128246 [info ] [MainThread]: 
17:05:46.128442 [debug] [MainThread]: Acquiring new postgres connection "master"
17:05:46.128921 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
17:05:46.133243 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:05:46.133347 [debug] [ThreadPool]: On list_postgres_public: BEGIN
17:05:46.133419 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:05:46.366635 [debug] [ThreadPool]: SQL status: BEGIN in 0.23 seconds
17:05:46.367750 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:05:46.368178 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:05:46.390659 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
17:05:46.396373 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
17:05:46.413900 [debug] [ThreadPool]: On list_postgres_public: Close
17:05:46.420151 [debug] [MainThread]: Using postgres connection "master"
17:05:46.420265 [debug] [MainThread]: On master: BEGIN
17:05:46.420328 [debug] [MainThread]: Opening a new connection, currently in state init
17:05:46.622998 [debug] [MainThread]: SQL status: BEGIN in 0.2 seconds
17:05:46.624188 [debug] [MainThread]: Using postgres connection "master"
17:05:46.624607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:05:46.795156 [debug] [MainThread]: SQL status: SELECT 4 in 0.17 seconds
17:05:46.798575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a34e78-8420-4766-8cf5-a6d8fb495bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a84a30>]}
17:05:46.799027 [debug] [MainThread]: On master: ROLLBACK
17:05:46.818395 [debug] [MainThread]: Using postgres connection "master"
17:05:46.818897 [debug] [MainThread]: On master: BEGIN
17:05:46.857154 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
17:05:46.858372 [debug] [MainThread]: On master: COMMIT
17:05:46.858797 [debug] [MainThread]: Using postgres connection "master"
17:05:46.859007 [debug] [MainThread]: On master: COMMIT
17:05:46.880955 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:05:46.881686 [debug] [MainThread]: On master: Close
17:05:46.883292 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:05:46.883887 [info ] [MainThread]: 
17:05:46.888320 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:05:46.888430 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
17:05:46.888500 [debug] [Thread-3  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
17:05:46.888570 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
17:05:46.888634 [debug] [Thread-5  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
17:05:46.888684 [debug] [Thread-6  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
17:05:46.888757 [info ] [Thread-1  ]: 1 of 13 START test not_null_my_first_dbt_model_id .............................. [RUN]
17:05:46.888819 [debug] [Thread-7  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
17:05:46.888890 [debug] [Thread-8  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
17:05:46.888953 [debug] [Thread-9  ]: Began running node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
17:05:46.889000 [debug] [Thread-10 ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
17:05:46.889049 [info ] [Thread-2  ]: 2 of 13 START test not_null_my_second_dbt_model_id ............................. [RUN]
17:05:46.889117 [info ] [Thread-3  ]: 3 of 13 START test not_null_number_played_against_num_played_against ........... [RUN]
17:05:46.889195 [info ] [Thread-4  ]: 4 of 13 START test not_null_number_played_against_player_id .................... [RUN]
17:05:46.889259 [info ] [Thread-5  ]: 5 of 13 START test not_null_number_played_against_season_id .................... [RUN]
17:05:46.889351 [info ] [Thread-6  ]: 6 of 13 START test not_null_wins_losses_gameid ................................. [RUN]
17:05:46.889640 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:05:46.889693 [info ] [Thread-7  ]: 7 of 13 START test not_null_wins_losses_player_id .............................. [RUN]
17:05:46.889761 [info ] [Thread-8  ]: 8 of 13 START test not_null_wins_losses_seasonid ............................... [RUN]
17:05:46.889822 [info ] [Thread-9  ]: 9 of 13 START test positive_test_number_played_against_num_played_against ...... [RUN]
17:05:46.889885 [info ] [Thread-10 ]: 10 of 13 START test positive_test_wins_losses_total_losses ..................... [RUN]
17:05:46.890059 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:05:46.890215 [debug] [Thread-3  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
17:05:46.890382 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
17:05:46.890539 [debug] [Thread-5  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
17:05:46.890687 [debug] [Thread-6  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
17:05:46.890752 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:05:46.890946 [debug] [Thread-7  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
17:05:46.891125 [debug] [Thread-8  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
17:05:46.891275 [debug] [Thread-9  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
17:05:46.891440 [debug] [Thread-10 ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
17:05:46.891494 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
17:05:46.891552 [debug] [Thread-3  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
17:05:46.891608 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
17:05:46.891661 [debug] [Thread-5  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
17:05:46.891714 [debug] [Thread-6  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
17:05:46.891784 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:05:46.891837 [debug] [Thread-7  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
17:05:46.891889 [debug] [Thread-8  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
17:05:46.891940 [debug] [Thread-9  ]: Began compiling node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
17:05:46.891991 [debug] [Thread-10 ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
17:05:46.892045 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
17:05:46.892099 [debug] [Thread-3  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
17:05:46.892155 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
17:05:46.892208 [debug] [Thread-5  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
17:05:46.892259 [debug] [Thread-6  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
17:05:46.896379 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:05:46.896476 [debug] [Thread-7  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
17:05:46.896545 [debug] [Thread-8  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
17:05:46.896606 [debug] [Thread-9  ]: Compiling test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
17:05:46.896662 [debug] [Thread-10 ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
17:05:46.898138 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:05:46.899519 [debug] [Thread-3  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
17:05:46.900864 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
17:05:46.902194 [debug] [Thread-5  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
17:05:46.903495 [debug] [Thread-6  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
17:05:46.905590 [debug] [Thread-7  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
17:05:46.926627 [debug] [Thread-8  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
17:05:46.928111 [debug] [Thread-9  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
17:05:46.929425 [debug] [Thread-10 ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
17:05:46.929492 [debug] [Thread-1  ]: finished collecting timing info
17:05:46.929930 [debug] [Thread-2  ]: finished collecting timing info
17:05:46.930498 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:05:46.930679 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
17:05:46.930828 [debug] [Thread-3  ]: finished collecting timing info
17:05:46.930953 [debug] [Thread-4  ]: finished collecting timing info
17:05:46.931035 [debug] [Thread-6  ]: finished collecting timing info
17:05:46.931105 [debug] [Thread-7  ]: finished collecting timing info
17:05:46.931159 [debug] [Thread-8  ]: finished collecting timing info
17:05:46.938539 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:05:46.938674 [debug] [Thread-9  ]: finished collecting timing info
17:05:46.938758 [debug] [Thread-5  ]: finished collecting timing info
17:05:46.938809 [debug] [Thread-10 ]: finished collecting timing info
17:05:46.939759 [debug] [Thread-2  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:05:46.939860 [debug] [Thread-3  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
17:05:46.939936 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
17:05:46.940006 [debug] [Thread-6  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
17:05:46.940080 [debug] [Thread-7  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
17:05:46.940142 [debug] [Thread-8  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
17:05:46.940244 [debug] [Thread-9  ]: Began executing node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
17:05:46.940304 [debug] [Thread-5  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
17:05:46.940383 [debug] [Thread-10 ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
17:05:46.940500 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:05:46.941223 [debug] [Thread-3  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
17:05:46.941905 [debug] [Thread-4  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
17:05:46.941982 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:05:46.942686 [debug] [Thread-6  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
17:05:46.943382 [debug] [Thread-7  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
17:05:46.944015 [debug] [Thread-8  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
17:05:46.944645 [debug] [Thread-9  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
17:05:46.945265 [debug] [Thread-5  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
17:05:46.946286 [debug] [Thread-10 ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
17:05:46.946365 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:05:46.946523 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:05:46.946914 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
17:05:46.947041 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
17:05:46.947127 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
17:05:46.947216 [debug] [Thread-6  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
17:05:46.947276 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
17:05:46.947356 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
17:05:46.947419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:05:46.947486 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:05:46.947570 [debug] [Thread-7  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
17:05:46.947625 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: BEGIN
17:05:46.947697 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: BEGIN
17:05:46.947756 [debug] [Thread-10 ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
17:05:46.947814 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: BEGIN
17:05:46.947877 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: BEGIN
17:05:46.947935 [debug] [Thread-8  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: BEGIN
17:05:46.947990 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: BEGIN
17:05:46.948170 [debug] [Thread-7  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: BEGIN
17:05:46.948225 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:05:46.948282 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:05:46.948336 [debug] [Thread-10 ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: BEGIN
17:05:46.948387 [debug] [Thread-9  ]: Opening a new connection, currently in state init
17:05:46.948438 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:05:46.948489 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:05:46.948542 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:05:46.948592 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:05:46.948738 [debug] [Thread-10 ]: Opening a new connection, currently in state init
17:05:47.137669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
17:05:47.137967 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:05:47.138033 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:05:47.139130 [debug] [Thread-6  ]: SQL status: BEGIN in 0.19 seconds
17:05:47.139194 [debug] [Thread-6  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
17:05:47.139242 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gameid
from "postgres"."public"."wins_losses"
where gameid is null



      
    ) dbt_internal_test
17:05:47.142097 [debug] [Thread-4  ]: SQL status: BEGIN in 0.19 seconds
17:05:47.142154 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
17:05:47.142202 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from "postgres"."public"."number_played_against"
where player_id is null



      
    ) dbt_internal_test
17:05:47.145787 [debug] [Thread-5  ]: SQL status: BEGIN in 0.2 seconds
17:05:47.146365 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
17:05:47.146538 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season_id
from "postgres"."public"."number_played_against"
where season_id is null



      
    ) dbt_internal_test
17:05:47.148913 [debug] [Thread-9  ]: SQL status: BEGIN in 0.2 seconds
17:05:47.149925 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
17:05:47.150176 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        num_played_against as positive

    from "postgres"."public"."number_played_against"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
17:05:47.155762 [debug] [Thread-7  ]: SQL status: BEGIN in 0.21 seconds
17:05:47.155905 [debug] [Thread-7  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
17:05:47.155963 [debug] [Thread-7  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from "postgres"."public"."wins_losses"
where player_id is null



      
    ) dbt_internal_test
17:05:47.156942 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
17:05:47.158579 [debug] [Thread-1  ]: finished collecting timing info
17:05:47.158729 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:05:47.159541 [debug] [Thread-2  ]: SQL status: BEGIN in 0.21 seconds
17:05:47.159602 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:05:47.159653 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:05:47.161476 [debug] [Thread-4  ]: Postgres adapter: Postgres error: relation "public.number_played_against" does not exist
LINE 14: from "postgres"."public"."number_played_against"
              ^

17:05:47.162093 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: ROLLBACK
17:05:47.164735 [debug] [Thread-3  ]: SQL status: BEGIN in 0.22 seconds
17:05:47.165197 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
17:05:47.165364 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select num_played_against
from "postgres"."public"."number_played_against"
where num_played_against is null



      
    ) dbt_internal_test
17:05:47.165678 [debug] [Thread-10 ]: SQL status: BEGIN in 0.22 seconds
17:05:47.165858 [debug] [Thread-10 ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
17:05:47.166187 [debug] [Thread-10 ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        total_losses as positive

    from "postgres"."public"."wins_losses"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
17:05:47.166633 [debug] [Thread-5  ]: Postgres adapter: Postgres error: relation "public.number_played_against" does not exist
LINE 14: from "postgres"."public"."number_played_against"
              ^

17:05:47.167103 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: ROLLBACK
17:05:47.167360 [debug] [Thread-8  ]: SQL status: BEGIN in 0.22 seconds
17:05:47.167534 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
17:05:47.167683 [debug] [Thread-8  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seasonid
from "postgres"."public"."wins_losses"
where seasonid is null



      
    ) dbt_internal_test
17:05:47.169250 [debug] [Thread-9  ]: Postgres adapter: Postgres error: relation "public.number_played_against" does not exist
LINE 14:     from "postgres"."public"."number_played_against"
                  ^

17:05:47.169641 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: ROLLBACK
17:05:47.177486 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:05:47.178221 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.04 seconds
17:05:47.180894 [debug] [Thread-6  ]: finished collecting timing info
17:05:47.181489 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: ROLLBACK
17:05:47.182439 [info ] [Thread-1  ]: 1 of 13 PASS not_null_my_first_dbt_model_id .................................... [[32mPASS[0m in 0.29s]
17:05:47.182678 [debug] [Thread-4  ]: finished collecting timing info
17:05:47.182749 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.02 seconds
17:05:47.183009 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:05:47.183112 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: Close
17:05:47.183773 [debug] [Thread-2  ]: finished collecting timing info
17:05:47.183899 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
17:05:47.184122 [debug] [Thread-3  ]: Postgres adapter: Postgres error: relation "public.number_played_against" does not exist
LINE 14: from "postgres"."public"."number_played_against"
              ^

17:05:47.184229 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:05:47.184377 [debug] [Thread-4  ]: Database Error in test not_null_number_played_against_player_id (models/schema.yml)
  relation "public.number_played_against" does not exist
  LINE 14: from "postgres"."public"."number_played_against"
                ^
  compiled SQL at target/run/wrkplay_dbt/models/schema.yml/not_null_number_played_against_player_id.sql
17:05:47.184485 [info ] [Thread-1  ]: 11 of 13 START test positive_test_wins_losses_total_wins ....................... [RUN]
17:05:47.184554 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: ROLLBACK
17:05:47.184668 [error] [Thread-4  ]: 4 of 13 ERROR not_null_number_played_against_player_id ......................... [[31mERROR[0m in 0.29s]
17:05:47.184880 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
17:05:47.185078 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
17:05:47.185154 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
17:05:47.187330 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
17:05:47.187457 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
17:05:47.187565 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
17:05:47.187638 [info ] [Thread-4  ]: 12 of 13 START test unique_my_first_dbt_model_id ............................... [RUN]
17:05:47.187802 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
17:05:47.187860 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
17:05:47.187915 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
17:05:47.190524 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
17:05:47.190781 [debug] [Thread-1  ]: finished collecting timing info
17:05:47.190847 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
17:05:47.191521 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
17:05:47.191591 [debug] [Thread-4  ]: finished collecting timing info
17:05:47.191720 [debug] [Thread-5  ]: finished collecting timing info
17:05:47.191797 [debug] [Thread-9  ]: finished collecting timing info
17:05:47.191888 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
17:05:47.191959 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: Close
17:05:47.192019 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
17:05:47.192081 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: Close
17:05:47.192774 [debug] [Thread-4  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
17:05:47.192866 [debug] [Thread-1  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: BEGIN
17:05:47.193025 [debug] [Thread-5  ]: Database Error in test not_null_number_played_against_season_id (models/schema.yml)
  relation "public.number_played_against" does not exist
  LINE 14: from "postgres"."public"."number_played_against"
                ^
  compiled SQL at target/run/wrkplay_dbt/models/schema.yml/not_null_number_played_against_season_id.sql
17:05:47.193203 [debug] [Thread-9  ]: Database Error in test positive_test_number_played_against_num_played_against (models/schema.yml)
  relation "public.number_played_against" does not exist
  LINE 14:     from "postgres"."public"."number_played_against"
                    ^
  compiled SQL at target/run/wrkplay_dbt/models/schema.yml/positive_test_number_played_against_num_played_against.sql
17:05:47.193283 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:05:47.193393 [error] [Thread-5  ]: 5 of 13 ERROR not_null_number_played_against_season_id ......................... [[31mERROR[0m in 0.30s]
17:05:47.193469 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
17:05:47.193537 [error] [Thread-9  ]: 9 of 13 ERROR positive_test_number_played_against_num_played_against ........... [[31mERROR[0m in 0.30s]
17:05:47.193770 [debug] [Thread-5  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
17:05:47.193829 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:05:47.193952 [debug] [Thread-9  ]: Finished running node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
17:05:47.194026 [debug] [Thread-5  ]: Began running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:05:47.194081 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
17:05:47.194220 [info ] [Thread-5  ]: 13 of 13 START test unique_my_second_dbt_model_id .............................. [RUN]
17:05:47.194463 [debug] [Thread-5  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:05:47.194519 [debug] [Thread-5  ]: Began compiling node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:05:47.194572 [debug] [Thread-5  ]: Compiling test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:05:47.196027 [debug] [Thread-5  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:05:47.196225 [debug] [Thread-5  ]: finished collecting timing info
17:05:47.196288 [debug] [Thread-5  ]: Began executing node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:05:47.196990 [debug] [Thread-5  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:05:47.197057 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.04 seconds
17:05:47.197710 [debug] [Thread-7  ]: finished collecting timing info
17:05:47.197783 [debug] [Thread-7  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: ROLLBACK
17:05:47.197913 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:05:47.197976 [debug] [Thread-5  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:05:47.198027 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
17:05:47.199884 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: Close
17:05:47.200074 [info ] [Thread-6  ]: 6 of 13 PASS not_null_wins_losses_gameid ....................................... [[32mPASS[0m in 0.31s]
17:05:47.200226 [debug] [Thread-6  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
17:05:47.202770 [debug] [Thread-3  ]: finished collecting timing info
17:05:47.202848 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: Close
17:05:47.203021 [debug] [Thread-3  ]: Database Error in test not_null_number_played_against_num_played_against (models/schema.yml)
  relation "public.number_played_against" does not exist
  LINE 14: from "postgres"."public"."number_played_against"
                ^
  compiled SQL at target/run/wrkplay_dbt/models/schema.yml/not_null_number_played_against_num_played_against.sql
17:05:47.203106 [error] [Thread-3  ]: 3 of 13 ERROR not_null_number_played_against_num_played_against ................ [[31mERROR[0m in 0.31s]
17:05:47.203237 [debug] [Thread-3  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
17:05:47.204680 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
17:05:47.204865 [info ] [Thread-2  ]: 2 of 13 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.31s]
17:05:47.205010 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
17:05:47.207299 [debug] [Thread-10 ]: SQL status: SELECT 1 in 0.04 seconds
17:05:47.207879 [debug] [Thread-10 ]: finished collecting timing info
17:05:47.207951 [debug] [Thread-10 ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: ROLLBACK
17:05:47.212428 [debug] [Thread-8  ]: SQL status: SELECT 1 in 0.04 seconds
17:05:47.212918 [debug] [Thread-8  ]: finished collecting timing info
17:05:47.212982 [debug] [Thread-8  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: ROLLBACK
17:05:47.215163 [debug] [Thread-7  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: Close
17:05:47.215424 [info ] [Thread-7  ]: 7 of 13 PASS not_null_wins_losses_player_id .................................... [[32mPASS[0m in 0.32s]
17:05:47.215590 [debug] [Thread-7  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
17:05:47.228273 [debug] [Thread-10 ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: Close
17:05:47.228657 [info ] [Thread-10 ]: 10 of 13 PASS positive_test_wins_losses_total_losses ........................... [[32mPASS[0m in 0.34s]
17:05:47.228867 [debug] [Thread-10 ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
17:05:47.233462 [debug] [Thread-8  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: Close
17:05:47.233758 [info ] [Thread-8  ]: 8 of 13 PASS not_null_wins_losses_seasonid ..................................... [[32mPASS[0m in 0.34s]
17:05:47.233941 [debug] [Thread-8  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
17:05:47.381992 [debug] [Thread-4  ]: SQL status: BEGIN in 0.19 seconds
17:05:47.382657 [debug] [Thread-5  ]: SQL status: BEGIN in 0.18 seconds
17:05:47.383119 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
17:05:47.383433 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:05:47.383641 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:05:47.384143 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
17:05:47.383817 [debug] [Thread-5  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:05:47.384352 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
17:05:47.384592 [debug] [Thread-1  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        total_wins as positive

    from "postgres"."public"."wins_losses"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
17:05:47.402537 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.02 seconds
17:05:47.405664 [debug] [Thread-4  ]: finished collecting timing info
17:05:47.405974 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:05:47.406324 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.02 seconds
17:05:47.407454 [debug] [Thread-5  ]: finished collecting timing info
17:05:47.407573 [debug] [Thread-5  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:05:47.417644 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
17:05:47.419724 [debug] [Thread-1  ]: finished collecting timing info
17:05:47.420005 [debug] [Thread-1  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: ROLLBACK
17:05:47.423556 [debug] [Thread-5  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
17:05:47.424289 [debug] [Thread-4  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: Close
17:05:47.424893 [info ] [Thread-5  ]: 13 of 13 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.23s]
17:05:47.425249 [info ] [Thread-4  ]: 12 of 13 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.24s]
17:05:47.425814 [debug] [Thread-5  ]: Finished running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:05:47.426431 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
17:05:47.437504 [debug] [Thread-1  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: Close
17:05:47.439175 [info ] [Thread-1  ]: 11 of 13 PASS positive_test_wins_losses_total_wins ............................. [[32mPASS[0m in 0.25s]
17:05:47.439822 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
17:05:47.441597 [debug] [MainThread]: Acquiring new postgres connection "master"
17:05:47.441937 [debug] [MainThread]: Using postgres connection "master"
17:05:47.442290 [debug] [MainThread]: On master: BEGIN
17:05:47.442406 [debug] [MainThread]: Opening a new connection, currently in state closed
17:05:47.626250 [debug] [MainThread]: SQL status: BEGIN in 0.18 seconds
17:05:47.627588 [debug] [MainThread]: On master: COMMIT
17:05:47.627904 [debug] [MainThread]: Using postgres connection "master"
17:05:47.628177 [debug] [MainThread]: On master: COMMIT
17:05:47.646928 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:05:47.648294 [debug] [MainThread]: On master: Close
17:05:47.651059 [info ] [MainThread]: 
17:05:47.651362 [info ] [MainThread]: Finished running 13 tests in 1.52s.
17:05:47.651482 [debug] [MainThread]: Connection 'master' was properly closed.
17:05:47.651586 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77' was properly closed.
17:05:47.651638 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:05:47.651694 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c' was properly closed.
17:05:47.651742 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:05:47.651786 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:05:47.651830 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1' was properly closed.
17:05:47.651874 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15' was properly closed.
17:05:47.651919 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813' was properly closed.
17:05:47.651963 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20' was properly closed.
17:05:47.652009 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe' was properly closed.
17:05:47.656644 [info ] [MainThread]: 
17:05:47.656797 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
17:05:47.656927 [info ] [MainThread]: 
17:05:47.657020 [error] [MainThread]: [33mDatabase Error in test not_null_number_played_against_player_id (models/schema.yml)[0m
17:05:47.657110 [error] [MainThread]:   relation "public.number_played_against" does not exist
17:05:47.657193 [error] [MainThread]:   LINE 14: from "postgres"."public"."number_played_against"
17:05:47.657274 [error] [MainThread]:                 ^
17:05:47.657356 [error] [MainThread]:   compiled SQL at target/run/wrkplay_dbt/models/schema.yml/not_null_number_played_against_player_id.sql
17:05:47.657440 [info ] [MainThread]: 
17:05:47.657522 [error] [MainThread]: [33mDatabase Error in test not_null_number_played_against_season_id (models/schema.yml)[0m
17:05:47.657602 [error] [MainThread]:   relation "public.number_played_against" does not exist
17:05:47.657681 [error] [MainThread]:   LINE 14: from "postgres"."public"."number_played_against"
17:05:47.657758 [error] [MainThread]:                 ^
17:05:47.657836 [error] [MainThread]:   compiled SQL at target/run/wrkplay_dbt/models/schema.yml/not_null_number_played_against_season_id.sql
17:05:47.657914 [info ] [MainThread]: 
17:05:47.657995 [error] [MainThread]: [33mDatabase Error in test positive_test_number_played_against_num_played_against (models/schema.yml)[0m
17:05:47.658077 [error] [MainThread]:   relation "public.number_played_against" does not exist
17:05:47.658154 [error] [MainThread]:   LINE 14:     from "postgres"."public"."number_played_against"
17:05:47.658231 [error] [MainThread]:                     ^
17:05:47.658309 [error] [MainThread]:   compiled SQL at target/run/wrkplay_dbt/models/schema.yml/positive_test_number_played_against_num_played_against.sql
17:05:47.658388 [info ] [MainThread]: 
17:05:47.658469 [error] [MainThread]: [33mDatabase Error in test not_null_number_played_against_num_played_against (models/schema.yml)[0m
17:05:47.658546 [error] [MainThread]:   relation "public.number_played_against" does not exist
17:05:47.658624 [error] [MainThread]:   LINE 14: from "postgres"."public"."number_played_against"
17:05:47.658701 [error] [MainThread]:                 ^
17:05:47.658778 [error] [MainThread]:   compiled SQL at target/run/wrkplay_dbt/models/schema.yml/not_null_number_played_against_num_played_against.sql
17:05:47.658867 [info ] [MainThread]: 
17:05:47.658953 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=4 SKIP=0 TOTAL=13
17:05:47.659087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a69fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a82d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b02400>]}


============================== 2022-07-08 17:06:03.663652 | 0cef9c6d-0461-4011-94ac-a41eb6aa48dd ==============================
17:06:03.663670 [info ] [MainThread]: Running with dbt=1.1.1
17:06:03.664183 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:06:03.664263 [debug] [MainThread]: Tracking: tracking
17:06:03.679175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f5dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f5dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f5dc10>]}
17:06:03.698085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:06:03.698192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:06:03.701582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cef9c6d-0461-4011-94ac-a41eb6aa48dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10413d0d0>]}
17:06:03.704447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cef9c6d-0461-4011-94ac-a41eb6aa48dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408e040>]}
17:06:03.704579 [info ] [MainThread]: Found 4 models, 13 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:06:03.704701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cef9c6d-0461-4011-94ac-a41eb6aa48dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410bca0>]}
17:06:03.705460 [info ] [MainThread]: 
17:06:03.705657 [debug] [MainThread]: Acquiring new postgres connection "master"
17:06:03.706065 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
17:06:03.710379 [debug] [ThreadPool]: Using postgres connection "list_postgres"
17:06:03.710462 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
17:06:03.710524 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:06:03.914099 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.2 seconds
17:06:03.915595 [debug] [ThreadPool]: On list_postgres: Close
17:06:03.916508 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
17:06:03.919619 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:06:03.919704 [debug] [ThreadPool]: On list_postgres_public: BEGIN
17:06:03.919765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:06:04.119329 [debug] [ThreadPool]: SQL status: BEGIN in 0.2 seconds
17:06:04.120231 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:06:04.121086 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:06:04.145124 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
17:06:04.149533 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
17:06:04.168568 [debug] [ThreadPool]: On list_postgres_public: Close
17:06:04.174667 [debug] [MainThread]: Using postgres connection "master"
17:06:04.174836 [debug] [MainThread]: On master: BEGIN
17:06:04.174898 [debug] [MainThread]: Opening a new connection, currently in state init
17:06:04.351304 [debug] [MainThread]: SQL status: BEGIN in 0.18 seconds
17:06:04.352142 [debug] [MainThread]: Using postgres connection "master"
17:06:04.352340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:06:04.526271 [debug] [MainThread]: SQL status: SELECT 4 in 0.17 seconds
17:06:04.528782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cef9c6d-0461-4011-94ac-a41eb6aa48dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104114be0>]}
17:06:04.529303 [debug] [MainThread]: On master: ROLLBACK
17:06:04.547281 [debug] [MainThread]: Using postgres connection "master"
17:06:04.547746 [debug] [MainThread]: On master: BEGIN
17:06:04.581950 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
17:06:04.582407 [debug] [MainThread]: On master: COMMIT
17:06:04.582587 [debug] [MainThread]: Using postgres connection "master"
17:06:04.582748 [debug] [MainThread]: On master: COMMIT
17:06:04.601703 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:06:04.602212 [debug] [MainThread]: On master: Close
17:06:04.602977 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:06:04.603353 [info ] [MainThread]: 
17:06:04.607934 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.my_first_dbt_model
17:06:04.608043 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.number_played_against
17:06:04.608112 [debug] [Thread-3  ]: Began running node model.wrkplay_dbt.wins_losses
17:06:04.608288 [info ] [Thread-1  ]: 1 of 4 START view model public.my_first_dbt_model .............................. [RUN]
17:06:04.608423 [info ] [Thread-2  ]: 2 of 4 START view model public.number_played_against ........................... [RUN]
17:06:04.608522 [info ] [Thread-3  ]: 3 of 4 START view model public.wins_losses ..................................... [RUN]
17:06:04.608800 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_first_dbt_model"
17:06:04.609008 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.number_played_against"
17:06:04.609208 [debug] [Thread-3  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
17:06:04.609284 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.my_first_dbt_model
17:06:04.609353 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.number_played_against
17:06:04.609412 [debug] [Thread-3  ]: Began compiling node model.wrkplay_dbt.wins_losses
17:06:04.609528 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.my_first_dbt_model
17:06:04.609587 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.number_played_against
17:06:04.609648 [debug] [Thread-3  ]: Compiling model.wrkplay_dbt.wins_losses
17:06:04.611009 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.my_first_dbt_model"
17:06:04.611582 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.number_played_against"
17:06:04.612210 [debug] [Thread-3  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
17:06:04.612765 [debug] [Thread-1  ]: finished collecting timing info
17:06:04.612820 [debug] [Thread-3  ]: finished collecting timing info
17:06:04.612869 [debug] [Thread-2  ]: finished collecting timing info
17:06:04.612940 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.my_first_dbt_model
17:06:04.613015 [debug] [Thread-3  ]: Began executing node model.wrkplay_dbt.wins_losses
17:06:04.613076 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.number_played_against
17:06:04.624657 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_first_dbt_model"
17:06:04.625914 [debug] [Thread-3  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
17:06:04.626943 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.number_played_against"
17:06:04.627325 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:06:04.627408 [debug] [Thread-3  ]: On model.wrkplay_dbt.wins_losses: BEGIN
17:06:04.627493 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
17:06:04.627555 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:06:04.627745 [debug] [Thread-2  ]: On model.wrkplay_dbt.number_played_against: BEGIN
17:06:04.627684 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: BEGIN
17:06:04.627615 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:06:04.627800 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:06:04.627857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:06:04.810051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
17:06:04.810936 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
17:06:04.811626 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */

  create view "postgres"."public"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
17:06:04.814507 [debug] [Thread-3  ]: SQL status: BEGIN in 0.19 seconds
17:06:04.815220 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:06:04.815399 [debug] [Thread-3  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */

  create view "postgres"."public"."wins_losses__dbt_tmp" as (
    --number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
17:06:04.821928 [debug] [Thread-2  ]: SQL status: BEGIN in 0.19 seconds
17:06:04.822749 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:06:04.822981 [debug] [Thread-2  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */

  create view "postgres"."public"."number_played_against__dbt_tmp" as (
    -- gets the number of players a player has played against or with per season
SELECT
	c."b1" AS "player_id"
	, c."season_id" AS "season_id"
	, count(DISTINCT c."b2") AS "num_played_against"
FROM
	(
		WITH all_players AS (
			SELECT
				l."A" AS "match_id"
				, l."B" AS "player_id"
				, s.slug AS "season_id"
			FROM
				"_left" l
			JOIN "Match" m ON l."A" = m.id 
			JOIN "Season" s ON m.seasonid = s.id 
		UNION ALL
			SELECT
				r."A" AS "r_A"
				, r."B" AS "r_B"
				, s.slug AS "r_season_id"
			FROM
				"_right" r
			JOIN "Match" m ON r."A" = m.id 
			JOIN "Season" s ON m.seasonid = s.id 
		)
		SELECT
			a1."player_id" AS "b1"
			, a2."player_id" AS "b2"
			, a1."season_id" AS "season_id"
		FROM
			all_players a1
		JOIN all_players a2 ON
			a1."match_id" = a2."match_id"
	) c
WHERE
	c."b1" <> c."b2"
GROUP BY
	c."b1"
	, c."season_id"
  );
17:06:04.832674 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
17:06:04.839942 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
17:06:04.840134 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:06:04.845781 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.03 seconds
17:06:04.846866 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:06:04.846944 [debug] [Thread-3  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses" rename to "wins_losses__dbt_backup"
17:06:04.847167 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.02 seconds
17:06:04.848002 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:06:04.848077 [debug] [Thread-2  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
alter table "postgres"."public"."number_played_against__dbt_tmp" rename to "number_played_against"
17:06:04.857982 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
17:06:04.861153 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
17:06:04.861531 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:06:04.868511 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.02 seconds
17:06:04.868720 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
17:06:04.871831 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:06:04.875276 [debug] [Thread-2  ]: On model.wrkplay_dbt.number_played_against: COMMIT
17:06:04.875413 [debug] [Thread-3  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
17:06:04.875482 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:06:04.875579 [debug] [Thread-2  ]: On model.wrkplay_dbt.number_played_against: COMMIT
17:06:04.880193 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
17:06:04.880687 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
17:06:04.880750 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
17:06:04.880801 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: COMMIT
17:06:04.894488 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.02 seconds
17:06:04.896520 [debug] [Thread-3  ]: On model.wrkplay_dbt.wins_losses: COMMIT
17:06:04.896834 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:06:04.896998 [debug] [Thread-3  ]: On model.wrkplay_dbt.wins_losses: COMMIT
17:06:04.897243 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
17:06:04.903203 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:06:04.903305 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
17:06:04.903364 [debug] [Thread-2  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
drop view if exists "postgres"."public"."number_played_against__dbt_backup" cascade
17:06:04.904185 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.my_first_dbt_model"
17:06:04.904323 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_first_dbt_model"} */
drop view if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
17:06:04.916053 [debug] [Thread-3  ]: SQL status: COMMIT in 0.02 seconds
17:06:04.918470 [debug] [Thread-3  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:06:04.918753 [debug] [Thread-3  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop view if exists "postgres"."public"."wins_losses__dbt_backup" cascade
17:06:04.932151 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.03 seconds
17:06:04.932514 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.03 seconds
17:06:04.935505 [debug] [Thread-1  ]: finished collecting timing info
17:06:04.938670 [debug] [Thread-2  ]: finished collecting timing info
17:06:04.939301 [debug] [Thread-1  ]: On model.wrkplay_dbt.my_first_dbt_model: Close
17:06:04.939450 [debug] [Thread-2  ]: On model.wrkplay_dbt.number_played_against: Close
17:06:04.939855 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cef9c6d-0461-4011-94ac-a41eb6aa48dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104203b50>]}
17:06:04.940098 [info ] [Thread-2  ]: 2 of 4 OK created view model public.number_played_against ...................... [[32mCREATE VIEW[0m in 0.33s]
17:06:04.940376 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.number_played_against
17:06:04.940636 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cef9c6d-0461-4011-94ac-a41eb6aa48dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104227ac0>]}
17:06:04.940758 [info ] [Thread-1  ]: 1 of 4 OK created view model public.my_first_dbt_model ......................... [[32mCREATE VIEW[0m in 0.33s]
17:06:04.940898 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.my_first_dbt_model
17:06:04.941093 [debug] [Thread-5  ]: Began running node model.wrkplay_dbt.my_second_dbt_model
17:06:04.941198 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
17:06:04.941380 [debug] [Thread-5  ]: Acquiring new postgres connection "model.wrkplay_dbt.my_second_dbt_model"
17:06:04.941449 [debug] [Thread-5  ]: Began compiling node model.wrkplay_dbt.my_second_dbt_model
17:06:04.941525 [debug] [Thread-5  ]: Compiling model.wrkplay_dbt.my_second_dbt_model
17:06:04.942789 [debug] [Thread-5  ]: Writing injected SQL for node "model.wrkplay_dbt.my_second_dbt_model"
17:06:04.943251 [debug] [Thread-5  ]: finished collecting timing info
17:06:04.943318 [debug] [Thread-5  ]: Began executing node model.wrkplay_dbt.my_second_dbt_model
17:06:04.944608 [debug] [Thread-5  ]: Writing runtime SQL for node "model.wrkplay_dbt.my_second_dbt_model"
17:06:04.944836 [debug] [Thread-5  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
17:06:04.944894 [debug] [Thread-5  ]: On model.wrkplay_dbt.my_second_dbt_model: BEGIN
17:06:04.944946 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:06:04.948851 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.03 seconds
17:06:04.949325 [debug] [Thread-3  ]: finished collecting timing info
17:06:04.949396 [debug] [Thread-3  ]: On model.wrkplay_dbt.wins_losses: Close
17:06:04.949599 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cef9c6d-0461-4011-94ac-a41eb6aa48dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104203bb0>]}
17:06:04.949726 [info ] [Thread-3  ]: 3 of 4 OK created view model public.wins_losses ................................ [[32mCREATE VIEW[0m in 0.34s]
17:06:04.949881 [debug] [Thread-3  ]: Finished running node model.wrkplay_dbt.wins_losses
17:06:05.152596 [debug] [Thread-5  ]: SQL status: BEGIN in 0.21 seconds
17:06:05.153196 [debug] [Thread-5  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
17:06:05.153454 [debug] [Thread-5  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
17:06:05.174640 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.02 seconds
17:06:05.180346 [debug] [Thread-5  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
17:06:05.180514 [debug] [Thread-5  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:06:05.198997 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.02 seconds
17:06:05.201885 [debug] [Thread-5  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
17:06:05.202213 [debug] [Thread-5  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
17:06:05.202630 [debug] [Thread-5  ]: On model.wrkplay_dbt.my_second_dbt_model: COMMIT
17:06:05.222363 [debug] [Thread-5  ]: SQL status: COMMIT in 0.02 seconds
17:06:05.252333 [debug] [Thread-5  ]: Using postgres connection "model.wrkplay_dbt.my_second_dbt_model"
17:06:05.252520 [debug] [Thread-5  ]: On model.wrkplay_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
17:06:05.270319 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.02 seconds
17:06:05.271071 [debug] [Thread-5  ]: finished collecting timing info
17:06:05.288918 [debug] [Thread-5  ]: On model.wrkplay_dbt.my_second_dbt_model: Close
17:06:05.289298 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cef9c6d-0461-4011-94ac-a41eb6aa48dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a6d30>]}
17:06:05.289853 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.35s]
17:06:05.290047 [debug] [Thread-5  ]: Finished running node model.wrkplay_dbt.my_second_dbt_model
17:06:05.290720 [debug] [MainThread]: Acquiring new postgres connection "master"
17:06:05.290820 [debug] [MainThread]: Using postgres connection "master"
17:06:05.290878 [debug] [MainThread]: On master: BEGIN
17:06:05.290929 [debug] [MainThread]: Opening a new connection, currently in state closed
17:06:05.484680 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
17:06:05.485891 [debug] [MainThread]: On master: COMMIT
17:06:05.486283 [debug] [MainThread]: Using postgres connection "master"
17:06:05.486637 [debug] [MainThread]: On master: COMMIT
17:06:05.507289 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:06:05.508187 [debug] [MainThread]: On master: Close
17:06:05.510208 [info ] [MainThread]: 
17:06:05.510727 [info ] [MainThread]: Finished running 4 view models in 1.80s.
17:06:05.511221 [debug] [MainThread]: Connection 'master' was properly closed.
17:06:05.511293 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_first_dbt_model' was properly closed.
17:06:05.511345 [debug] [MainThread]: Connection 'model.wrkplay_dbt.number_played_against' was properly closed.
17:06:05.511393 [debug] [MainThread]: Connection 'model.wrkplay_dbt.wins_losses' was properly closed.
17:06:05.511440 [debug] [MainThread]: Connection 'model.wrkplay_dbt.my_second_dbt_model' was properly closed.
17:06:05.515967 [info ] [MainThread]: 
17:06:05.516094 [info ] [MainThread]: [32mCompleted successfully[0m
17:06:05.516211 [info ] [MainThread]: 
17:06:05.516298 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
17:06:05.516461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee3d30>]}


============================== 2022-07-08 17:06:24.181541 | 9ef5d166-fa36-4c6c-a92a-178af698cc53 ==============================
17:06:24.181565 [info ] [MainThread]: Running with dbt=1.1.1
17:06:24.182135 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:06:24.182211 [debug] [MainThread]: Tracking: tracking
17:06:24.201045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d45af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d45c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d45c40>]}
17:06:24.219331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:06:24.219448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:06:24.222806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ef5d166-fa36-4c6c-a92a-178af698cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f250d0>]}
17:06:24.225914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ef5d166-fa36-4c6c-a92a-178af698cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e76070>]}
17:06:24.226049 [info ] [MainThread]: Found 4 models, 13 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:06:24.226179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef5d166-fa36-4c6c-a92a-178af698cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef3cd0>]}
17:06:24.227088 [info ] [MainThread]: 
17:06:24.227293 [debug] [MainThread]: Acquiring new postgres connection "master"
17:06:24.227764 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
17:06:24.232472 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:06:24.232646 [debug] [ThreadPool]: On list_postgres_public: BEGIN
17:06:24.232722 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:06:24.435445 [debug] [ThreadPool]: SQL status: BEGIN in 0.2 seconds
17:06:24.435790 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:06:24.435865 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:06:24.459113 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.02 seconds
17:06:24.463504 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
17:06:24.481169 [debug] [ThreadPool]: On list_postgres_public: Close
17:06:24.488452 [debug] [MainThread]: Using postgres connection "master"
17:06:24.488614 [debug] [MainThread]: On master: BEGIN
17:06:24.488678 [debug] [MainThread]: Opening a new connection, currently in state init
17:06:24.682230 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
17:06:24.683639 [debug] [MainThread]: Using postgres connection "master"
17:06:24.684022 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:06:24.858913 [debug] [MainThread]: SQL status: SELECT 8 in 0.17 seconds
17:06:24.859803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef5d166-fa36-4c6c-a92a-178af698cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104efccd0>]}
17:06:24.859992 [debug] [MainThread]: On master: ROLLBACK
17:06:24.878499 [debug] [MainThread]: Using postgres connection "master"
17:06:24.878644 [debug] [MainThread]: On master: BEGIN
17:06:24.917116 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
17:06:24.917714 [debug] [MainThread]: On master: COMMIT
17:06:24.918096 [debug] [MainThread]: Using postgres connection "master"
17:06:24.918421 [debug] [MainThread]: On master: COMMIT
17:06:24.937707 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:06:24.938509 [debug] [MainThread]: On master: Close
17:06:24.940148 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:06:24.940744 [info ] [MainThread]: 
17:06:24.945242 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:06:24.945398 [info ] [Thread-1  ]: 1 of 13 START test not_null_my_first_dbt_model_id .............................. [RUN]
17:06:24.945645 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:06:24.945721 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:06:24.945836 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:06:24.951832 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:06:24.951939 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
17:06:24.952028 [debug] [Thread-3  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
17:06:24.952082 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
17:06:24.952162 [debug] [Thread-5  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
17:06:24.952228 [info ] [Thread-2  ]: 2 of 13 START test not_null_my_second_dbt_model_id ............................. [RUN]
17:06:24.952281 [debug] [Thread-6  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
17:06:24.952357 [debug] [Thread-7  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
17:06:24.952436 [debug] [Thread-8  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
17:06:24.952492 [debug] [Thread-9  ]: Began running node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
17:06:24.952563 [debug] [Thread-10 ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
17:06:24.952612 [info ] [Thread-3  ]: 3 of 13 START test not_null_number_played_against_num_played_against ........... [RUN]
17:06:24.952667 [debug] [Thread-1  ]: finished collecting timing info
17:06:24.952741 [info ] [Thread-4  ]: 4 of 13 START test not_null_number_played_against_player_id .................... [RUN]
17:06:24.952813 [info ] [Thread-5  ]: 5 of 13 START test not_null_number_played_against_season_id .................... [RUN]
17:06:24.953061 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:06:24.953133 [info ] [Thread-6  ]: 6 of 13 START test not_null_wins_losses_gameid ................................. [RUN]
17:06:24.953204 [info ] [Thread-7  ]: 7 of 13 START test not_null_wins_losses_player_id .............................. [RUN]
17:06:24.953269 [info ] [Thread-8  ]: 8 of 13 START test not_null_wins_losses_seasonid ............................... [RUN]
17:06:24.953334 [info ] [Thread-9  ]: 9 of 13 START test positive_test_number_played_against_num_played_against ...... [RUN]
17:06:24.953397 [info ] [Thread-10 ]: 10 of 13 START test positive_test_wins_losses_total_losses ..................... [RUN]
17:06:24.953566 [debug] [Thread-3  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
17:06:24.953636 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:06:24.953832 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
17:06:24.953976 [debug] [Thread-5  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
17:06:24.954035 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
17:06:24.954181 [debug] [Thread-6  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
17:06:24.954340 [debug] [Thread-7  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
17:06:24.954489 [debug] [Thread-8  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
17:06:24.954652 [debug] [Thread-9  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
17:06:24.954796 [debug] [Thread-10 ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
17:06:24.954853 [debug] [Thread-3  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
17:06:24.961561 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:06:24.961656 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
17:06:24.961730 [debug] [Thread-5  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
17:06:24.961805 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
17:06:24.961868 [debug] [Thread-6  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
17:06:24.961931 [debug] [Thread-7  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
17:06:24.961990 [debug] [Thread-8  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
17:06:24.962052 [debug] [Thread-9  ]: Began compiling node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
17:06:24.962111 [debug] [Thread-10 ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
17:06:24.962165 [debug] [Thread-3  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
17:06:24.962254 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
17:06:24.962328 [debug] [Thread-5  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
17:06:24.964211 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:06:24.964299 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:06:24.964371 [debug] [Thread-6  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
17:06:24.964441 [debug] [Thread-7  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
17:06:24.964504 [debug] [Thread-8  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
17:06:24.964563 [debug] [Thread-9  ]: Compiling test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
17:06:24.964620 [debug] [Thread-10 ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
17:06:24.966067 [debug] [Thread-3  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
17:06:24.967446 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
17:06:24.968792 [debug] [Thread-5  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
17:06:24.968902 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:06:24.970303 [debug] [Thread-6  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
17:06:24.971658 [debug] [Thread-7  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
17:06:24.973021 [debug] [Thread-8  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
17:06:24.973080 [debug] [Thread-2  ]: finished collecting timing info
17:06:24.974804 [debug] [Thread-9  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
17:06:24.976044 [debug] [Thread-10 ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
17:06:24.976337 [debug] [Thread-3  ]: finished collecting timing info
17:06:24.976417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:06:24.976486 [debug] [Thread-4  ]: finished collecting timing info
17:06:24.976583 [debug] [Thread-5  ]: finished collecting timing info
17:06:24.976789 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
17:06:24.976851 [debug] [Thread-7  ]: finished collecting timing info
17:06:24.976910 [debug] [Thread-6  ]: finished collecting timing info
17:06:24.976996 [debug] [Thread-8  ]: finished collecting timing info
17:06:24.977099 [debug] [Thread-3  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
17:06:24.977147 [debug] [Thread-9  ]: finished collecting timing info
17:06:24.977279 [debug] [Thread-10 ]: finished collecting timing info
17:06:24.977339 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
17:06:24.977412 [debug] [Thread-5  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
17:06:24.978129 [debug] [Thread-2  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:06:24.978204 [debug] [Thread-7  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
17:06:24.978275 [debug] [Thread-6  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
17:06:24.978338 [debug] [Thread-8  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
17:06:24.978989 [debug] [Thread-3  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
17:06:24.979060 [debug] [Thread-9  ]: Began executing node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
17:06:24.979129 [debug] [Thread-10 ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
17:06:24.979771 [debug] [Thread-4  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
17:06:24.980427 [debug] [Thread-5  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
17:06:24.981657 [debug] [Thread-7  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
17:06:24.982269 [debug] [Thread-6  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
17:06:25.009067 [debug] [Thread-8  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
17:06:25.009226 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:06:25.010157 [debug] [Thread-9  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
17:06:25.010887 [debug] [Thread-10 ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
17:06:25.011233 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
17:06:25.011412 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
17:06:25.011562 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
17:06:25.011726 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:06:25.011825 [debug] [Thread-6  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
17:06:25.011906 [debug] [Thread-7  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
17:06:25.012042 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
17:06:25.012208 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: BEGIN
17:06:25.012267 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
17:06:25.012350 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: BEGIN
17:06:25.012499 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: BEGIN
17:06:25.012564 [debug] [Thread-10 ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
17:06:25.012634 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:06:25.012785 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: BEGIN
17:06:25.012840 [debug] [Thread-7  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: BEGIN
17:06:25.012898 [debug] [Thread-8  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: BEGIN
17:06:25.012961 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:06:25.013054 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: BEGIN
17:06:25.013113 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:06:25.013167 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:06:25.013223 [debug] [Thread-10 ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: BEGIN
17:06:25.013360 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:06:25.013461 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:06:25.013539 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:06:25.013676 [debug] [Thread-9  ]: Opening a new connection, currently in state init
17:06:25.013839 [debug] [Thread-10 ]: Opening a new connection, currently in state init
17:06:25.187006 [debug] [Thread-1  ]: SQL status: BEGIN in 0.21 seconds
17:06:25.187295 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
17:06:25.187367 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:06:25.208492 [debug] [Thread-5  ]: SQL status: BEGIN in 0.2 seconds
17:06:25.208621 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
17:06:25.208683 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season_id
from "postgres"."public"."number_played_against"
where season_id is null



      
    ) dbt_internal_test
17:06:25.209694 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
17:06:25.211066 [debug] [Thread-1  ]: finished collecting timing info
17:06:25.211195 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:06:25.212470 [debug] [Thread-3  ]: SQL status: BEGIN in 0.2 seconds
17:06:25.212550 [debug] [Thread-9  ]: SQL status: BEGIN in 0.2 seconds
17:06:25.212642 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
17:06:25.212712 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
17:06:25.212774 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select num_played_against
from "postgres"."public"."number_played_against"
where num_played_against is null



      
    ) dbt_internal_test
17:06:25.212832 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        num_played_against as positive

    from "postgres"."public"."number_played_against"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
17:06:25.219250 [debug] [Thread-10 ]: SQL status: BEGIN in 0.21 seconds
17:06:25.219404 [debug] [Thread-10 ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
17:06:25.219463 [debug] [Thread-10 ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        total_losses as positive

    from "postgres"."public"."wins_losses"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
17:06:25.223837 [debug] [Thread-6  ]: SQL status: BEGIN in 0.21 seconds
17:06:25.224535 [debug] [Thread-6  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
17:06:25.224715 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gameid
from "postgres"."public"."wins_losses"
where gameid is null



      
    ) dbt_internal_test
17:06:25.229717 [debug] [Thread-2  ]: SQL status: BEGIN in 0.22 seconds
17:06:25.230320 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"
17:06:25.230577 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:06:25.231442 [debug] [Thread-7  ]: SQL status: BEGIN in 0.22 seconds
17:06:25.231796 [debug] [Thread-7  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
17:06:25.231955 [debug] [Thread-7  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from "postgres"."public"."wins_losses"
where player_id is null



      
    ) dbt_internal_test
17:06:25.232283 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:06:25.233640 [info ] [Thread-1  ]: 1 of 13 PASS not_null_my_first_dbt_model_id .................................... [[32mPASS[0m in 0.29s]
17:06:25.234745 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.not_null_my_first_dbt_model_id.5fb22c2710
17:06:25.235218 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
17:06:25.235608 [debug] [Thread-8  ]: SQL status: BEGIN in 0.22 seconds
17:06:25.235863 [info ] [Thread-1  ]: 11 of 13 START test positive_test_wins_losses_total_wins ....................... [RUN]
17:06:25.236061 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
17:06:25.236558 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
17:06:25.236678 [debug] [Thread-8  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seasonid
from "postgres"."public"."wins_losses"
where seasonid is null



      
    ) dbt_internal_test
17:06:25.236766 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
17:06:25.236840 [debug] [Thread-4  ]: SQL status: BEGIN in 0.22 seconds
17:06:25.236964 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
17:06:25.237025 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
17:06:25.239370 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
17:06:25.239503 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from "postgres"."public"."number_played_against"
where player_id is null



      
    ) dbt_internal_test
17:06:25.239835 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.03 seconds
17:06:25.240721 [debug] [Thread-5  ]: finished collecting timing info
17:06:25.240810 [debug] [Thread-1  ]: finished collecting timing info
17:06:25.240877 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: ROLLBACK
17:06:25.240949 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
17:06:25.241880 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
17:06:25.242186 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
17:06:25.242266 [debug] [Thread-1  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: BEGIN
17:06:25.242322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:06:25.249741 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.02 seconds
17:06:25.250357 [debug] [Thread-2  ]: finished collecting timing info
17:06:25.250430 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:06:25.269830 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: Close
17:06:25.270960 [info ] [Thread-5  ]: 5 of 13 PASS not_null_number_played_against_season_id .......................... [[32mPASS[0m in 0.32s]
17:06:25.271559 [debug] [Thread-5  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
17:06:25.273798 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
17:06:25.282081 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.04 seconds
17:06:25.289331 [debug] [Thread-5  ]: Began running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
17:06:25.290343 [debug] [Thread-4  ]: finished collecting timing info
17:06:25.290551 [info ] [Thread-2  ]: 2 of 13 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.34s]
17:06:25.290630 [info ] [Thread-5  ]: 12 of 13 START test unique_my_first_dbt_model_id ............................... [RUN]
17:06:25.290715 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: ROLLBACK
17:06:25.290882 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.not_null_my_second_dbt_model_id.151b76d778
17:06:25.291072 [debug] [Thread-5  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
17:06:25.291189 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:06:25.291255 [debug] [Thread-5  ]: Began compiling node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
17:06:25.291350 [info ] [Thread-2  ]: 13 of 13 START test unique_my_second_dbt_model_id .............................. [RUN]
17:06:25.291426 [debug] [Thread-5  ]: Compiling test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
17:06:25.291592 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:06:25.294512 [debug] [Thread-5  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
17:06:25.294626 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:06:25.294762 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:06:25.296208 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:06:25.296419 [debug] [Thread-5  ]: finished collecting timing info
17:06:25.296478 [debug] [Thread-2  ]: finished collecting timing info
17:06:25.296544 [debug] [Thread-5  ]: Began executing node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
17:06:25.296607 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:06:25.297302 [debug] [Thread-5  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
17:06:25.297914 [debug] [Thread-2  ]: Writing runtime SQL for node "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:06:25.298296 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
17:06:25.298359 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:06:25.298422 [debug] [Thread-5  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:06:25.298485 [debug] [Thread-2  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:06:25.298544 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
17:06:25.298606 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:06:25.301593 [debug] [Thread-10 ]: SQL status: SELECT 1 in 0.08 seconds
17:06:25.301654 [debug] [Thread-8  ]: SQL status: SELECT 1 in 0.06 seconds
17:06:25.302400 [debug] [Thread-10 ]: finished collecting timing info
17:06:25.302969 [debug] [Thread-8  ]: finished collecting timing info
17:06:25.303055 [debug] [Thread-10 ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: ROLLBACK
17:06:25.303129 [debug] [Thread-8  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: ROLLBACK
17:06:25.305854 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.08 seconds
17:06:25.305916 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.07 seconds
17:06:25.306482 [debug] [Thread-6  ]: finished collecting timing info
17:06:25.307019 [debug] [Thread-7  ]: finished collecting timing info
17:06:25.307107 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: ROLLBACK
17:06:25.307177 [debug] [Thread-7  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: ROLLBACK
17:06:25.312115 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: Close
17:06:25.312432 [info ] [Thread-4  ]: 4 of 13 PASS not_null_number_played_against_player_id .......................... [[32mPASS[0m in 0.36s]
17:06:25.312664 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
17:06:25.317402 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.1 seconds
17:06:25.318137 [debug] [Thread-3  ]: finished collecting timing info
17:06:25.318245 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: ROLLBACK
17:06:25.324452 [debug] [Thread-8  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: Close
17:06:25.324562 [debug] [Thread-10 ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: Close
17:06:25.324890 [info ] [Thread-8  ]: 8 of 13 PASS not_null_wins_losses_seasonid ..................................... [[32mPASS[0m in 0.37s]
17:06:25.325001 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: Close
17:06:25.325258 [debug] [Thread-8  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
17:06:25.325478 [info ] [Thread-10 ]: 10 of 13 PASS positive_test_wins_losses_total_losses ........................... [[32mPASS[0m in 0.37s]
17:06:25.325806 [info ] [Thread-6  ]: 6 of 13 PASS not_null_wins_losses_gameid ....................................... [[32mPASS[0m in 0.37s]
17:06:25.325977 [debug] [Thread-10 ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
17:06:25.326240 [debug] [Thread-6  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
17:06:25.326566 [debug] [Thread-7  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: Close
17:06:25.326824 [info ] [Thread-7  ]: 7 of 13 PASS not_null_wins_losses_player_id .................................... [[32mPASS[0m in 0.37s]
17:06:25.326988 [debug] [Thread-7  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
17:06:25.334122 [debug] [Thread-9  ]: SQL status: SELECT 1 in 0.12 seconds
17:06:25.334931 [debug] [Thread-9  ]: finished collecting timing info
17:06:25.335036 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: ROLLBACK
17:06:25.337065 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: Close
17:06:25.337376 [info ] [Thread-3  ]: 3 of 13 PASS not_null_number_played_against_num_played_against ................. [[32mPASS[0m in 0.38s]
17:06:25.337578 [debug] [Thread-3  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
17:06:25.354129 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: Close
17:06:25.354462 [info ] [Thread-9  ]: 9 of 13 PASS positive_test_number_played_against_num_played_against ............ [[32mPASS[0m in 0.40s]
17:06:25.354653 [debug] [Thread-9  ]: Finished running node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
17:06:25.468921 [debug] [Thread-5  ]: SQL status: BEGIN in 0.17 seconds
17:06:25.469517 [debug] [Thread-1  ]: SQL status: BEGIN in 0.23 seconds
17:06:25.469973 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"
17:06:25.470166 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
17:06:25.470386 [debug] [Thread-5  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:06:25.470573 [debug] [Thread-1  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        total_wins as positive

    from "postgres"."public"."wins_losses"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
17:06:25.489038 [debug] [Thread-2  ]: SQL status: BEGIN in 0.19 seconds
17:06:25.489757 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"
17:06:25.489979 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.02 seconds
17:06:25.490217 [debug] [Thread-2  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:06:25.493405 [debug] [Thread-5  ]: finished collecting timing info
17:06:25.493891 [debug] [Thread-5  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:06:25.503432 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
17:06:25.508224 [debug] [Thread-1  ]: finished collecting timing info
17:06:25.508384 [debug] [Thread-1  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: ROLLBACK
17:06:25.512162 [debug] [Thread-5  ]: On test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321: Close
17:06:25.513887 [info ] [Thread-5  ]: 12 of 13 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.22s]
17:06:25.514716 [debug] [Thread-5  ]: Finished running node test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321
17:06:25.514900 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.02 seconds
17:06:25.516297 [debug] [Thread-2  ]: finished collecting timing info
17:06:25.516444 [debug] [Thread-2  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:06:25.526213 [debug] [Thread-1  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: Close
17:06:25.527850 [info ] [Thread-1  ]: 11 of 13 PASS positive_test_wins_losses_total_wins ............................. [[32mPASS[0m in 0.29s]
17:06:25.528588 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
17:06:25.535342 [debug] [Thread-2  ]: On test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
17:06:25.537076 [info ] [Thread-2  ]: 13 of 13 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.25s]
17:06:25.538258 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493
17:06:25.542352 [debug] [MainThread]: Acquiring new postgres connection "master"
17:06:25.542698 [debug] [MainThread]: Using postgres connection "master"
17:06:25.542878 [debug] [MainThread]: On master: BEGIN
17:06:25.543037 [debug] [MainThread]: Opening a new connection, currently in state closed
17:06:25.731414 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
17:06:25.732435 [debug] [MainThread]: On master: COMMIT
17:06:25.732795 [debug] [MainThread]: Using postgres connection "master"
17:06:25.733139 [debug] [MainThread]: On master: COMMIT
17:06:25.751737 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:06:25.752463 [debug] [MainThread]: On master: Close
17:06:25.754521 [info ] [MainThread]: 
17:06:25.754823 [info ] [MainThread]: Finished running 13 tests in 1.53s.
17:06:25.754945 [debug] [MainThread]: Connection 'master' was properly closed.
17:06:25.755005 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77' was properly closed.
17:06:25.755064 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:06:25.755118 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c' was properly closed.
17:06:25.755166 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427' was properly closed.
17:06:25.755213 [debug] [MainThread]: Connection 'test.wrkplay_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:06:25.755260 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1' was properly closed.
17:06:25.755306 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15' was properly closed.
17:06:25.755351 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813' was properly closed.
17:06:25.755398 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20' was properly closed.
17:06:25.755447 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe' was properly closed.
17:06:25.759468 [info ] [MainThread]: 
17:06:25.759585 [info ] [MainThread]: [32mCompleted successfully[0m
17:06:25.759710 [info ] [MainThread]: 
17:06:25.759798 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
17:06:25.759935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105010af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105010fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb2dc0>]}


============================== 2022-07-08 17:07:21.454822 | fc877a60-ba65-4dff-9202-668b3ea2c2b8 ==============================
17:07:21.454843 [info ] [MainThread]: Running with dbt=1.1.1
17:07:21.455462 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:07:21.455555 [debug] [MainThread]: Tracking: tracking
17:07:21.476227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fdbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fdcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fdd00>]}
17:07:21.495851 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
17:07:21.496035 [debug] [MainThread]: Partial parsing: deleted file: wrkplay_dbt://models/example/my_first_dbt_model.sql
17:07:21.496101 [debug] [MainThread]: Partial parsing: deleted file: wrkplay_dbt://models/example/my_second_dbt_model.sql
17:07:21.498052 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.wrkplay_dbt.example

17:07:21.501104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc877a60-ba65-4dff-9202-668b3ea2c2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f0ac0>]}
17:07:21.513064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc877a60-ba65-4dff-9202-668b3ea2c2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a2e50>]}
17:07:21.513347 [info ] [MainThread]: Found 2 models, 9 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:07:21.513484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc877a60-ba65-4dff-9202-668b3ea2c2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a2e80>]}
17:07:21.514367 [info ] [MainThread]: 
17:07:21.514639 [debug] [MainThread]: Acquiring new postgres connection "master"
17:07:21.515118 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
17:07:21.520041 [debug] [ThreadPool]: Using postgres connection "list_postgres"
17:07:21.520173 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
17:07:21.520236 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:07:21.777815 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.26 seconds
17:07:21.781974 [debug] [ThreadPool]: On list_postgres: Close
17:07:21.783066 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
17:07:21.786392 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:07:21.786484 [debug] [ThreadPool]: On list_postgres_public: BEGIN
17:07:21.786548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:07:21.977449 [debug] [ThreadPool]: SQL status: BEGIN in 0.19 seconds
17:07:21.978542 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:07:21.979323 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:07:22.003157 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.02 seconds
17:07:22.008701 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
17:07:22.027068 [debug] [ThreadPool]: On list_postgres_public: Close
17:07:22.033954 [debug] [MainThread]: Using postgres connection "master"
17:07:22.034092 [debug] [MainThread]: On master: BEGIN
17:07:22.034149 [debug] [MainThread]: Opening a new connection, currently in state init
17:07:22.230634 [debug] [MainThread]: SQL status: BEGIN in 0.2 seconds
17:07:22.232075 [debug] [MainThread]: Using postgres connection "master"
17:07:22.232455 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:07:22.408669 [debug] [MainThread]: SQL status: SELECT 8 in 0.18 seconds
17:07:22.422799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc877a60-ba65-4dff-9202-668b3ea2c2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b6c70>]}
17:07:22.423059 [debug] [MainThread]: On master: ROLLBACK
17:07:22.442706 [debug] [MainThread]: Using postgres connection "master"
17:07:22.443534 [debug] [MainThread]: On master: BEGIN
17:07:22.483114 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
17:07:22.483789 [debug] [MainThread]: On master: COMMIT
17:07:22.484180 [debug] [MainThread]: Using postgres connection "master"
17:07:22.484516 [debug] [MainThread]: On master: COMMIT
17:07:22.505637 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:07:22.506595 [debug] [MainThread]: On master: Close
17:07:22.508655 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:07:22.509391 [info ] [MainThread]: 
17:07:22.516687 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.number_played_against
17:07:22.516969 [info ] [Thread-1  ]: 1 of 2 START view model public.number_played_against ........................... [RUN]
17:07:22.517264 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.number_played_against"
17:07:22.517353 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.number_played_against
17:07:22.517444 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.number_played_against
17:07:22.518504 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.number_played_against"
17:07:22.518653 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
17:07:22.518784 [info ] [Thread-2  ]: 2 of 2 START view model public.wins_losses ..................................... [RUN]
17:07:22.519001 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
17:07:22.519101 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
17:07:22.519164 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
17:07:22.519783 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
17:07:22.519873 [debug] [Thread-1  ]: finished collecting timing info
17:07:22.519966 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.number_played_against
17:07:22.531329 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.number_played_against"
17:07:22.531487 [debug] [Thread-2  ]: finished collecting timing info
17:07:22.531593 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
17:07:22.532701 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
17:07:22.532859 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:07:22.532926 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: BEGIN
17:07:22.532984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:07:22.533188 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:07:22.533250 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: BEGIN
17:07:22.533301 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:07:22.715470 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
17:07:22.716827 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:07:22.717209 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */

  create view "postgres"."public"."number_played_against__dbt_tmp" as (
    -- gets the number of players a player has played against or with per season
SELECT
	c."b1" AS "player_id"
	, c."season_id" AS "season_id"
	, count(DISTINCT c."b2") AS "num_played_against"
FROM
	(
		WITH all_players AS (
			SELECT
				l."A" AS "match_id"
				, l."B" AS "player_id"
				, s.slug AS "season_id"
			FROM
				"_left" l
			JOIN "Match" m ON l."A" = m.id 
			JOIN "Season" s ON m.seasonid = s.id 
		UNION ALL
			SELECT
				r."A" AS "r_A"
				, r."B" AS "r_B"
				, s.slug AS "r_season_id"
			FROM
				"_right" r
			JOIN "Match" m ON r."A" = m.id 
			JOIN "Season" s ON m.seasonid = s.id 
		)
		SELECT
			a1."player_id" AS "b1"
			, a2."player_id" AS "b2"
			, a1."season_id" AS "season_id"
		FROM
			all_players a1
		JOIN all_players a2 ON
			a1."match_id" = a2."match_id"
	) c
WHERE
	c."b1" <> c."b2"
GROUP BY
	c."b1"
	, c."season_id"
  );
17:07:22.731406 [debug] [Thread-2  ]: SQL status: BEGIN in 0.2 seconds
17:07:22.732296 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:07:22.732514 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */

  create view "postgres"."public"."wins_losses__dbt_tmp" as (
    --number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
17:07:22.741520 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
17:07:22.750182 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:07:22.750387 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
alter table "postgres"."public"."number_played_against" rename to "number_played_against__dbt_backup"
17:07:22.760008 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.03 seconds
17:07:22.763564 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:07:22.763675 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses" rename to "wins_losses__dbt_backup"
17:07:22.768374 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
17:07:22.771514 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:07:22.771593 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
alter table "postgres"."public"."number_played_against__dbt_tmp" rename to "number_played_against"
17:07:22.782983 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
17:07:22.787119 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:07:22.787200 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
17:07:22.791324 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
17:07:22.796951 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: COMMIT
17:07:22.797070 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:07:22.797128 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: COMMIT
17:07:22.806262 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
17:07:22.808122 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
17:07:22.808332 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:07:22.808509 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
17:07:22.815511 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
17:07:22.821295 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:07:22.821379 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
drop view if exists "postgres"."public"."number_played_against__dbt_backup" cascade
17:07:22.827350 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
17:07:22.830160 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:07:22.830454 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop view if exists "postgres"."public"."wins_losses__dbt_backup" cascade
17:07:22.844450 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
17:07:22.847492 [debug] [Thread-1  ]: finished collecting timing info
17:07:22.848019 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: Close
17:07:22.848737 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc877a60-ba65-4dff-9202-668b3ea2c2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c2bb0>]}
17:07:22.848993 [info ] [Thread-1  ]: 1 of 2 OK created view model public.number_played_against ...................... [[32mCREATE VIEW[0m in 0.33s]
17:07:22.849291 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.number_played_against
17:07:22.851694 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
17:07:22.852334 [debug] [Thread-2  ]: finished collecting timing info
17:07:22.852411 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: Close
17:07:22.852659 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc877a60-ba65-4dff-9202-668b3ea2c2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699c910>]}
17:07:22.852791 [info ] [Thread-2  ]: 2 of 2 OK created view model public.wins_losses ................................ [[32mCREATE VIEW[0m in 0.33s]
17:07:22.852944 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
17:07:22.854779 [debug] [MainThread]: Acquiring new postgres connection "master"
17:07:22.854905 [debug] [MainThread]: Using postgres connection "master"
17:07:22.854961 [debug] [MainThread]: On master: BEGIN
17:07:22.855014 [debug] [MainThread]: Opening a new connection, currently in state closed
17:07:23.054102 [debug] [MainThread]: SQL status: BEGIN in 0.2 seconds
17:07:23.055392 [debug] [MainThread]: On master: COMMIT
17:07:23.055650 [debug] [MainThread]: Using postgres connection "master"
17:07:23.055885 [debug] [MainThread]: On master: COMMIT
17:07:23.074881 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:07:23.076329 [debug] [MainThread]: On master: Close
17:07:23.078207 [info ] [MainThread]: 
17:07:23.079170 [info ] [MainThread]: Finished running 2 view models in 1.56s.
17:07:23.079446 [debug] [MainThread]: Connection 'master' was properly closed.
17:07:23.079509 [debug] [MainThread]: Connection 'model.wrkplay_dbt.number_played_against' was properly closed.
17:07:23.079560 [debug] [MainThread]: Connection 'model.wrkplay_dbt.wins_losses' was properly closed.
17:07:23.083435 [info ] [MainThread]: 
17:07:23.083572 [info ] [MainThread]: [32mCompleted successfully[0m
17:07:23.083689 [info ] [MainThread]: 
17:07:23.083789 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
17:07:23.083931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106987e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106987a30>]}


============================== 2022-07-08 17:11:40.059467 | 7857e20c-b857-4917-9daa-151fb8f01a18 ==============================
17:11:40.059508 [info ] [MainThread]: Running with dbt=1.1.1
17:11:40.060149 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:11:40.060237 [debug] [MainThread]: Tracking: tracking
17:11:40.082588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e09b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e09c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e09c70>]}
17:11:40.101711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:11:40.101817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:11:40.101997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.wrkplay_dbt.example

17:11:40.105345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7857e20c-b857-4917-9daa-151fb8f01a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fdaa00>]}
17:11:40.108595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7857e20c-b857-4917-9daa-151fb8f01a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2e0a0>]}
17:11:40.108784 [info ] [MainThread]: Found 2 models, 9 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:11:40.108906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7857e20c-b857-4917-9daa-151fb8f01a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa7f10>]}
17:11:40.109706 [info ] [MainThread]: 
17:11:40.109957 [debug] [MainThread]: Acquiring new postgres connection "master"
17:11:40.111295 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
17:11:40.115886 [debug] [ThreadPool]: Using postgres connection "list_postgres"
17:11:40.115987 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
17:11:40.116050 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:11:40.365813 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.25 seconds
17:11:40.371369 [debug] [ThreadPool]: On list_postgres: Close
17:11:40.372614 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
17:11:40.376052 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:11:40.376157 [debug] [ThreadPool]: On list_postgres_public: BEGIN
17:11:40.376219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:11:40.560194 [debug] [ThreadPool]: SQL status: BEGIN in 0.18 seconds
17:11:40.561097 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:11:40.562017 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:11:40.584374 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.02 seconds
17:11:40.588811 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
17:11:40.606602 [debug] [ThreadPool]: On list_postgres_public: Close
17:11:40.615566 [debug] [MainThread]: Using postgres connection "master"
17:11:40.615724 [debug] [MainThread]: On master: BEGIN
17:11:40.615784 [debug] [MainThread]: Opening a new connection, currently in state init
17:11:40.808560 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
17:11:40.809191 [debug] [MainThread]: Using postgres connection "master"
17:11:40.809448 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:11:40.975442 [debug] [MainThread]: SQL status: SELECT 7 in 0.17 seconds
17:11:40.982785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7857e20c-b857-4917-9daa-151fb8f01a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb0c40>]}
17:11:40.983269 [debug] [MainThread]: On master: ROLLBACK
17:11:41.008785 [debug] [MainThread]: Using postgres connection "master"
17:11:41.009584 [debug] [MainThread]: On master: BEGIN
17:11:41.071597 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
17:11:41.073608 [debug] [MainThread]: On master: COMMIT
17:11:41.074028 [debug] [MainThread]: Using postgres connection "master"
17:11:41.074306 [debug] [MainThread]: On master: COMMIT
17:11:41.094343 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:11:41.095796 [debug] [MainThread]: On master: Close
17:11:41.097879 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:11:41.098480 [info ] [MainThread]: 
17:11:41.104513 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.number_played_against
17:11:41.104763 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
17:11:41.105108 [info ] [Thread-1  ]: 1 of 2 START view model public.number_played_against ........................... [RUN]
17:11:41.105354 [info ] [Thread-2  ]: 2 of 2 START view model public.wins_losses ..................................... [RUN]
17:11:41.105696 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.number_played_against"
17:11:41.105916 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
17:11:41.106101 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
17:11:41.106022 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.number_played_against
17:11:41.106321 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.number_played_against
17:11:41.106245 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
17:11:41.107991 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.number_played_against"
17:11:41.109388 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
17:11:41.110043 [debug] [Thread-1  ]: finished collecting timing info
17:11:41.110197 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.number_played_against
17:11:41.116682 [debug] [Thread-2  ]: finished collecting timing info
17:11:41.121437 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.number_played_against"
17:11:41.121563 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
17:11:41.122756 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
17:11:41.122967 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:11:41.123052 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: BEGIN
17:11:41.123115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:11:41.123342 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:11:41.123409 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: BEGIN
17:11:41.123459 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:11:41.299737 [debug] [Thread-2  ]: SQL status: BEGIN in 0.18 seconds
17:11:41.300495 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:11:41.300910 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */

  create view "postgres"."public"."wins_losses__dbt_tmp" as (
    --number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
17:11:41.306762 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
17:11:41.307200 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:11:41.307445 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */

  create view "postgres"."public"."number_played_against__dbt_tmp" as (
    -- gets the number of players a player has played against or with per season
SELECT
	c."b1" AS "player_id"
	, c."season_id" AS "season_id"
	, count(DISTINCT c."b2") AS "num_played_against"
FROM
	(
		WITH all_players AS (
			SELECT
				l."A" AS "match_id"
				, l."B" AS "player_id"
				, s.slug AS "season_id"
			FROM
				"_left" l
			JOIN "Match" m ON l."A" = m.id 
			JOIN "Season" s ON m.seasonid = s.id 
		UNION ALL
			SELECT
				r."A" AS "r_A"
				, r."B" AS "r_B"
				, s.slug AS "r_season_id"
			FROM
				"_right" r
			JOIN "Match" m ON r."A" = m.id 
			JOIN "Season" s ON m.seasonid = s.id 
		)
		SELECT
			a1."player_id" AS "b1"
			, a2."player_id" AS "b2"
			, a1."season_id" AS "season_id"
		FROM
			all_players a1
		JOIN all_players a2 ON
			a1."match_id" = a2."match_id"
	) c
WHERE
	c."b1" <> c."b2"
GROUP BY
	c."b1"
	, c."season_id"
  );
17:11:41.329022 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.03 seconds
17:11:41.336525 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:11:41.336712 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
17:11:41.336781 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses" rename to "wins_losses__dbt_backup"
17:11:41.337902 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:11:41.338054 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
alter table "postgres"."public"."number_played_against" rename to "number_played_against__dbt_backup"
17:11:41.365956 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.03 seconds
17:11:41.371134 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:11:41.371238 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
17:11:41.371289 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
17:11:41.372209 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:11:41.372337 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
alter table "postgres"."public"."number_played_against__dbt_tmp" rename to "number_played_against"
17:11:41.391260 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
17:11:41.391599 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
17:11:41.399027 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
17:11:41.399648 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: COMMIT
17:11:41.399726 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:11:41.399791 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:11:41.399848 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
17:11:41.399901 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: COMMIT
17:11:41.418172 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
17:11:41.423482 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:11:41.423587 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
17:11:41.423637 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop view if exists "postgres"."public"."wins_losses__dbt_backup" cascade
17:11:41.424394 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:11:41.424493 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
drop view if exists "postgres"."public"."number_played_against__dbt_backup" cascade
17:11:41.446541 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
17:11:41.446931 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
17:11:41.449760 [debug] [Thread-2  ]: finished collecting timing info
17:11:41.451387 [debug] [Thread-1  ]: finished collecting timing info
17:11:41.451552 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: Close
17:11:41.451625 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: Close
17:11:41.452007 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7857e20c-b857-4917-9daa-151fb8f01a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405eb80>]}
17:11:41.452225 [info ] [Thread-2  ]: 2 of 2 OK created view model public.wins_losses ................................ [[32mCREATE VIEW[0m in 0.35s]
17:11:41.452454 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
17:11:41.452698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7857e20c-b857-4917-9daa-151fb8f01a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ccd30>]}
17:11:41.452828 [info ] [Thread-1  ]: 1 of 2 OK created view model public.number_played_against ...................... [[32mCREATE VIEW[0m in 0.35s]
17:11:41.452976 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.number_played_against
17:11:41.453692 [debug] [MainThread]: Acquiring new postgres connection "master"
17:11:41.453784 [debug] [MainThread]: Using postgres connection "master"
17:11:41.453848 [debug] [MainThread]: On master: BEGIN
17:11:41.453901 [debug] [MainThread]: Opening a new connection, currently in state closed
17:11:41.661758 [debug] [MainThread]: SQL status: BEGIN in 0.21 seconds
17:11:41.663861 [debug] [MainThread]: On master: COMMIT
17:11:41.664242 [debug] [MainThread]: Using postgres connection "master"
17:11:41.664465 [debug] [MainThread]: On master: COMMIT
17:11:41.684164 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:11:41.685155 [debug] [MainThread]: On master: Close
17:11:41.686910 [info ] [MainThread]: 
17:11:41.687581 [info ] [MainThread]: Finished running 2 view models in 1.58s.
17:11:41.688044 [debug] [MainThread]: Connection 'master' was properly closed.
17:11:41.688200 [debug] [MainThread]: Connection 'model.wrkplay_dbt.number_played_against' was properly closed.
17:11:41.688276 [debug] [MainThread]: Connection 'model.wrkplay_dbt.wins_losses' was properly closed.
17:11:41.691950 [info ] [MainThread]: 
17:11:41.692108 [info ] [MainThread]: [32mCompleted successfully[0m
17:11:41.692237 [info ] [MainThread]: 
17:11:41.692350 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
17:11:41.692560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f41df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104052eb0>]}


============================== 2022-07-08 17:12:49.993530 | c7be8485-b86a-4ed7-8aad-a35f5748a3f6 ==============================
17:12:49.993564 [info ] [MainThread]: Running with dbt=1.1.1
17:12:49.994465 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:12:49.994564 [debug] [MainThread]: Tracking: tracking
17:12:50.020150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108addaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108addc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108addc40>]}
17:12:50.030189 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
17:12:50.030375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7be8485-b86a-4ed7-8aad-a35f5748a3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc84c0>]}
17:12:50.038393 [debug] [MainThread]: Parsing macros/positive_test.sql
17:12:50.038844 [debug] [MainThread]: Parsing macros/catalog.sql
17:12:50.040418 [debug] [MainThread]: Parsing macros/relations.sql
17:12:50.041130 [debug] [MainThread]: Parsing macros/adapters.sql
17:12:50.054243 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
17:12:50.055206 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
17:12:50.056962 [debug] [MainThread]: Parsing macros/materializations/configs.sql
17:12:50.057980 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
17:12:50.058730 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
17:12:50.066874 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
17:12:50.073421 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
17:12:50.078907 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
17:12:50.080971 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
17:12:50.081789 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
17:12:50.082602 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
17:12:50.084620 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
17:12:50.093142 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
17:12:50.093893 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
17:12:50.098922 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
17:12:50.106671 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
17:12:50.110430 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
17:12:50.111756 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
17:12:50.115341 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
17:12:50.115932 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
17:12:50.117184 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
17:12:50.118194 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
17:12:50.121056 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
17:12:50.129128 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
17:12:50.129803 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
17:12:50.130928 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
17:12:50.131627 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
17:12:50.132030 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
17:12:50.132390 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
17:12:50.132694 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
17:12:50.133309 [debug] [MainThread]: Parsing macros/etc/statement.sql
17:12:50.135342 [debug] [MainThread]: Parsing macros/etc/datetime.sql
17:12:50.139365 [debug] [MainThread]: Parsing macros/adapters/schema.sql
17:12:50.140322 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
17:12:50.141510 [debug] [MainThread]: Parsing macros/adapters/relation.sql
17:12:50.145948 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
17:12:50.147260 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
17:12:50.149267 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
17:12:50.152620 [debug] [MainThread]: Parsing macros/adapters/columns.sql
17:12:50.157204 [debug] [MainThread]: Parsing tests/generic/builtin.sql
17:12:50.238380 [debug] [MainThread]: 1699: static parser successfully parsed number_played_against.sql
17:12:50.243504 [debug] [MainThread]: 1699: static parser successfully parsed wins_losses.sql
17:12:50.301289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7be8485-b86a-4ed7-8aad-a35f5748a3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107def070>]}
17:12:50.303944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7be8485-b86a-4ed7-8aad-a35f5748a3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107defeb0>]}
17:12:50.304066 [info ] [MainThread]: Found 2 models, 9 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:12:50.304183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7be8485-b86a-4ed7-8aad-a35f5748a3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b9eb0>]}
17:12:50.304742 [info ] [MainThread]: 
17:12:50.304930 [debug] [MainThread]: Acquiring new postgres connection "master"
17:12:50.305262 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
17:12:50.309467 [debug] [ThreadPool]: Using postgres connection "list_postgres"
17:12:50.309542 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
17:12:50.309597 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:12:50.559504 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.25 seconds
17:12:50.564526 [debug] [ThreadPool]: On list_postgres: Close
17:12:50.565793 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
17:12:50.569560 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:12:50.569646 [debug] [ThreadPool]: On list_postgres_public: BEGIN
17:12:50.569705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:12:50.748812 [debug] [ThreadPool]: SQL status: BEGIN in 0.18 seconds
17:12:50.749880 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
17:12:50.750264 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:12:50.775600 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.02 seconds
17:12:50.781761 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
17:12:50.798342 [debug] [ThreadPool]: On list_postgres_public: Close
17:12:50.805374 [debug] [MainThread]: Using postgres connection "master"
17:12:50.805557 [debug] [MainThread]: On master: BEGIN
17:12:50.805621 [debug] [MainThread]: Opening a new connection, currently in state init
17:12:50.991762 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
17:12:50.992604 [debug] [MainThread]: Using postgres connection "master"
17:12:50.992956 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:12:51.156815 [debug] [MainThread]: SQL status: SELECT 7 in 0.16 seconds
17:12:51.161866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7be8485-b86a-4ed7-8aad-a35f5748a3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106537d00>]}
17:12:51.162399 [debug] [MainThread]: On master: ROLLBACK
17:12:51.180482 [debug] [MainThread]: Using postgres connection "master"
17:12:51.181188 [debug] [MainThread]: On master: BEGIN
17:12:51.219419 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
17:12:51.220601 [debug] [MainThread]: On master: COMMIT
17:12:51.221162 [debug] [MainThread]: Using postgres connection "master"
17:12:51.221505 [debug] [MainThread]: On master: COMMIT
17:12:51.239338 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:12:51.240220 [debug] [MainThread]: On master: Close
17:12:51.241874 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:12:51.242692 [info ] [MainThread]: 
17:12:51.247695 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.number_played_against
17:12:51.247921 [info ] [Thread-1  ]: 1 of 2 START view model public.number_played_against ........................... [RUN]
17:12:51.248195 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.number_played_against"
17:12:51.248277 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.number_played_against
17:12:51.248364 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.number_played_against
17:12:51.249436 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.number_played_against"
17:12:51.249580 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
17:12:51.249704 [info ] [Thread-2  ]: 2 of 2 START view model public.wins_losses ..................................... [RUN]
17:12:51.249908 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
17:12:51.249973 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
17:12:51.250031 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
17:12:51.250676 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
17:12:51.250910 [debug] [Thread-1  ]: finished collecting timing info
17:12:51.250985 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.number_played_against
17:12:51.261451 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.number_played_against"
17:12:51.261691 [debug] [Thread-2  ]: finished collecting timing info
17:12:51.261815 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:12:51.261880 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
17:12:51.261975 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: BEGIN
17:12:51.263110 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
17:12:51.263206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:12:51.263429 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:12:51.263496 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: BEGIN
17:12:51.263546 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:12:51.439640 [debug] [Thread-2  ]: SQL status: BEGIN in 0.18 seconds
17:12:51.441261 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:12:51.441673 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */

  create view "postgres"."public"."wins_losses__dbt_tmp" as (
    --number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
17:12:51.454436 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
17:12:51.455127 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:12:51.455340 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */

  create view "postgres"."public"."number_played_against__dbt_tmp" as (
    -- gets the number of players a player has played against or with per season
SELECT
	c."b1" AS "player_id"
	, c."season_id" AS "season_id"
	, count(DISTINCT c."b2") AS "num_played_against"
FROM
	(
		WITH all_players AS (
			SELECT
				l."A" AS "match_id"
				, l."B" AS "player_id"
				, s.slug AS "season_id"
			FROM
				"_left" l
			JOIN "Match" m ON l."A" = m.id 
			JOIN "Season" s ON m.seasonid = s.id 
		UNION ALL
			SELECT
				r."A" AS "r_A"
				, r."B" AS "r_B"
				, s.slug AS "r_season_id"
			FROM
				"_right" r
			JOIN "Match" m ON r."A" = m.id 
			JOIN "Season" s ON m.seasonid = s.id 
		)
		SELECT
			a1."player_id" AS "b1"
			, a2."player_id" AS "b2"
			, a1."season_id" AS "season_id"
		FROM
			all_players a1
		JOIN all_players a2 ON
			a1."match_id" = a2."match_id"
	) c
WHERE
	c."b1" <> c."b2"
GROUP BY
	c."b1"
	, c."season_id"
  );
17:12:51.476159 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.03 seconds
17:12:51.483508 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:12:51.483654 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
17:12:51.483808 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses" rename to "wins_losses__dbt_backup"
17:12:51.484908 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:12:51.485060 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
alter table "postgres"."public"."number_played_against" rename to "number_played_against__dbt_backup"
17:12:51.502679 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
17:12:51.507453 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:12:51.507536 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
17:12:51.507609 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
17:12:51.508536 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:12:51.508599 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
alter table "postgres"."public"."number_played_against__dbt_tmp" rename to "number_played_against"
17:12:51.525760 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
17:12:51.533128 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
17:12:51.533219 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
17:12:51.533269 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:12:51.533742 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: COMMIT
17:12:51.533812 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
17:12:51.533869 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:12:51.533955 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: COMMIT
17:12:51.552888 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
17:12:51.561267 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
17:12:51.561193 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
17:12:51.562000 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
17:12:51.562077 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop view if exists "postgres"."public"."wins_losses__dbt_backup" cascade
17:12:51.562139 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
drop view if exists "postgres"."public"."number_played_against__dbt_backup" cascade
17:12:51.585594 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
17:12:51.589819 [debug] [Thread-2  ]: finished collecting timing info
17:12:51.591313 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: Close
17:12:51.591512 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.03 seconds
17:12:51.592816 [debug] [Thread-1  ]: finished collecting timing info
17:12:51.592926 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: Close
17:12:51.593183 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7be8485-b86a-4ed7-8aad-a35f5748a3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e34880>]}
17:12:51.593338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7be8485-b86a-4ed7-8aad-a35f5748a3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dff340>]}
17:12:51.593535 [info ] [Thread-2  ]: 2 of 2 OK created view model public.wins_losses ................................ [[32mCREATE VIEW[0m in 0.34s]
17:12:51.593694 [info ] [Thread-1  ]: 1 of 2 OK created view model public.number_played_against ...................... [[32mCREATE VIEW[0m in 0.35s]
17:12:51.593939 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
17:12:51.594090 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.number_played_against
17:12:51.594881 [debug] [MainThread]: Acquiring new postgres connection "master"
17:12:51.594983 [debug] [MainThread]: Using postgres connection "master"
17:12:51.595041 [debug] [MainThread]: On master: BEGIN
17:12:51.595092 [debug] [MainThread]: Opening a new connection, currently in state closed
17:12:51.792874 [debug] [MainThread]: SQL status: BEGIN in 0.2 seconds
17:12:51.794314 [debug] [MainThread]: On master: COMMIT
17:12:51.795194 [debug] [MainThread]: Using postgres connection "master"
17:12:51.795478 [debug] [MainThread]: On master: COMMIT
17:12:51.814310 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
17:12:51.815124 [debug] [MainThread]: On master: Close
17:12:51.816862 [info ] [MainThread]: 
17:12:51.817499 [info ] [MainThread]: Finished running 2 view models in 1.51s.
17:12:51.817818 [debug] [MainThread]: Connection 'master' was properly closed.
17:12:51.817989 [debug] [MainThread]: Connection 'model.wrkplay_dbt.number_played_against' was properly closed.
17:12:51.818147 [debug] [MainThread]: Connection 'model.wrkplay_dbt.wins_losses' was properly closed.
17:12:51.822193 [info ] [MainThread]: 
17:12:51.822413 [info ] [MainThread]: [32mCompleted successfully[0m
17:12:51.822537 [info ] [MainThread]: 
17:12:51.822627 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
17:12:51.822813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108831130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce3310>]}


============================== 2022-07-11 08:45:24.194684 | e1ecc8fe-243e-49e3-94e1-29d46bb8d9c3 ==============================
08:45:24.194708 [info ] [MainThread]: Running with dbt=1.1.1
08:45:24.195340 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
08:45:24.195431 [debug] [MainThread]: Tracking: tracking
08:45:24.224103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715ddc0>]}
08:45:24.245822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:45:24.246006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:45:24.250279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1ecc8fe-243e-49e3-94e1-29d46bb8d9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107332fd0>]}
08:45:24.254260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1ecc8fe-243e-49e3-94e1-29d46bb8d9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072891c0>]}
08:45:24.254497 [info ] [MainThread]: Found 2 models, 9 tests, 0 snapshots, 0 analyses, 168 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:45:24.254644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ecc8fe-243e-49e3-94e1-29d46bb8d9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107289100>]}
08:45:24.255582 [info ] [MainThread]: 
08:45:24.255839 [debug] [MainThread]: Acquiring new postgres connection "master"
08:45:24.256255 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
08:45:24.261097 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
08:45:24.261250 [debug] [ThreadPool]: On list_postgres_public: BEGIN
08:45:24.261324 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:45:24.694310 [debug] [ThreadPool]: SQL status: BEGIN in 0.43 seconds
08:45:24.694772 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
08:45:24.694938 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
08:45:24.910019 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.21 seconds
08:45:24.913481 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
08:45:24.957374 [debug] [ThreadPool]: On list_postgres_public: Close
08:45:24.962935 [debug] [MainThread]: Using postgres connection "master"
08:45:24.963063 [debug] [MainThread]: On master: BEGIN
08:45:24.963134 [debug] [MainThread]: Opening a new connection, currently in state init
08:45:25.604049 [debug] [MainThread]: SQL status: BEGIN in 0.64 seconds
08:45:25.604743 [debug] [MainThread]: Using postgres connection "master"
08:45:25.604998 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:45:25.778882 [debug] [MainThread]: SQL status: SELECT 7 in 0.17 seconds
08:45:25.782280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ecc8fe-243e-49e3-94e1-29d46bb8d9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107300e50>]}
08:45:25.782928 [debug] [MainThread]: On master: ROLLBACK
08:45:25.953203 [debug] [MainThread]: On master: Close
08:45:25.955916 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
08:45:25.956861 [info ] [MainThread]: 
08:45:25.961363 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.number_played_against
08:45:25.961456 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
08:45:25.961681 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.number_played_against"
08:45:25.961840 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
08:45:25.961922 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.number_played_against
08:45:25.962005 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
08:45:25.962097 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.number_played_against
08:45:25.962160 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
08:45:25.962917 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.number_played_against"
08:45:25.963523 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
08:45:25.964059 [debug] [Thread-2  ]: finished collecting timing info
08:45:25.964159 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
08:45:25.964234 [debug] [Thread-2  ]: finished collecting timing info
08:45:25.964280 [debug] [Thread-1  ]: finished collecting timing info
08:45:25.964503 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
08:45:25.964593 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.number_played_against
08:45:25.964818 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
08:45:25.964873 [debug] [Thread-1  ]: finished collecting timing info
08:45:25.964924 [debug] [Thread-5  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
08:45:25.964976 [debug] [Thread-6  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
08:45:25.965024 [debug] [Thread-7  ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
08:45:25.965091 [debug] [Thread-8  ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
08:45:25.965209 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
08:45:25.965379 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.number_played_against
08:45:25.965502 [debug] [Thread-5  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
08:45:25.965678 [debug] [Thread-6  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
08:45:25.965792 [debug] [Thread-7  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
08:45:25.965907 [debug] [Thread-8  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
08:45:25.965968 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
08:45:25.966118 [debug] [Thread-5  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
08:45:25.966176 [debug] [Thread-10 ]: Began running node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
08:45:25.966226 [debug] [Thread-3  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
08:45:25.966279 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
08:45:25.966325 [debug] [Thread-6  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
08:45:25.966376 [debug] [Thread-9  ]: Began running node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
08:45:25.966431 [debug] [Thread-7  ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
08:45:25.966487 [debug] [Thread-8  ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
08:45:25.966544 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
08:45:25.966600 [debug] [Thread-5  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
08:45:25.966711 [debug] [Thread-10 ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
08:45:25.966821 [debug] [Thread-3  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
08:45:25.966926 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
08:45:25.966985 [debug] [Thread-6  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
08:45:25.967133 [debug] [Thread-9  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
08:45:25.967201 [debug] [Thread-7  ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
08:45:25.967278 [debug] [Thread-8  ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
08:45:25.973136 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
08:45:25.974587 [debug] [Thread-5  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
08:45:25.974675 [debug] [Thread-10 ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
08:45:25.974739 [debug] [Thread-3  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
08:45:25.974795 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
08:45:25.976688 [debug] [Thread-6  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
08:45:25.976770 [debug] [Thread-9  ]: Began compiling node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
08:45:25.978489 [debug] [Thread-7  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
08:45:25.979694 [debug] [Thread-8  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
08:45:25.979888 [debug] [Thread-10 ]: Compiling test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
08:45:25.979954 [debug] [Thread-3  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
08:45:25.980029 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
08:45:25.980131 [debug] [Thread-9  ]: Compiling test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
08:45:25.981757 [debug] [Thread-10 ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
08:45:25.983270 [debug] [Thread-3  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
08:45:25.983423 [debug] [Thread-8  ]: finished collecting timing info
08:45:25.984820 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
08:45:25.984885 [debug] [Thread-6  ]: finished collecting timing info
08:45:25.984942 [debug] [Thread-7  ]: finished collecting timing info
08:45:25.984998 [debug] [Thread-4  ]: finished collecting timing info
08:45:25.985046 [debug] [Thread-5  ]: finished collecting timing info
08:45:25.986369 [debug] [Thread-9  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
08:45:25.986547 [debug] [Thread-8  ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
08:45:25.986752 [debug] [Thread-6  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
08:45:25.986831 [debug] [Thread-10 ]: finished collecting timing info
08:45:25.986887 [debug] [Thread-7  ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
08:45:25.986948 [debug] [Thread-3  ]: finished collecting timing info
08:45:25.987041 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
08:45:25.987090 [debug] [Thread-2  ]: finished collecting timing info
08:45:25.987154 [debug] [Thread-5  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
08:45:25.987261 [debug] [Thread-8  ]: finished collecting timing info
08:45:25.987323 [debug] [Thread-6  ]: finished collecting timing info
08:45:25.987394 [debug] [Thread-10 ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
08:45:25.987462 [debug] [Thread-7  ]: finished collecting timing info
08:45:25.987510 [debug] [Thread-9  ]: finished collecting timing info
08:45:25.987566 [debug] [Thread-3  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
08:45:25.987626 [debug] [Thread-4  ]: finished collecting timing info
08:45:25.987691 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
08:45:25.987749 [debug] [Thread-5  ]: finished collecting timing info
08:45:25.987940 [debug] [Thread-8  ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
08:45:25.988101 [debug] [Thread-6  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
08:45:25.988170 [debug] [Thread-10 ]: finished collecting timing info
08:45:25.988315 [debug] [Thread-7  ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
08:45:25.988378 [debug] [Thread-9  ]: Began executing node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
08:45:25.988437 [debug] [Thread-3  ]: finished collecting timing info
08:45:25.988580 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
08:45:25.988646 [debug] [Thread-2  ]: finished collecting timing info
08:45:25.988782 [debug] [Thread-5  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
08:45:25.989016 [debug] [Thread-10 ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
08:45:25.989119 [debug] [Thread-9  ]: finished collecting timing info
08:45:25.989265 [debug] [Thread-3  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
08:45:25.989443 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
08:45:25.989671 [debug] [Thread-9  ]: Finished running node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
08:45:25.990278 [debug] [MainThread]: Connection 'master' was properly closed.
08:45:25.990339 [debug] [MainThread]: Connection 'model.wrkplay_dbt.number_played_against' was properly closed.
08:45:25.990390 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073' was properly closed.
08:45:25.990437 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1' was properly closed.
08:45:25.990484 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15' was properly closed.
08:45:25.990530 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813' was properly closed.
08:45:25.990574 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe' was properly closed.
08:45:25.990619 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77' was properly closed.
08:45:25.990662 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c' was properly closed.
08:45:25.990705 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427' was properly closed.
08:45:25.990747 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20' was properly closed.
08:45:25.993186 [info ] [MainThread]: Done.
08:45:25.994647 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
08:45:25.994733 [info ] [MainThread]: Building catalog
08:45:25.995247 [debug] [ThreadPool]: Acquiring new postgres connection "postgres.information_schema"
08:45:25.998360 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
08:45:25.998443 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
08:45:25.998499 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:45:26.613950 [debug] [ThreadPool]: SQL status: BEGIN in 0.62 seconds
08:45:26.614430 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
08:45:26.614774 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
08:45:26.678956 [debug] [ThreadPool]: SQL status: SELECT 92 in 0.06 seconds
08:45:26.689072 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
08:45:26.763956 [debug] [ThreadPool]: On postgres.information_schema: Close
08:45:26.771930 [info ] [MainThread]: Catalog written to /Users/bruno.campos/Documents/Documents - MACQ199NQ496F/saltplay/wrkplay_dbt/target/catalog.json
08:45:26.772165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107315fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767a7f0>]}
08:45:27.406644 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
08:45:27.407376 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.


============================== 2022-07-11 08:45:36.489150 | 561a10e2-d2fb-4579-98f1-9643e72ca294 ==============================
08:45:36.489185 [info ] [MainThread]: Running with dbt=1.1.1
08:45:36.489740 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
08:45:36.489858 [debug] [MainThread]: Tracking: tracking
08:45:36.505912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ddbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ddd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ddd30>]}
08:45:36.508384 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
08:45:36.508612 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
08:45:36.508733 [info ] [MainThread]: 
08:45:36.508827 [info ] [MainThread]: 
08:45:36.508915 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-07-11 14:43:22.893605 | 9e1a48b9-6ed9-4527-98eb-26f2ae90997f ==============================
14:43:22.893630 [info ] [MainThread]: Running with dbt=1.1.1
14:43:22.894465 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:43:22.894550 [debug] [MainThread]: Tracking: tracking
14:43:22.912469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681dbe0>]}
14:43:22.931617 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 4 files added, 0 files changed.
14:43:22.931797 [debug] [MainThread]: Partial parsing: added file: wrkplay_dbt://models/marts/number_played_against.sql
14:43:22.931892 [debug] [MainThread]: Partial parsing: added file: wrkplay_dbt://macros/column_not_empty_test.sql
14:43:22.932022 [debug] [MainThread]: Partial parsing: added file: wrkplay_dbt://models/marts/schema.yml
14:43:22.932099 [debug] [MainThread]: Partial parsing: added file: wrkplay_dbt://models/marts/wins_losses.sql
14:43:22.932186 [debug] [MainThread]: Partial parsing: deleted file: wrkplay_dbt://models/wins_losses.sql
14:43:22.932242 [debug] [MainThread]: Partial parsing: deleted file: wrkplay_dbt://models/number_played_against.sql
14:43:22.932312 [debug] [MainThread]: Parsing macros/column_not_empty_test.sql
14:43:22.939822 [debug] [MainThread]: 1699: static parser successfully parsed marts/number_played_against.sql
14:43:22.945878 [debug] [MainThread]: 1699: static parser successfully parsed marts/wins_losses.sql
14:43:22.972900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e1a48b9-6ed9-4527-98eb-26f2ae90997f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f1970>]}
14:43:22.975788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e1a48b9-6ed9-4527-98eb-26f2ae90997f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068147f0>]}
14:43:22.975930 [info ] [MainThread]: Found 2 models, 9 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:43:22.976055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e1a48b9-6ed9-4527-98eb-26f2ae90997f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106814880>]}
14:43:22.976707 [info ] [MainThread]: 
14:43:22.976899 [debug] [MainThread]: Acquiring new postgres connection "master"
14:43:22.977241 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
14:43:22.981478 [debug] [ThreadPool]: Using postgres connection "list_postgres"
14:43:22.981552 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
14:43:22.981612 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:43:23.363085 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.38 seconds
14:43:23.367721 [debug] [ThreadPool]: On list_postgres: Close
14:43:23.371038 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
14:43:23.374448 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
14:43:23.374538 [debug] [ThreadPool]: On list_postgres_public: BEGIN
14:43:23.374597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:43:23.801712 [debug] [ThreadPool]: SQL status: BEGIN in 0.43 seconds
14:43:23.802764 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
14:43:23.803301 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:43:23.859202 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.06 seconds
14:43:23.864264 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
14:43:23.892691 [debug] [ThreadPool]: On list_postgres_public: Close
14:43:23.906221 [debug] [MainThread]: Using postgres connection "master"
14:43:23.906598 [debug] [MainThread]: On master: BEGIN
14:43:23.906684 [debug] [MainThread]: Opening a new connection, currently in state init
14:43:24.273864 [debug] [MainThread]: SQL status: BEGIN in 0.37 seconds
14:43:24.275394 [debug] [MainThread]: Using postgres connection "master"
14:43:24.275789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:43:24.441720 [debug] [MainThread]: SQL status: SELECT 7 in 0.17 seconds
14:43:24.469243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e1a48b9-6ed9-4527-98eb-26f2ae90997f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c4dc0>]}
14:43:24.469816 [debug] [MainThread]: On master: ROLLBACK
14:43:24.506221 [debug] [MainThread]: Using postgres connection "master"
14:43:24.506529 [debug] [MainThread]: On master: BEGIN
14:43:24.545134 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
14:43:24.545774 [debug] [MainThread]: On master: COMMIT
14:43:24.546147 [debug] [MainThread]: Using postgres connection "master"
14:43:24.546479 [debug] [MainThread]: On master: COMMIT
14:43:24.565126 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
14:43:24.565772 [debug] [MainThread]: On master: Close
14:43:24.567019 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:43:24.567800 [info ] [MainThread]: 
14:43:24.575841 [debug] [Thread-1  ]: Began running node model.wrkplay_dbt.number_played_against
14:43:24.576020 [info ] [Thread-1  ]: 1 of 2 START view model public.number_played_against ........................... [RUN]
14:43:24.576249 [debug] [Thread-1  ]: Acquiring new postgres connection "model.wrkplay_dbt.number_played_against"
14:43:24.576320 [debug] [Thread-1  ]: Began compiling node model.wrkplay_dbt.number_played_against
14:43:24.576413 [debug] [Thread-1  ]: Compiling model.wrkplay_dbt.number_played_against
14:43:24.577164 [debug] [Thread-1  ]: Writing injected SQL for node "model.wrkplay_dbt.number_played_against"
14:43:24.577274 [debug] [Thread-2  ]: Began running node model.wrkplay_dbt.wins_losses
14:43:24.577397 [info ] [Thread-2  ]: 2 of 2 START view model public.wins_losses ..................................... [RUN]
14:43:24.577584 [debug] [Thread-2  ]: Acquiring new postgres connection "model.wrkplay_dbt.wins_losses"
14:43:24.577653 [debug] [Thread-2  ]: Began compiling node model.wrkplay_dbt.wins_losses
14:43:24.577746 [debug] [Thread-2  ]: Compiling model.wrkplay_dbt.wins_losses
14:43:24.578428 [debug] [Thread-2  ]: Writing injected SQL for node "model.wrkplay_dbt.wins_losses"
14:43:24.578529 [debug] [Thread-1  ]: finished collecting timing info
14:43:24.578611 [debug] [Thread-1  ]: Began executing node model.wrkplay_dbt.number_played_against
14:43:24.589760 [debug] [Thread-1  ]: Writing runtime SQL for node "model.wrkplay_dbt.number_played_against"
14:43:24.589852 [debug] [Thread-2  ]: finished collecting timing info
14:43:24.590003 [debug] [Thread-2  ]: Began executing node model.wrkplay_dbt.wins_losses
14:43:24.612659 [debug] [Thread-2  ]: Writing runtime SQL for node "model.wrkplay_dbt.wins_losses"
14:43:24.612837 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
14:43:24.612948 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: BEGIN
14:43:24.613032 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:43:24.613180 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:43:24.613248 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: BEGIN
14:43:24.613301 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:43:25.034229 [debug] [Thread-2  ]: SQL status: BEGIN in 0.42 seconds
14:43:25.035073 [debug] [Thread-1  ]: SQL status: BEGIN in 0.42 seconds
14:43:25.035855 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:43:25.036242 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
14:43:25.036639 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */

  create view "postgres"."public"."wins_losses__dbt_tmp" as (
    --number of wins and losses per player per game (per office) per season
WITH loss_table AS (
	SELECT
		SUM(lt.left_losses) AS "total_losses"
		, lt.left_player_id AS "loss_player_id"
		, lt.gameid
		, lt.seasonid
	FROM
		(
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 0
		ELSE 1
	END) AS "left_loss"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_loss) AS "left_losses"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) ll
		UNION ALL
			SELECT
				*
			FROM
				(
					--Begin DONE
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 0
		ELSE 1
	END) AS "right_loss"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_loss) AS "right_losses"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
						--End DONE
				) rl
		) lt
		--	WHERE lt.left_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		lt.left_player_id
		, lt.gameid
		, lt.seasonid
)
,
win_table AS (
	--number of wins for a player and gameid
	SELECT
		SUM(rt.right_wins) AS "total_wins"
		, rt.right_player_id AS "win_player_id"
		, rt.gameid
		, rt."seasonid"
	FROM
		(
			SELECT
				*
			FROM
				(
					WITH right_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore < m.rightscore THEN 1
		ELSE 0
	END) AS "right_won"
							, r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_right" r
						JOIN "Match" m ON
							r."A" = m.id
						GROUP BY
							r."A"
							, r."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.right_won) AS "right_wins"
						, a."B" AS "right_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						right_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) rw
		UNION ALL
			SELECT
				*
			FROM
				(
					WITH left_count AS (
						SELECT
							AVG(CASE
		WHEN m.leftscore > m.rightscore THEN 1
		ELSE 0
	END) AS "left_won"
							, l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
						FROM
							"_left" l
						JOIN "Match" m ON
							l."A" = m.id
						GROUP BY
							l."A"
							, l."B"
							, m."gameid"
							, m."seasonid"
					)
					SELECT
						SUM(a.left_won) AS "left_wins"
						, a."B" AS "left_player_id"
						, a."gameid"
						, a."seasonid"
					FROM
						left_count a
					GROUP BY
						a."B"
						, a."gameid"
						, a."seasonid"
				) lw
		) rt
		-- WHERE rt.right_player_id = '<insert player id here for specific player stats>'
	GROUP BY
		rt.right_player_id
		, rt.gameid
		, rt."seasonid"
)
SELECT
	COALESCE(lt.loss_player_id, wt.win_player_id) AS "player_id"
	, COALESCE(lt."gameid", wt."gameid") AS "gameid"
	, COALESCE(lt.seasonid, wt.seasonid) AS "seasonid"
	, wt."total_wins"
	, lt."total_losses"
FROM
	loss_table lt
FULL OUTER JOIN win_table wt ON
	lt."loss_player_id" = wt."win_player_id"
	AND lt."gameid" = wt."gameid"
	AND lt."seasonid" = wt."seasonid"
  );
14:43:25.036857 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */

  create view "postgres"."public"."number_played_against__dbt_tmp" as (
    -- gets the number of players a player has played against or with per season
SELECT
	c."b1" AS "player_id"
	, c."season_id" AS "season_id"
	, count(DISTINCT c."b2") AS "num_played_against"
FROM
	(
		WITH all_players AS (
			SELECT
				l."A" AS "match_id"
				, l."B" AS "player_id"
				, s.slug AS "season_id"
			FROM
				"_left" l
			JOIN "Match" m ON l."A" = m.id 
			JOIN "Season" s ON m.seasonid = s.id 
		UNION ALL
			SELECT
				r."A" AS "r_A"
				, r."B" AS "r_B"
				, s.slug AS "r_season_id"
			FROM
				"_right" r
			JOIN "Match" m ON r."A" = m.id 
			JOIN "Season" s ON m.seasonid = s.id 
		)
		SELECT
			a1."player_id" AS "b1"
			, a2."player_id" AS "b2"
			, a1."season_id" AS "season_id"
		FROM
			all_players a1
		JOIN all_players a2 ON
			a1."match_id" = a2."match_id"
	) c
WHERE
	c."b1" <> c."b2"
GROUP BY
	c."b1"
	, c."season_id"
  );
14:43:25.173187 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.14 seconds
14:43:25.174124 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.14 seconds
14:43:25.180528 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:43:25.181639 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
14:43:25.181725 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses" rename to "wins_losses__dbt_backup"
14:43:25.181791 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
alter table "postgres"."public"."number_played_against" rename to "number_played_against__dbt_backup"
14:43:25.202468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
14:43:25.203311 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
14:43:25.203379 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
alter table "postgres"."public"."number_played_against__dbt_tmp" rename to "number_played_against"
14:43:25.203451 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
14:43:25.204388 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:43:25.204461 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
alter table "postgres"."public"."wins_losses__dbt_tmp" rename to "wins_losses"
14:43:25.223452 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
14:43:25.223762 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
14:43:25.228072 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
14:43:25.228683 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: COMMIT
14:43:25.228761 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:43:25.228825 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
14:43:25.228883 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: COMMIT
14:43:25.228938 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: COMMIT
14:43:25.250942 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
14:43:25.251339 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
14:43:25.256653 [debug] [Thread-2  ]: Using postgres connection "model.wrkplay_dbt.wins_losses"
14:43:25.257421 [debug] [Thread-1  ]: Using postgres connection "model.wrkplay_dbt.number_played_against"
14:43:25.257501 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.wins_losses"} */
drop view if exists "postgres"."public"."wins_losses__dbt_backup" cascade
14:43:25.257578 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "model.wrkplay_dbt.number_played_against"} */
drop view if exists "postgres"."public"."number_played_against__dbt_backup" cascade
14:43:25.298074 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.04 seconds
14:43:25.302311 [debug] [Thread-2  ]: finished collecting timing info
14:43:25.302580 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.04 seconds
14:43:25.303074 [debug] [Thread-2  ]: On model.wrkplay_dbt.wins_losses: Close
14:43:25.304199 [debug] [Thread-1  ]: finished collecting timing info
14:43:25.304420 [debug] [Thread-1  ]: On model.wrkplay_dbt.number_played_against: Close
14:43:25.304748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1a48b9-6ed9-4527-98eb-26f2ae90997f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab7f10>]}
14:43:25.304998 [info ] [Thread-1  ]: 1 of 2 OK created view model public.number_played_against ...................... [[32mCREATE VIEW[0m in 0.73s]
14:43:25.305271 [debug] [Thread-1  ]: Finished running node model.wrkplay_dbt.number_played_against
14:43:25.305551 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1a48b9-6ed9-4527-98eb-26f2ae90997f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad1130>]}
14:43:25.305680 [info ] [Thread-2  ]: 2 of 2 OK created view model public.wins_losses ................................ [[32mCREATE VIEW[0m in 0.73s]
14:43:25.305830 [debug] [Thread-2  ]: Finished running node model.wrkplay_dbt.wins_losses
14:43:25.306770 [debug] [MainThread]: Acquiring new postgres connection "master"
14:43:25.306901 [debug] [MainThread]: Using postgres connection "master"
14:43:25.306961 [debug] [MainThread]: On master: BEGIN
14:43:25.307016 [debug] [MainThread]: Opening a new connection, currently in state closed
14:43:25.543988 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
14:43:25.545622 [debug] [MainThread]: On master: COMMIT
14:43:25.546014 [debug] [MainThread]: Using postgres connection "master"
14:43:25.546401 [debug] [MainThread]: On master: COMMIT
14:43:25.564616 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
14:43:25.565470 [debug] [MainThread]: On master: Close
14:43:25.567460 [info ] [MainThread]: 
14:43:25.568083 [info ] [MainThread]: Finished running 2 view models in 2.59s.
14:43:25.568523 [debug] [MainThread]: Connection 'master' was properly closed.
14:43:25.568686 [debug] [MainThread]: Connection 'model.wrkplay_dbt.number_played_against' was properly closed.
14:43:25.568742 [debug] [MainThread]: Connection 'model.wrkplay_dbt.wins_losses' was properly closed.
14:43:25.573381 [info ] [MainThread]: 
14:43:25.573509 [info ] [MainThread]: [32mCompleted successfully[0m
14:43:25.573621 [info ] [MainThread]: 
14:43:25.573709 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
14:43:25.573843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa2100>]}


============================== 2022-07-11 14:43:33.293063 | 2bd1cbb2-621f-40bb-84bd-067b02dacb3e ==============================
14:43:33.293084 [info ] [MainThread]: Running with dbt=1.1.1
14:43:33.293390 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/bruno.campos/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
14:43:33.293468 [debug] [MainThread]: Tracking: tracking
14:43:33.308057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d448b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d449d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d44a00>]}
14:43:33.325083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:43:33.325197 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:43:33.328487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bd1cbb2-621f-40bb-84bd-067b02dacb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f19a90>]}
14:43:33.331325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bd1cbb2-621f-40bb-84bd-067b02dacb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6c070>]}
14:43:33.331459 [info ] [MainThread]: Found 2 models, 9 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:43:33.331599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bd1cbb2-621f-40bb-84bd-067b02dacb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6c040>]}
14:43:33.332385 [info ] [MainThread]: 
14:43:33.332584 [debug] [MainThread]: Acquiring new postgres connection "master"
14:43:33.332997 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
14:43:33.337290 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
14:43:33.337371 [debug] [ThreadPool]: On list_postgres_public: BEGIN
14:43:33.337431 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:43:33.666632 [debug] [ThreadPool]: SQL status: BEGIN in 0.33 seconds
14:43:33.667129 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
14:43:33.667295 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:43:33.691830 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.02 seconds
14:43:33.694630 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
14:43:33.712370 [debug] [ThreadPool]: On list_postgres_public: Close
14:43:33.717811 [debug] [MainThread]: Using postgres connection "master"
14:43:33.717966 [debug] [MainThread]: On master: BEGIN
14:43:33.718027 [debug] [MainThread]: Opening a new connection, currently in state init
14:43:33.952692 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
14:43:33.954216 [debug] [MainThread]: Using postgres connection "master"
14:43:33.954611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:43:34.219415 [debug] [MainThread]: SQL status: SELECT 7 in 0.26 seconds
14:43:34.224781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bd1cbb2-621f-40bb-84bd-067b02dacb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eeccd0>]}
14:43:34.225558 [debug] [MainThread]: On master: ROLLBACK
14:43:34.246037 [debug] [MainThread]: Using postgres connection "master"
14:43:34.246855 [debug] [MainThread]: On master: BEGIN
14:43:34.286954 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
14:43:34.287690 [debug] [MainThread]: On master: COMMIT
14:43:34.287911 [debug] [MainThread]: Using postgres connection "master"
14:43:34.288103 [debug] [MainThread]: On master: COMMIT
14:43:34.333261 [debug] [MainThread]: SQL status: COMMIT in 0.04 seconds
14:43:34.334352 [debug] [MainThread]: On master: Close
14:43:34.336075 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:43:34.336851 [info ] [MainThread]: 
14:43:34.341941 [debug] [Thread-1  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
14:43:34.342096 [debug] [Thread-2  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
14:43:34.342197 [debug] [Thread-3  ]: Began running node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
14:43:34.342257 [debug] [Thread-4  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
14:43:34.342332 [info ] [Thread-1  ]: 1 of 9 START test not_null_number_played_against_num_played_against ............ [RUN]
14:43:34.342394 [debug] [Thread-5  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
14:43:34.342501 [info ] [Thread-2  ]: 2 of 9 START test not_null_number_played_against_player_id ..................... [RUN]
14:43:34.342553 [debug] [Thread-6  ]: Began running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
14:43:34.342629 [debug] [Thread-7  ]: Began running node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
14:43:34.342693 [info ] [Thread-3  ]: 3 of 9 START test not_null_number_played_against_season_id ..................... [RUN]
14:43:34.342748 [debug] [Thread-8  ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
14:43:34.342831 [debug] [Thread-9  ]: Began running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
14:43:34.342878 [info ] [Thread-4  ]: 4 of 9 START test not_null_wins_losses_gameid .................................. [RUN]
14:43:34.343156 [debug] [Thread-1  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
14:43:34.343228 [info ] [Thread-5  ]: 5 of 9 START test not_null_wins_losses_player_id ............................... [RUN]
14:43:34.343397 [debug] [Thread-2  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
14:43:34.343462 [info ] [Thread-6  ]: 6 of 9 START test not_null_wins_losses_seasonid ................................ [RUN]
14:43:34.343524 [info ] [Thread-7  ]: 7 of 9 START test positive_test_number_played_against_num_played_against ....... [RUN]
14:43:34.343675 [debug] [Thread-3  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
14:43:34.343739 [info ] [Thread-8  ]: 8 of 9 START test positive_test_wins_losses_total_losses ....................... [RUN]
14:43:34.343804 [info ] [Thread-9  ]: 9 of 9 START test positive_test_wins_losses_total_wins ......................... [RUN]
14:43:34.343952 [debug] [Thread-4  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
14:43:34.344033 [debug] [Thread-1  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
14:43:34.344228 [debug] [Thread-5  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
14:43:34.344286 [debug] [Thread-2  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
14:43:34.344449 [debug] [Thread-6  ]: Acquiring new postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
14:43:34.344647 [debug] [Thread-7  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
14:43:34.344708 [debug] [Thread-3  ]: Began compiling node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
14:43:34.344868 [debug] [Thread-8  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
14:43:34.345023 [debug] [Thread-9  ]: Acquiring new postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
14:43:34.345084 [debug] [Thread-4  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
14:43:34.345158 [debug] [Thread-1  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
14:43:34.345220 [debug] [Thread-5  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
14:43:34.345277 [debug] [Thread-2  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
14:43:34.345333 [debug] [Thread-6  ]: Began compiling node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
14:43:34.345387 [debug] [Thread-7  ]: Began compiling node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
14:43:34.345442 [debug] [Thread-3  ]: Compiling test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
14:43:34.345497 [debug] [Thread-8  ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
14:43:34.345554 [debug] [Thread-9  ]: Began compiling node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
14:43:34.345607 [debug] [Thread-4  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
14:43:34.351509 [debug] [Thread-1  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
14:43:34.351621 [debug] [Thread-5  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
14:43:34.353110 [debug] [Thread-2  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
14:43:34.353191 [debug] [Thread-6  ]: Compiling test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
14:43:34.353257 [debug] [Thread-7  ]: Compiling test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
14:43:34.354650 [debug] [Thread-3  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
14:43:34.354733 [debug] [Thread-8  ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
14:43:34.354798 [debug] [Thread-9  ]: Compiling test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
14:43:34.356160 [debug] [Thread-4  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
14:43:34.358115 [debug] [Thread-5  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
14:43:34.359733 [debug] [Thread-6  ]: Writing injected SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
14:43:34.361417 [debug] [Thread-7  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
14:43:34.361504 [debug] [Thread-1  ]: finished collecting timing info
14:43:34.361598 [debug] [Thread-2  ]: finished collecting timing info
14:43:34.362924 [debug] [Thread-8  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
14:43:34.364178 [debug] [Thread-9  ]: Writing injected SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
14:43:34.364310 [debug] [Thread-3  ]: finished collecting timing info
14:43:34.364455 [debug] [Thread-4  ]: finished collecting timing info
14:43:34.364577 [debug] [Thread-5  ]: finished collecting timing info
14:43:34.364648 [debug] [Thread-6  ]: finished collecting timing info
14:43:34.364706 [debug] [Thread-1  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
14:43:34.364782 [debug] [Thread-2  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
14:43:34.364830 [debug] [Thread-7  ]: finished collecting timing info
14:43:34.364956 [debug] [Thread-3  ]: Began executing node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
14:43:34.365041 [debug] [Thread-4  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
14:43:34.365095 [debug] [Thread-8  ]: finished collecting timing info
14:43:34.365155 [debug] [Thread-9  ]: finished collecting timing info
14:43:34.365203 [debug] [Thread-5  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
14:43:34.365268 [debug] [Thread-6  ]: Began executing node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
14:43:34.371563 [debug] [Thread-1  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
14:43:34.372297 [debug] [Thread-2  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
14:43:34.372380 [debug] [Thread-7  ]: Began executing node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
14:43:34.373045 [debug] [Thread-3  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
14:43:34.373758 [debug] [Thread-4  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
14:43:34.373841 [debug] [Thread-8  ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
14:43:34.373917 [debug] [Thread-9  ]: Began executing node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
14:43:34.374587 [debug] [Thread-5  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
14:43:34.375269 [debug] [Thread-6  ]: Writing runtime SQL for node "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
14:43:34.376039 [debug] [Thread-7  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
14:43:34.376275 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
14:43:34.376386 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
14:43:34.377010 [debug] [Thread-8  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
14:43:34.377091 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
14:43:34.377731 [debug] [Thread-9  ]: Writing runtime SQL for node "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
14:43:34.377816 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
14:43:34.378007 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
14:43:34.378071 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: BEGIN
14:43:34.378138 [debug] [Thread-6  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
14:43:34.378211 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: BEGIN
14:43:34.378267 [debug] [Thread-7  ]: Using postgres connection "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
14:43:34.378360 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: BEGIN
14:43:34.378477 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
14:43:34.378535 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: BEGIN
14:43:34.378604 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
14:43:34.378644 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: BEGIN
14:43:34.378702 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:43:34.378763 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: BEGIN
14:43:34.378822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:43:34.378877 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: BEGIN
14:43:34.378929 [debug] [Thread-3  ]: Opening a new connection, currently in state init
14:43:34.378982 [debug] [Thread-8  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: BEGIN
14:43:34.379033 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:43:34.379086 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: BEGIN
14:43:34.379137 [debug] [Thread-5  ]: Opening a new connection, currently in state init
14:43:34.379259 [debug] [Thread-6  ]: Opening a new connection, currently in state init
14:43:34.379364 [debug] [Thread-7  ]: Opening a new connection, currently in state init
14:43:34.379459 [debug] [Thread-8  ]: Opening a new connection, currently in state init
14:43:34.379573 [debug] [Thread-9  ]: Opening a new connection, currently in state init
14:43:34.770693 [debug] [Thread-9  ]: SQL status: BEGIN in 0.39 seconds
14:43:34.771168 [debug] [Thread-2  ]: SQL status: BEGIN in 0.39 seconds
14:43:34.771487 [debug] [Thread-9  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"
14:43:34.771677 [debug] [Thread-2  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"
14:43:34.771879 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        total_wins as positive

    from "postgres"."public"."wins_losses"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
14:43:34.772076 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from "postgres"."public"."number_played_against"
where player_id is null



      
    ) dbt_internal_test
14:43:34.795184 [debug] [Thread-7  ]: SQL status: BEGIN in 0.42 seconds
14:43:34.795462 [debug] [Thread-6  ]: SQL status: BEGIN in 0.42 seconds
14:43:34.795609 [debug] [Thread-1  ]: SQL status: BEGIN in 0.42 seconds
14:43:34.795745 [debug] [Thread-4  ]: SQL status: BEGIN in 0.42 seconds
14:43:34.795984 [debug] [Thread-8  ]: SQL status: BEGIN in 0.42 seconds
14:43:34.797109 [debug] [Thread-8  ]: Using postgres connection "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"
14:43:34.797267 [debug] [Thread-8  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        total_losses as positive

    from "postgres"."public"."wins_losses"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
14:43:34.796382 [debug] [Thread-7  ]: Using postgres connection "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"
14:43:34.796560 [debug] [Thread-6  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"
14:43:34.796763 [debug] [Thread-1  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"
14:43:34.797896 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select num_played_against
from "postgres"."public"."number_played_against"
where num_played_against is null



      
    ) dbt_internal_test
14:43:34.796940 [debug] [Thread-4  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"
14:43:34.796113 [debug] [Thread-3  ]: SQL status: BEGIN in 0.42 seconds
14:43:34.797509 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with validation as (

    select
        num_played_against as positive

    from "postgres"."public"."number_played_against"

),

validation_errors as (

    select
        positive 

    from validation
    -- if this is true, then positive is actually negative!
    where positive < 0

)

select *
from validation_errors


      
    ) dbt_internal_test
14:43:34.797696 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seasonid
from "postgres"."public"."wins_losses"
where seasonid is null



      
    ) dbt_internal_test
14:43:34.796239 [debug] [Thread-5  ]: SQL status: BEGIN in 0.42 seconds
14:43:34.798171 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gameid
from "postgres"."public"."wins_losses"
where gameid is null



      
    ) dbt_internal_test
14:43:34.798342 [debug] [Thread-3  ]: Using postgres connection "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"
14:43:34.798704 [debug] [Thread-5  ]: Using postgres connection "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"
14:43:34.798943 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select season_id
from "postgres"."public"."number_played_against"
where season_id is null



      
    ) dbt_internal_test
14:43:34.799099 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "wrkplay_dbt", "target_name": "dev", "node_id": "test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from "postgres"."public"."wins_losses"
where player_id is null



      
    ) dbt_internal_test
14:43:34.804980 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.03 seconds
14:43:34.808545 [debug] [Thread-2  ]: finished collecting timing info
14:43:34.808862 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: ROLLBACK
14:43:34.810959 [debug] [Thread-9  ]: SQL status: SELECT 1 in 0.04 seconds
14:43:34.812592 [debug] [Thread-9  ]: finished collecting timing info
14:43:34.812903 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: ROLLBACK
14:43:34.839703 [debug] [Thread-9  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77: Close
14:43:34.843347 [info ] [Thread-9  ]: 9 of 9 PASS positive_test_wins_losses_total_wins ............................... [[32mPASS[0m in 0.50s]
14:43:34.848527 [debug] [Thread-2  ]: On test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427: Close
14:43:34.865089 [debug] [Thread-9  ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77
14:43:34.866057 [info ] [Thread-2  ]: 2 of 9 PASS not_null_number_played_against_player_id ........................... [[32mPASS[0m in 0.52s]
14:43:34.866607 [debug] [Thread-2  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427
14:43:34.899624 [debug] [Thread-8  ]: SQL status: SELECT 1 in 0.1 seconds
14:43:34.899989 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.1 seconds
14:43:34.900235 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.1 seconds
14:43:34.902655 [debug] [Thread-8  ]: finished collecting timing info
14:43:34.902904 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.1 seconds
14:43:34.903051 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.1 seconds
14:43:34.905170 [debug] [Thread-4  ]: finished collecting timing info
14:43:34.906909 [debug] [Thread-6  ]: finished collecting timing info
14:43:34.907080 [debug] [Thread-8  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: ROLLBACK
14:43:34.907758 [debug] [Thread-3  ]: finished collecting timing info
14:43:34.908298 [debug] [Thread-5  ]: finished collecting timing info
14:43:34.908668 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: ROLLBACK
14:43:34.908459 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: ROLLBACK
14:43:34.908571 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: ROLLBACK
14:43:34.908390 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: ROLLBACK
14:43:34.920405 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.12 seconds
14:43:34.921142 [debug] [Thread-1  ]: finished collecting timing info
14:43:34.921242 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: ROLLBACK
14:43:34.939579 [debug] [Thread-3  ]: On test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073: Close
14:43:34.939746 [debug] [Thread-8  ]: On test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe: Close
14:43:34.939804 [debug] [Thread-4  ]: On test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1: Close
14:43:34.939860 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.14 seconds
14:43:34.939901 [debug] [Thread-5  ]: On test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15: Close
14:43:34.939939 [debug] [Thread-6  ]: On test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813: Close
14:43:34.940706 [debug] [Thread-7  ]: finished collecting timing info
14:43:34.940875 [info ] [Thread-8  ]: 8 of 9 PASS positive_test_wins_losses_total_losses ............................. [[32mPASS[0m in 0.60s]
14:43:34.941034 [info ] [Thread-3  ]: 3 of 9 PASS not_null_number_played_against_season_id ........................... [[32mPASS[0m in 0.60s]
14:43:34.941142 [info ] [Thread-4  ]: 4 of 9 PASS not_null_wins_losses_gameid ........................................ [[32mPASS[0m in 0.60s]
14:43:34.941279 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: ROLLBACK
14:43:34.941404 [info ] [Thread-5  ]: 5 of 9 PASS not_null_wins_losses_player_id ..................................... [[32mPASS[0m in 0.60s]
14:43:34.941595 [debug] [Thread-8  ]: Finished running node test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe
14:43:34.941734 [debug] [Thread-3  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073
14:43:34.941868 [info ] [Thread-6  ]: 6 of 9 PASS not_null_wins_losses_seasonid ...................................... [[32mPASS[0m in 0.60s]
14:43:34.942010 [debug] [Thread-4  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1
14:43:34.942227 [debug] [Thread-5  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15
14:43:34.942528 [debug] [Thread-6  ]: Finished running node test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813
14:43:34.944116 [debug] [Thread-1  ]: On test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c: Close
14:43:34.944425 [info ] [Thread-1  ]: 1 of 9 PASS not_null_number_played_against_num_played_against .................. [[32mPASS[0m in 0.60s]
14:43:34.944595 [debug] [Thread-1  ]: Finished running node test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c
14:43:35.005442 [debug] [Thread-7  ]: On test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20: Close
14:43:35.006707 [info ] [Thread-7  ]: 7 of 9 PASS positive_test_number_played_against_num_played_against ............. [[32mPASS[0m in 0.66s]
14:43:35.006963 [debug] [Thread-7  ]: Finished running node test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20
14:43:35.008206 [debug] [MainThread]: Acquiring new postgres connection "master"
14:43:35.008417 [debug] [MainThread]: Using postgres connection "master"
14:43:35.008482 [debug] [MainThread]: On master: BEGIN
14:43:35.008539 [debug] [MainThread]: Opening a new connection, currently in state closed
14:43:35.444791 [debug] [MainThread]: SQL status: BEGIN in 0.44 seconds
14:43:35.446209 [debug] [MainThread]: On master: COMMIT
14:43:35.446567 [debug] [MainThread]: Using postgres connection "master"
14:43:35.446905 [debug] [MainThread]: On master: COMMIT
14:43:35.465632 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
14:43:35.466427 [debug] [MainThread]: On master: Close
14:43:35.468393 [info ] [MainThread]: 
14:43:35.469105 [info ] [MainThread]: Finished running 9 tests in 2.14s.
14:43:35.469760 [debug] [MainThread]: Connection 'master' was properly closed.
14:43:35.469993 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_number_played_against_num_played_against.19f565a96c' was properly closed.
14:43:35.470056 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_number_played_against_player_id.d65aae7427' was properly closed.
14:43:35.470110 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_number_played_against_season_id.53f4b10073' was properly closed.
14:43:35.470160 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_gameid.b3459a82c1' was properly closed.
14:43:35.470206 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_player_id.88b8772d15' was properly closed.
14:43:35.470251 [debug] [MainThread]: Connection 'test.wrkplay_dbt.not_null_wins_losses_seasonid.a40c396813' was properly closed.
14:43:35.470296 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_number_played_against_num_played_against.7335215a20' was properly closed.
14:43:35.470341 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_losses.66243e8ebe' was properly closed.
14:43:35.470386 [debug] [MainThread]: Connection 'test.wrkplay_dbt.positive_test_wins_losses_total_wins.dc5787dd77' was properly closed.
14:43:35.500321 [info ] [MainThread]: 
14:43:35.500483 [info ] [MainThread]: [32mCompleted successfully[0m
14:43:35.500602 [info ] [MainThread]: 
14:43:35.500688 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
14:43:35.500814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc0d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccc8b0>]}
